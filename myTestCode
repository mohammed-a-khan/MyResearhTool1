//tttf-new-zeal.steps.ts

@CSBDDStepDef('I verify Disputed Scattered Mmte and Start Date if applicable')
    async verifyDisputedScatteredMmteAndStartDate(): Promise<void> {
        const hasDisputed = this.scenarioContext.getVariable<string>('hasDisputedScatteredMmte');

        if (hasDisputed !== 'true' && hasDisputed !== 'Yes') {
            CSReporter.info('HasDisputedScatteredMmte is not enabled, skipping disputed verification');
            return;
        }

        CSReporter.info('HasDisputedScatteredMmte is enabled, verifying disputed data');

        const disputedScatteredMmteData = this.scenarioContext.getVariable<Record<string, { disputedScatteredMmteName: string; disputedStartDate: string }>>('disputedScatteredMmte');
        const mmteNames = this.scenarioContext.getVariable<string[]>('scatteredMmtesToAdd') || [];

        if (!disputedScatteredMmteData) {
            CSReporter.info('No disputed scattered mmte data found in context');
            return;
        }

        for (let i = 0; i < mmteNames.length; i++) {
            const mmteName = mmteNames[i];
            const disputedData = disputedScatteredMmteData[mmteName];

            if (!disputedData) {
                CSReporter.info(`No disputed data for scattered mmte: ${mmteName}, skipping`);
                continue;
            }

            const rowIndex = i; // 0-based index (page method handles xpath indexing)
            const expectedDisputedMmteName = disputedData.disputedScatteredMmteName;
            const expectedDisputedStartDate = disputedData.disputedStartDate;

            // Verify Disputed Scattered Mmte
            const actualDisputedMmteName = await this.zealDetailsPage.getDisputedScatteredMmteValue(rowIndex);
            if (actualDisputedMmteName !== expectedDisputedMmteName) {
                throw new Error(`Row ${rowIndex} Disputed Scattered Mmte mismatch: Expected=${expectedDisputedMmteName}, Actual=${actualDisputedMmteName}`);
            }
            CSReporter.pass(`Row ${rowIndex} Disputed Scattered Mmte verified: ${actualDisputedMmteName}`);

            // Verify Disputed Start Date
            const actualDisputedStartDate = await this.zealDetailsPage.getDisputedStartDateValue(rowIndex);
            if (actualDisputedStartDate !== expectedDisputedStartDate) {
                throw new Error(`Row ${rowIndex} Disputed Start Date mismatch: Expected=${expectedDisputedStartDate}, Actual=${actualDisputedStartDate}`);
            }
            CSReporter.pass(`Row ${rowIndex} Disputed Start Date verified: ${actualDisputedStartDate}`);
        }
    }
--------------------------------------------

TTTFZealDeatilsPage.ts

/**
     * Get Disputed Scattered Mmte value for a specific row in Associated Scattered Mmtes section
     * @param rowIndex - 0-based row index
     * @returns The disputed scattered mmte name or empty string if not set
     */
    public async getDisputedScatteredMmteValue(rowIndex: number): Promise<string> {
        const counter = rowIndex + 1;
        const disputedRefMmteElement = CSElementFactory.createByXPath(
            `//form[@class='ctsjv-form']//h2[text()='Associated Scattered Mmtes']/following-sibling::div[contains(@class, 'ctsjv-row--padding')][${counter + 1}]/div[contains(@class,'ctsjv-col')][5]//span[@class='ctsjv-button__label']`,
            `Row ${rowIndex} Disputed Scattered Mmte`,
            this.page
        );
        if (await disputedRefMmteElement.isVisibleWithTimeout(3000)) {
            const value = await disputedRefMmteElement.textContentWithTimeout(5000);
            return value?.trim() || '';
        }
        return '';
    }

    /**
     * Get Disputed Start Date value for a specific row in Associated Scattered Mmtes section
     * @param rowIndex - 0-based row index
     * @returns The disputed start date or empty string if not set
     */
    public async getDisputedStartDateValue(rowIndex: number): Promise<string> {
        const counter = rowIndex + 1;
        const disputedDateElement = CSElementFactory.createByXPath(
            `//form[@class='ctsjv-form']//h2[text()='Associated Scattered Mmtes']/following-sibling::div[contains(@class,'ctsjv-row--padding')][${counter + 1}]/div[contains(@class,'ctsjv-col')][6]`,
            `Row ${rowIndex} Disputed Start Date`,
            this.page
        );
        const value = await disputedDateElement.textContentWithTimeout(5000);
        return value?.trim() || '';
    }
