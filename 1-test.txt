// ===================================================================
    // CYLINDER BORINGS METHODS (Per RR05 Req Lines 694-710)
    // ===================================================================

    /**
     * Get borings for a cylinder from database
     * Per RR05 Req Lines 694-697
     * Query: select fwh.fw_boring_desc, to_char(fwh.fw_boring_dt, 'MM/DD/YYYY') as fw_boring_dt
     *        from ctsgapp.fw_boring fwh
     *        inner join ctsgapp.fw_cylinder fwc on fwc.fw_cylinder_id=fwh.fw_cylinder_id
     *        where fwh.active_fvvvvv='Y' and fwc.fw_cylinder_desc=?
     *        and extract(year from fwh.fw_boring_dt) = extract(year from sysdate)
     *        order by fwh.fw_boring_dt asc
     * @param cylinderName - The cylinder name (e.g., 'USA', 'NYSE & UK')
     * @returns Array of {description, date} objects
     */
    public static async getBoringsForCylinder(cylinderName: string): Promise<Array<{description: string, date: string}>> {
        Tsreporter.info(`Getting borings from database for cylinder: ${cylinderName}`);

        // Per RR05 Req Line 696: Handle '&' character in cylinder name
        let cylinderParam = cylinderName;
        if (cylinderName.includes('&')) {
            // Replace '&' with Oracle chr(38) concatenation
            const parts = cylinderName.split('&');
            cylinderParam = parts.map(p => p.trim()).join("' || chr(38) || '");
        }

        const query = `select fwh.fw_boring_desc, to_char(fwh.fw_boring_dt, 'MM/DD/YYYY') as fw_boring_dt
            from ctsgapp.fw_boring fwh
            inner join ctsgapp.fw_cylinder fwc on fwc.fw_cylinder_id=fwh.fw_cylinder_id
            where fwh.active_fvvvvv='Y' and fwc.fw_cylinder_desc='${cylinderParam}'
            and extract(year from fwh.fw_boring_dt) = extract(year from sysdate)
            order by fwh.fw_boring_dt asc`;

        const result = await CSDBUtils.executeRawQuery(this.DB_ALIAS, query);

        if (!result.rows || result.rows.length === 0) {
            Tsreporter.info(`No borings found for cylinder: ${cylinderName}`);
            return [];
        }

        const borings = result.rows.map((row: any) => ({
            description: row.fw_boring_desc || row.FW_BORING_DESC || '',
            date: row.fw_boring_dt || row.FW_BORING_DT || ''
        }));

        Tsreporter.info(`Found ${borings.length} borings for cylinder: ${cylinderName}`);
        return borings;
    }



    --------------------------------------------------------------------

    // ===================================================================
    // FIRST RULE ASSOCIATED CYLINDERS METHODS (Per RR05 Req Lines 670-720)
    // ===================================================================

    /**
     * Click borings link for a specific cylinder in First Rule section
     * Per RR05 Req Lines 676-680
     */
    public async clickFirstRuleCylinderBoringsLink(cylinderName: string): Promise<void> {
        Tsreporter.info(`Clicking borings link for First Rule cylinder: ${cylinderName}`);
        const boringsLinkXPath = `//div[@class='body-container']//h5[text()='First Rule']/ancestor::section[1]//h5[normalize-space(text())='If Base Day falls on a Non-Kindness Day, nnnnn to:']/ancestor::div[contains(@class, 'sssss-row')][1]/following-sibling::div[contains(@class, 'sssss-row')][1]//h5[normalize-space(text())='Associated Cylinders']/following-sibling::span[starts-with(normalize-space(.), '${cylinderName} (')]//a[text()='borings']`;
        const boringsLink = CSElementFactory.createByXPath(boringsLinkXPath, `First Rule ${cylinderName} borings link`, this.page);
        await boringsLink.waitForVisible(10000);
        await boringsLink.clickWithTimeout(10000);
        Tsreporter.pass(`Clicked borings link for First Rule cylinder: ${cylinderName}`);
    }

    /**
     * Verify borings popup is displayed
     * Per RR05 Req Line 680
     */
    public async verifyBoringsPopupDisplayed(): Promise<void> {
        Tsreporter.info('Verifying borings popup is displayed');
        const popupXPath = `(//div[@id='sssss-modal-portal']//div[@class='sssss-panel__content-wrapper'])[2]`;
        const popup = CSElementFactory.createByXPath(popupXPath, 'Borings popup', this.page);
        await popup.waitForVisible(10000);
        Tsreporter.pass('Borings popup is displayed');
    }

    /**
     * Verify borings popup header matches cylinder name
     * Per RR05 Req Lines 681-684
     */
    public async verifyBoringsPopupHeader(cylinderName: string): Promise<void> {
        Tsreporter.info(`Verifying borings popup header: ${cylinderName}`);
        const headerXPath = `(//div[@id='sssss-modal-portal']//div[@class='sssss-panel__content-wrapper'])[2]//h5[normalize-space(text())='${cylinderName}']`;
        const header = CSElementFactory.createByXPath(headerXPath, `Borings popup header: ${cylinderName}`, this.page);
        await header.waitForVisible(10000);
        Tsreporter.pass(`Borings popup header verified: ${cylinderName}`);
    }

    /**
     * Verify borings popup close button is present
     * Per RR05 Req Line 685
     */
    public async verifyBoringsPopupCloseButtonPresent(): Promise<void> {
        Tsreporter.info('Verifying borings popup close button is present');
        const closeButtonXPath = `(//div[@id='sssss-modal-portal']//div[@class='sssss-panel__content-wrapper'])[2]//div[contains(@class, 'sssss-panel__header')]//button[contains(@class, 'close')]`;
        const closeButton = CSElementFactory.createByXPath(closeButtonXPath, 'Borings popup close button', this.page);
        await closeButton.waitForVisible(10000);
        Tsreporter.pass('Borings popup close button is present');
    }

    /**
     * Verify borings popup paginator elements are present
     * Per RR05 Req Lines 686-689
     */
    public async verifyBoringsPopupPaginatorPresent(): Promise<void> {
        Tsreporter.info('Verifying borings popup paginator elements');
        const baseXPath = `(//div[@id='sssss-modal-portal']//div[@class='sssss-panel__content-wrapper'])[2]//div[@class='sssss-paginator']`;

        // Current items
        const currentItems = CSElementFactory.createByXPath(`${baseXPath}//span[@class='sssss-paginator__trigger-current-items']`, 'Paginator current items', this.page);
        await currentItems.waitForVisible(10000);

        // Total items
        const totalItems = CSElementFactory.createByXPath(`${baseXPath}//span[@class='sssss-paginator__trigger-total-items']`, 'Paginator total items', this.page);
        await totalItems.waitForVisible(10000);

        // Next button
        const nextButton = CSElementFactory.createByXPath(`${baseXPath}//button[contains(@class, 'sssss-paginator__nav-next-button')]`, 'Paginator next button', this.page);
        await nextButton.waitForVisible(10000);

        // Previous button
        const prevButton = CSElementFactory.createByXPath(`${baseXPath}//button[contains(@class, 'sssss-paginator__nav-prev-button')]`, 'Paginator previous button', this.page);
        await prevButton.waitForVisible(10000);

        Tsreporter.pass('Borings popup paginator elements verified');
    }

    /**
     * Verify borings table and headers are present
     * Per RR05 Req Lines 690-693
     */
    public async verifyBoringsTablePresent(): Promise<void> {
        Tsreporter.info('Verifying borings table and headers');
        const baseXPath = `(//div[@id='sssss-modal-portal']//div[@class='sssss-panel__content-wrapper'])[2]`;

        // Table
        const table = CSElementFactory.createByXPath(`${baseXPath}//table[@class='sssss-table']`, 'Borings table', this.page);
        await table.waitForVisible(10000);

        // Description header
        const descHeader = CSElementFactory.createByXPath(`${baseXPath}//table[@class='sssss-table']/thead//th[normalize-space(text())='Description']`, 'Description header', this.page);
        await descHeader.waitForVisible(10000);

        // Date header
        const dateHeader = CSElementFactory.createByXPath(`${baseXPath}//table[@class='sssss-table']/thead//th[normalize-space(text())='Date']`, 'Date header', this.page);
        await dateHeader.waitForVisible(10000);

        Tsreporter.pass('Borings table and headers verified');
    }

    /**
     * Set borings popup pagination to 50 items per page
     * Per RR05 Req Lines 699-704
     */
    public async setBoringsPaginationTo50(): Promise<void> {
        Tsreporter.info('Setting borings pagination to 50 items per page');
        const baseXPath = `(//div[@id='sssss-modal-portal']//div[@class='sssss-panel__content-wrapper'])[2]`;

        // Click paginator trigger
        const paginatorTrigger = CSElementFactory.createByXPath(`${baseXPath}//div[@class='sssss-paginator']//button[contains(@aria-describedby, 'menuTriggerDetails')]`, 'Paginator trigger', this.page);
        await paginatorTrigger.clickWithTimeout(10000);
        await this.page.waitForTimeout(300);

        // Click 50 option
        const fiftyOption = CSElementFactory.createByXPath(`//div[@class='sssss-menu']//button[normalize-space(text())='50']`, '50 items option', this.page);
        await fiftyOption.waitForVisible(5000);
        await fiftyOption.clickWithTimeout(10000);
        await this.page.waitForTimeout(500);

        Tsreporter.pass('Set borings pagination to 50 items per page');
    }

    /**
     * Get all borings from UI table
     * Per RR05 Req Lines 705-710
     * @returns Array of {description, date} objects
     */
    public async getBoringsFromUI(): Promise<Array<{description: string, date: string}>> {
        Tsreporter.info('Getting borings from UI table');
        const baseXPath = `(//div[@id='sssss-modal-portal']//div[@class='sssss-panel__content-wrapper'])[2]`;
        const borings: Array<{description: string, date: string}> = [];

        // Get all rows
        const rowsXPath = `${baseXPath}//table[@class='sssss-table']/tbody/tr`;
        let rowIndex = 1;
        let hasMoreRows = true;

        while (hasMoreRows) {
            try {
                const descXPath = `${rowsXPath}[${rowIndex}]/td[1]`;
                const dateXPath = `${rowsXPath}[${rowIndex}]/td[2]`;

                const descElement = CSElementFactory.createByXPath(descXPath, `Boring row ${rowIndex} description`, this.page);
                const isVisible = await descElement.isVisibleWithTimeout(2000);

                if (isVisible) {
                    const description = await descElement.textContentWithTimeout(2000) || '';
                    const dateElement = CSElementFactory.createByXPath(dateXPath, `Boring row ${rowIndex} date`, this.page);
                    const date = await dateElement.textContentWithTimeout(2000) || '';
                    borings.push({ description: description.trim(), date: date.trim() });
                    rowIndex++;
                } else {
                    hasMoreRows = false;
                }
            } catch {
                hasMoreRows = false;
            }
        }

        Tsreporter.info(`Found ${borings.length} borings in UI`);
        return borings;
    }

    /**
     * Close borings popup
     */
    public async closeBoringsPopup(): Promise<void> {
        Tsreporter.info('Closing borings popup');
        const closeButtonXPath = `(//div[@id='sssss-modal-portal']//div[@class='sssss-panel__content-wrapper'])[2]//div[contains(@class, 'sssss-panel__header')]//button[contains(@class, 'close')]`;
        const closeButton = CSElementFactory.createByXPath(closeButtonXPath, 'Borings popup close button', this.page);
        await closeButton.clickWithTimeout(10000);
        await this.page.waitForTimeout(300);
        Tsreporter.pass('Closed borings popup');
    }

    // ===================================================================
    // SECOND RULE ASSOCIATED CYLINDERS METHODS (Per RR05 Req Lines 857-900)
    // ===================================================================

    /**
     * Click borings link for a specific cylinder in Second Rule section
     * Per RR05 Req Lines 863-867
     */
    public async clickSecondRuleCylinderBoringsLink(cylinderName: string): Promise<void> {
        Tsreporter.info(`Clicking borings link for Second Rule cylinder: ${cylinderName}`);
        const boringsLinkXPath = `//div[@class='body-container']//h5[text()='Second Rule']/ancestor::section[1]//h5[normalize-space(text())='If Base Day falls on a Non-Kindness Day, nnnnn to:']/ancestor::div[contains(@class, 'sssss-row')][1]/following-sibling::div[contains(@class, 'sssss-row')][1]//h5[normalize-space(text())='Associated Cylinders']/following-sibling::span[starts-with(normalize-space(.), '${cylinderName} (')]//a[text()='borings']`;
        const boringsLink = CSElementFactory.createByXPath(boringsLinkXPath, `Second Rule ${cylinderName} borings link`, this.page);
        await boringsLink.waitForVisible(10000);
        await boringsLink.clickWithTimeout(10000);
        Tsreporter.pass(`Clicked borings link for Second Rule cylinder: ${cylinderName}`);
    }

    // ===================================================================
    // FIRST RULE HOOKWITH ASSOCIATED CYLINDERS METHODS (Per RR05 Req Lines 769-823)
    // ===================================================================

    /**
     * Click borings link for a specific cylinder in First Rule Hookwith section
     * Per RR05 Req Lines 773-777
     */
    public async clickFirstRuleHookwithCylinderBoringsLink(cylinderName: string): Promise<void> {
        Tsreporter.info(`Clicking borings link for First Rule Hookwith cylinder: ${cylinderName}`);
        const boringsLinkXPath = `//div[@class='body-container']//h5[text()='First Rule']/ancestor::section[1]//h5/b[normalize-space(text())='Hookwith']/ancestor::div[starts-with(@class, 'sssss-row')][1]/parent::div/following-sibling::div[starts-with(@class, 'sssss-row')][1]//h5[normalize-space(text())='Associated Cylinders']/following-sibling::span[starts-with(normalize-space(.), '${cylinderName} (')]//a[text()='borings']`;
        const boringsLink = CSElementFactory.createByXPath(boringsLinkXPath, `First Rule Hookwith ${cylinderName} borings link`, this.page);
        await boringsLink.waitForVisible(10000);
        await boringsLink.clickWithTimeout(10000);
        Tsreporter.pass(`Clicked borings link for First Rule Hookwith cylinder: ${cylinderName}`);
    }

    // ===================================================================
    // SECOND RULE HOOKWITH ASSOCIATED CYLINDERS METHODS (Per RR05 Req Lines 956-1010)
    // ===================================================================

    /**
     * Click borings link for a specific cylinder in Second Rule Hookwith section
     * Per RR05 Req Lines 960-964
     */
    public async clickSecondRuleHookwithCylinderBoringsLink(cylinderName: string): Promise<void> {
        Tsreporter.info(`Clicking borings link for Second Rule Hookwith cylinder: ${cylinderName}`);
        const boringsLinkXPath = `//div[@class='body-container']//h5[text()='Second Rule']/ancestor::section[1]//h5/b[normalize-space(text())='Hookwith']/ancestor::div[starts-with(@class, 'sssss-row')][1]/parent::div/following-sibling::div[starts-with(@class, 'sssss-row')][1]//h5[normalize-space(text())='Associated Cylinders']/following-sibling::span[starts-with(normalize-space(.), '${cylinderName} (')]//a[text()='borings']`;
        const boringsLink = CSElementFactory.createByXPath(boringsLinkXPath, `Second Rule Hookwith ${cylinderName} borings link`, this.page);
        await boringsLink.waitForVisible(10000);
        await boringsLink.clickWithTimeout(10000);
        Tsreporter.pass(`Clicked borings link for Second Rule Hookwith cylinder: ${cylinderName}`);
    }



-------------------------------------------------------------------------

 @TSBDDStepDef('Methodology Type value should be Sport Mmte Lookup')
    async verifyMethodologyTypeIsSportMmteLookup(): Promise<void> {
        Tsreporter.info('Verifying Methodology Type value is Sport Mmte Lookup');
        // Per RR05 Req Lines 628-630: Use specific XPath for Conditions section
        const value = await this.scatteredMmteDetailsPage.getMethodologyTypeValue();
        if (value !== 'Sport Mmte Lookup') {
            throw new Error(`Expected Methodology Type to be 'Sport Mmte Lookup' but got '${value}'`);
        }
        Tsreporter.pass('Methodology Type value is Sport Mmte Lookup');
    }

    @TSBDDStepDef('Sport Mmte Rule Priority value should match {string}')
    async verifySportMmteRulePriorityValueMatches(expectedValue: string): Promise<void> {
        const actualExpected = CSValueResolver.resolve(expectedValue, this.context);
        Tsreporter.info(`Verifying Sport Mmte Rule Priority value matches: ${actualExpected}`);
        // Per RR05 Req Lines 632-635: Use specific XPath for Conditions section
        const value = await this.scatteredMmteDetailsPage.getSportMmteRulePriorityValue();
        if (value !== actualExpected) {
            throw new Error(`Expected Sport Mmte Rule Priority '${actualExpected}' but got '${value}'`);
        }
        Tsreporter.pass(`Sport Mmte Rule Priority value matches: ${actualExpected}`);
    }




    @TSBDDStepDef('First Rule Associated Cylinders should match expected with borings links')
    async verifyFirstRuleAssociatedCylindersMatchExpectedWithLinks(): Promise<void> {
        Tsreporter.info('Verifying First Rule Associated Cylinders match expected with borings links');

        // Per RR05 Req Line 672: Get cylinders from scenario context
        const firstRuleAssociateCylinders = this.scenarioContext.getVariable('firstRuleAssociateCylinders');

        if (!firstRuleAssociateCylinders) {
            Tsreporter.info('First Rule Associate Cylinders not configured, skipping verification');
            Tsreporter.pass('First Rule Associated Cylinders verified (skipped - not configured)');
            return;
        }

        // Per RR05 Req Line 673: Split by comma
        const cylinders = firstRuleAssociateCylinders.split(',').map((c: string) => c.trim()).filter((c: string) => c.length > 0);

        // Per RR05 Req Lines 674-720: For each cylinder
        for (const cylinderName of cylinders) {
            Tsreporter.info(`Verifying borings for cylinder: ${cylinderName}`);

            // Per RR05 Req Lines 679-680: Click borings link and wait for popup
            await this.scatteredMmteDetailsPage.clickFirstRuleCylinderBoringsLink(cylinderName);
            await this.scatteredMmteDetailsPage.verifyBoringsPopupDisplayed();

            // Per RR05 Req Lines 681-684: Verify popup header
            await this.scatteredMmteDetailsPage.verifyBoringsPopupHeader(cylinderName);

            // Per RR05 Req Line 685: Verify close button present
            await this.scatteredMmteDetailsPage.verifyBoringsPopupCloseButtonPresent();

            // Per RR05 Req Lines 686-689: Verify paginator elements
            await this.scatteredMmteDetailsPage.verifyBoringsPopupPaginatorPresent();

            // Per RR05 Req Lines 690-693: Verify table and headers
            await this.scatteredMmteDetailsPage.verifyBoringsTablePresent();

            // Per RR05 Req Lines 694-697: Get borings from database
            const dbBorings = await TTTFDatabaseHelper.getBoringsForCylinder(cylinderName);

            // Per RR05 Req Lines 699-704: Set pagination to 50
            await this.scatteredMmteDetailsPage.setBoringsPaginationTo50();

            // Per RR05 Req Lines 705-710: Get borings from UI
            const uiBorings = await this.scatteredMmteDetailsPage.getBoringsFromUI();

            // Per RR05 Req Lines 711-718: Compare DB and UI borings
            Tsreporter.info(`Comparing borings - DB: ${dbBorings.length}, UI: ${uiBorings.length}`);

            if (dbBorings.length !== uiBorings.length) {
                throw new Error(`Boring count mismatch for ${cylinderName}. DB: ${dbBorings.length}, UI: ${uiBorings.length}`);
            }

            for (let i = 0; i < dbBorings.length; i++) {
                const dbBoring = dbBorings[i];
                const uiBoring = uiBorings[i];

                if (dbBoring.description !== uiBoring.description) {
                    throw new Error(`Boring description mismatch at row ${i + 1} for ${cylinderName}. DB: '${dbBoring.description}', UI: '${uiBoring.description}'`);
                }
                if (dbBoring.date !== uiBoring.date) {
                    throw new Error(`Boring date mismatch at row ${i + 1} for ${cylinderName}. DB: '${dbBoring.date}', UI: '${uiBoring.date}'`);
                }
            }

            Tsreporter.pass(`Borings verified for cylinder: ${cylinderName}`);

            // Close popup before next cylinder
            await this.scatteredMmteDetailsPage.closeBoringsPopup();
        }

        Tsreporter.pass('First Rule Associated Cylinders with borings links verified');
    }






    @TSBDDStepDef('First Rule Hookwith Associated Cylinders should match expected with borings links')
    async verifyFirstRuleHookwithAssociatedCylindersMatchExpectedWithLinks(): Promise<void> {
        Tsreporter.info('Verifying First Rule Hookwith Associated Cylinders match expected with borings links');

        // Per RR05 Req Line 769: Get cylinders from scenario context
        const firstRuleHookwithCylinders = this.scenarioContext.getVariable('firstRuleAddToHookwithDaysAssociateCylinders');

        if (!firstRuleHookwithCylinders) {
            Tsreporter.info('First Rule Hookwith Associate Cylinders not configured, skipping verification');
            Tsreporter.pass('First Rule Hookwith Associated Cylinders verified (skipped - not configured)');
            return;
        }

        // Per RR05 Req Line 770: Split by comma
        const cylinders = firstRuleHookwithCylinders.split(',').map((c: string) => c.trim()).filter((c: string) => c.length > 0);

        // Per RR05 Req Lines 771-823: For each cylinder
        for (const cylinderName of cylinders) {
            Tsreporter.info(`Verifying borings for First Rule Hookwith cylinder: ${cylinderName}`);

            // Per RR05 Req Lines 776-777: Click borings link and wait for popup
            await this.scatteredMmteDetailsPage.clickFirstRuleHookwithCylinderBoringsLink(cylinderName);
            await this.scatteredMmteDetailsPage.verifyBoringsPopupDisplayed();

            // Per RR05 Req Lines 778-781: Verify popup header
            await this.scatteredMmteDetailsPage.verifyBoringsPopupHeader(cylinderName);

            // Per RR05 Req Line 782: Verify close button present
            await this.scatteredMmteDetailsPage.verifyBoringsPopupCloseButtonPresent();

            // Per RR05 Req Lines 783-786: Verify paginator elements
            await this.scatteredMmteDetailsPage.verifyBoringsPopupPaginatorPresent();

            // Per RR05 Req Lines 787-790: Verify table and headers
            await this.scatteredMmteDetailsPage.verifyBoringsTablePresent();

            // Per RR05 Req Lines 791-794: Get borings from database
            const dbBorings = await TTTFDatabaseHelper.getBoringsForCylinder(cylinderName);

            // Per RR05 Req Lines 796-807: Set pagination to 50
            await this.scatteredMmteDetailsPage.setBoringsPaginationTo50();

            // Per RR05 Req Lines 808-819: Get borings from UI
            const uiBorings = await this.scatteredMmteDetailsPage.getBoringsFromUI();

            // Per RR05 Req Lines 820-821: Compare DB and UI borings
            Tsreporter.info(`Comparing Hookwith borings - DB: ${dbBorings.length}, UI: ${uiBorings.length}`);

            if (dbBorings.length !== uiBorings.length) {
                throw new Error(`Hookwith Boring count mismatch for ${cylinderName}. DB: ${dbBorings.length}, UI: ${uiBorings.length}`);
            }

            for (let i = 0; i < dbBorings.length; i++) {
                const dbBoring = dbBorings[i];
                const uiBoring = uiBorings[i];

                if (dbBoring.description !== uiBoring.description) {
                    throw new Error(`Hookwith Boring description mismatch at row ${i + 1} for ${cylinderName}. DB: '${dbBoring.description}', UI: '${uiBoring.description}'`);
                }
                if (dbBoring.date !== uiBoring.date) {
                    throw new Error(`Hookwith Boring date mismatch at row ${i + 1} for ${cylinderName}. DB: '${dbBoring.date}', UI: '${uiBoring.date}'`);
                }
            }

            Tsreporter.pass(`Hookwith borings verified for cylinder: ${cylinderName}`);

            // Per RR05 Req Lines 822-823: Close popup before next cylinder
            await this.scatteredMmteDetailsPage.closeBoringsPopup();
        }

        Tsreporter.pass('First Rule Hookwith Associated Cylinders with borings links verified');
    }






    @TSBDDStepDef('Second Rule Associated Cylinders should match expected with borings links')
    async verifySecondRuleAssociatedCylindersMatchExpectedWithLinks(): Promise<void> {
        Tsreporter.info('Verifying Second Rule Associated Cylinders match expected with borings links');

        // Per RR05 Req Line 859: Get cylinders from scenario context
        const secondRuleBaseDayAssociateCylinders = this.scenarioContext.getVariable('secondRuleBaseDayAssociateCylinders');

        if (!secondRuleBaseDayAssociateCylinders) {
            Tsreporter.info('Second Rule Associate Cylinders not configured, skipping verification');
            Tsreporter.pass('Second Rule Associated Cylinders verified (skipped - not configured)');
            return;
        }

        // Per RR05 Req Line 860: Split by comma
        const cylinders = secondRuleBaseDayAssociateCylinders.split(',').map((c: string) => c.trim()).filter((c: string) => c.length > 0);

        // Per RR05 Req Lines 861-900: For each cylinder
        for (const cylinderName of cylinders) {
            Tsreporter.info(`Verifying borings for Second Rule cylinder: ${cylinderName}`);

            // Per RR05 Req Lines 866-867: Click borings link and wait for popup
            await this.scatteredMmteDetailsPage.clickSecondRuleCylinderBoringsLink(cylinderName);
            await this.scatteredMmteDetailsPage.verifyBoringsPopupDisplayed();

            // Per RR05 Req Lines 868-871: Verify popup header
            await this.scatteredMmteDetailsPage.verifyBoringsPopupHeader(cylinderName);

            // Per RR05 Req Line 872: Verify close button present
            await this.scatteredMmteDetailsPage.verifyBoringsPopupCloseButtonPresent();

            // Per RR05 Req Lines 873-876: Verify paginator elements
            await this.scatteredMmteDetailsPage.verifyBoringsPopupPaginatorPresent();

            // Per RR05 Req Lines 877-880: Verify table and headers
            await this.scatteredMmteDetailsPage.verifyBoringsTablePresent();

            // Per RR05 Req Lines 881-884: Get borings from database
            const dbBorings = await TTTFDatabaseHelper.getBoringsForCylinder(cylinderName);

            // Per RR05 Req Lines 886-887: Set pagination to 50
            await this.scatteredMmteDetailsPage.setBoringsPaginationTo50();

            // Get borings from UI
            const uiBorings = await this.scatteredMmteDetailsPage.getBoringsFromUI();

            // Compare DB and UI borings
            Tsreporter.info(`Comparing borings - DB: ${dbBorings.length}, UI: ${uiBorings.length}`);

            if (dbBorings.length !== uiBorings.length) {
                throw new Error(`Boring count mismatch for ${cylinderName}. DB: ${dbBorings.length}, UI: ${uiBorings.length}`);
            }

            for (let i = 0; i < dbBorings.length; i++) {
                const dbBoring = dbBorings[i];
                const uiBoring = uiBorings[i];

                if (dbBoring.description !== uiBoring.description) {
                    throw new Error(`Boring description mismatch at row ${i + 1} for ${cylinderName}. DB: '${dbBoring.description}', UI: '${uiBoring.description}'`);
                }
                if (dbBoring.date !== uiBoring.date) {
                    throw new Error(`Boring date mismatch at row ${i + 1} for ${cylinderName}. DB: '${dbBoring.date}', UI: '${uiBoring.date}'`);
                }
            }

            Tsreporter.pass(`Borings verified for Second Rule cylinder: ${cylinderName}`);

            // Close popup before next cylinder
            await this.scatteredMmteDetailsPage.closeBoringsPopup();
        }

        Tsreporter.pass('Second Rule Associated Cylinders with borings links verified');
    }




    @TSBDDStepDef('Second Rule Hookwith Associated Cylinders should match expected with borings links')
    async verifySecondRuleHookwithAssociatedCylindersMatchExpectedWithLinks(): Promise<void> {
        Tsreporter.info('Verifying Second Rule Hookwith Associated Cylinders match expected with borings links');

        // Per RR05 Req Line 956: Get cylinders from scenario context
        const secondRuleHookwithCylinders = this.scenarioContext.getVariable('secondRuleAddToHookwithDaysAssociateCylinders');

        if (!secondRuleHookwithCylinders) {
            Tsreporter.info('Second Rule Hookwith Associate Cylinders not configured, skipping verification');
            Tsreporter.pass('Second Rule Hookwith Associated Cylinders verified (skipped - not configured)');
            return;
        }

        // Per RR05 Req Line 957: Split by comma
        const cylinders = secondRuleHookwithCylinders.split(',').map((c: string) => c.trim()).filter((c: string) => c.length > 0);

        // Per RR05 Req Lines 958-1010: For each cylinder
        for (const cylinderName of cylinders) {
            Tsreporter.info(`Verifying borings for Second Rule Hookwith cylinder: ${cylinderName}`);

            // Per RR05 Req Lines 963-964: Click borings link and wait for popup
            await this.scatteredMmteDetailsPage.clickSecondRuleHookwithCylinderBoringsLink(cylinderName);
            await this.scatteredMmteDetailsPage.verifyBoringsPopupDisplayed();

            // Per RR05 Req Lines 965-968: Verify popup header
            await this.scatteredMmteDetailsPage.verifyBoringsPopupHeader(cylinderName);

            // Per RR05 Req Line 969: Verify close button present
            await this.scatteredMmteDetailsPage.verifyBoringsPopupCloseButtonPresent();

            // Per RR05 Req Lines 970-973: Verify paginator elements
            await this.scatteredMmteDetailsPage.verifyBoringsPopupPaginatorPresent();

            // Per RR05 Req Lines 974-977: Verify table and headers
            await this.scatteredMmteDetailsPage.verifyBoringsTablePresent();

            // Per RR05 Req Lines 978-981: Get borings from database
            const dbBorings = await TTTFDatabaseHelper.getBoringsForCylinder(cylinderName);

            // Per RR05 Req Lines 983-994: Set pagination to 50
            await this.scatteredMmteDetailsPage.setBoringsPaginationTo50();

            // Per RR05 Req Lines 995-1006: Get borings from UI
            const uiBorings = await this.scatteredMmteDetailsPage.getBoringsFromUI();

            // Per RR05 Req Lines 1007-1008: Compare DB and UI borings
            Tsreporter.info(`Comparing Second Rule Hookwith borings - DB: ${dbBorings.length}, UI: ${uiBorings.length}`);

            if (dbBorings.length !== uiBorings.length) {
                throw new Error(`Second Rule Hookwith Boring count mismatch for ${cylinderName}. DB: ${dbBorings.length}, UI: ${uiBorings.length}`);
            }

            for (let i = 0; i < dbBorings.length; i++) {
                const dbBoring = dbBorings[i];
                const uiBoring = uiBorings[i];

                if (dbBoring.description !== uiBoring.description) {
                    throw new Error(`Second Rule Hookwith Boring description mismatch at row ${i + 1} for ${cylinderName}. DB: '${dbBoring.description}', UI: '${uiBoring.description}'`);
                }
                if (dbBoring.date !== uiBoring.date) {
                    throw new Error(`Second Rule Hookwith Boring date mismatch at row ${i + 1} for ${cylinderName}. DB: '${dbBoring.date}', UI: '${uiBoring.date}'`);
                }
            }

            Tsreporter.pass(`Second Rule Hookwith borings verified for cylinder: ${cylinderName}`);

            // Per RR05 Req Lines 1009-1010: Close popup before next cylinder
            await this.scatteredMmteDetailsPage.closeBoringsPopup();
        }

        Tsreporter.pass('Second Rule Hookwith Associated Cylinders with borings links verified');
    }


