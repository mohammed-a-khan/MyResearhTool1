// ===================================================================
    // CYLINDER POPUP METHODS (RR03-03, RR03-08)
    // Requirement Lines 606-631: Cylinder Add modal popup for filter panel
    // ===================================================================

    /**
     * Verify Cylinder Add modal popup is displayed
     * Requirement Line 606: xpath: //div[@class='sssss-modal']//div[@class='sssss-panel__content-wrapper']
     */
    public async verifyCylinderPopupDisplayed(): Promise<void> {
        Tsreporter.info('Verifying Cylinder Add modal popup is displayed');
        const popup = CSElementFactory.createByXPath(
            '//div[@class="sssss-modal"]//div[@class="sssss-panel__content-wrapper"]',
            'Cylinder Add modal popup',
            this.page
        );
        await popup.waitForVisible(10000);
        Tsreporter.pass('Cylinder Add modal popup is displayed');
    }

    /**
     * Verify Cylinder Add popup header
     * Requirement Line 608: xpath: //div[@class='sssss-panel__content-wrapper']//h5[text()='Add']
     */
    public async verifyCylinderPopupHeader(): Promise<void> {
        Tsreporter.info('Verifying Cylinder Add popup header');
        const header = CSElementFactory.createByXPath(
            '//div[@class="sssss-panel__content-wrapper"]//h5[text()="Add"]',
            'Cylinder Add popup header',
            this.page
        );
        await header.waitForVisible(10000);
        Tsreporter.pass('Cylinder Add popup header is displayed');
    }

    /**
     * Verify Cylinder Name header in table
     * Requirement Line 615: xpath: //div[@class='sssss-panel__content-wrapper']//div[@class='sssss-panel__body']//table[@class='sssss-table']/thead/tr[1]/th[@class='sssss-table__header' and text()='Cylinder Name']
     */
    public async verifyCylinderPopupTableHeader(): Promise<void> {
        Tsreporter.info('Verifying Cylinder Name header in popup table');
        const header = CSElementFactory.createByXPath(
            '//div[@class="sssss-panel__content-wrapper"]//div[@class="sssss-panel__body"]//table[@class="sssss-table"]/thead/tr[1]/th[@class="sssss-table__header" and text()="Cylinder Name"]',
            'Cylinder Name table header',
            this.page
        );
        await header.waitForVisible(10000);
        Tsreporter.pass('Cylinder Name header is displayed');
    }

    /**
     * Verify Cylinder popup options match database records
     * Requirement Line 621: xpath: //div[@class='sssss-panel__content-wrapper']//div[@class='sssss-panel__body']//table[@class='sssss-table']/tbody/td[text()='<cylinderName>']
     */
    public async verifyCylinderPopupOptions(expectedCylinders: string[]): Promise<void> {
        Tsreporter.info('Verifying Cylinder popup options match database records');
        for (const cylinder of expectedCylinders) {
            const optionElement = CSElementFactory.createByXPath(
                `//div[@class="sssss-panel__content-wrapper"]//div[@class="sssss-panel__body"]//table[@class="sssss-table"]/tbody//td[text()="${cylinder}"]`,
                `Cylinder option: ${cylinder}`,
                this.page
            );
            const isVisible = await optionElement.isVisibleWithTimeout(3000);
            if (isVisible) {
                Tsreporter.debug(`Cylinder option '${cylinder}' is present`);
            } else {
                Tsreporter.warn(`Cylinder option '${cylinder}' not found in popup`);
            }
        }
        Tsreporter.pass('Verified Cylinder popup options');
    }

    /**
     * Select cylinder from popup table
     * Requirement Line 626: xpath: //div[@class='sssss-panel__content-wrapper']//div[@class='sssss-panel__body']//table[@class='sssss-table']/tbody/td[text()='<cylinderName>']/parent::tr/td[1]//span[@role='checkbox']
     * Requirement Line 628 (alternative after click): xpath: //div[@class='sssss-panel__content-wrapper']//div[@class='sssss-panel__body']//table[@class='sssss-table']/tbody/td/div[text()='<cylinderName>']/ancestor::tr[1]/td[1]//span[@role='checkbox']
     */
    public async selectCylinderInPopup(cylinderName: string): Promise<void> {
        Tsreporter.info(`Selecting cylinder in popup: ${cylinderName}`);
        // Try primary XPath first (text directly in td)
        let cylinderCheckbox = CSElementFactory.createByXPath(
            `//div[@class="sssss-panel__content-wrapper"]//div[@class="sssss-panel__body"]//table[@class="sssss-table"]/tbody//td[text()="${cylinderName}"]/parent::tr/td[1]//span[@role="checkbox"]`,
            `Cylinder checkbox: ${cylinderName}`,
            this.page
        );
        let isVisible = await cylinderCheckbox.isVisibleWithTimeout(3000);

        if (!isVisible) {
            // Try alternative XPath (text in div inside td)
            Tsreporter.info('Trying alternative XPath for cylinder checkbox');
            cylinderCheckbox = CSElementFactory.createByXPath(
                `//div[@class="sssss-panel__content-wrapper"]//div[@class="sssss-panel__body"]//table[@class="sssss-table"]/tbody//td/div[text()="${cylinderName}"]/ancestor::tr[1]/td[1]//span[@role="checkbox"]`,
                `Cylinder checkbox (alt): ${cylinderName}`,
                this.page
            );
            isVisible = await cylinderCheckbox.isVisibleWithTimeout(3000);
        }

        if (!isVisible) {
            throw new Error(`Cylinder checkbox for '${cylinderName}' not found in popup`);
        }

        // Check if already selected
        const ariaChecked = await cylinderCheckbox.getAttributeWithTimeout('aria-checked', 5000);
        if (ariaChecked === 'false') {
            await cylinderCheckbox.clickWithTimeout(10000);
            await this.page.waitForTimeout(500);
            Tsreporter.pass(`Selected cylinder: ${cylinderName}`);
        } else {
            Tsreporter.info(`Cylinder '${cylinderName}' is already selected`);
        }
    }

    /**
     * Click Apply button on Cylinder popup
     * Requirement Line 630: xpath: //div[@class='sssss-panel__content-wrapper']//div[@class='sssss-panel__footer']//span[@class='sssss-button__label' and contains(text(),'Apply')]/parent::button[1]
     */
    public async clickCylinderPopupApplyButton(): Promise<void> {
        Tsreporter.info('Clicking Apply button on Cylinder popup');
        const applyButton = CSElementFactory.createByXPath(
            '//div[@class="sssss-panel__content-wrapper"]//div[@class="sssss-panel__footer"]//span[@class="sssss-button__label" and contains(text(),"Apply")]/parent::button[1]',
            'Cylinder popup Apply button',
            this.page
        );
        await applyButton.waitForVisible(10000);
        await applyButton.clickWithTimeout(10000);
        // Wait for popup to close (Requirement Line 631)
        const popup = CSElementFactory.createByXPath(
            '//div[@class="sssss-modal"]//div[@class="sssss-panel__content-wrapper"]',
            'Cylinder modal popup',
            this.page
        );
        await popup.waitForDetached(10000);
        Tsreporter.pass('Clicked Apply button and popup closed');
    }

    /**
     * Click Cancel button on Cylinder popup
     * Requirement Line 624: xpath: //div[@class='sssss-panel__content-wrapper']//div[@class='sssss-panel__footer']//span[@class='sssss-button__label' and text()='Cancel']/parent::button[1]
     */
    public async clickCylinderPopupCancelButton(): Promise<void> {
        Tsreporter.info('Clicking Cancel button on Cylinder popup');
        const cancelButton = CSElementFactory.createByXPath(
            '//div[@class="sssss-panel__content-wrapper"]//div[@class="sssss-panel__footer"]//span[@class="sssss-button__label" and text()="Cancel"]/parent::button[1]',
            'Cylinder popup Cancel button',
            this.page
        );
        await cancelButton.waitForVisible(10000);
        await cancelButton.clickWithTimeout(10000);
        await this.page.waitForTimeout(500);
        Tsreporter.pass('Clicked Cancel button on Cylinder popup');
    }
