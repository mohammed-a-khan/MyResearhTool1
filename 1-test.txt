// ===================================================================
    // FILTERS APPLIED PANEL STEPS (MISSING)
    // ===================================================================

    @TSBDDStepDef('I should see Filters Applied button')
    async verifyFiltersAppliedButtonVisible(): Promise<void> {
        CSReporter.info('Verifying Filters Applied button is visible');
        await this.scatteredMmtesPage.filtersAppliedButton.waitForVisible(10000);
        CSReporter.pass('Filters Applied button is visible');
    }

    @TSBDDStepDef('I expand Filters Applied panel if collapsed')
    async expandFiltersAppliedPanelIfCollapsed(): Promise<void> {
        CSReporter.info('Expanding Filters Applied panel if collapsed');

        // Check if filter panel is already expanded
        const filterCriteriaHeader = CSElementFactory.createByXPath(
            '//div[@id="inlineFilterSportMmte"]//legend[text()="Filter criteria"]',
            'Filter criteria header',
            this.scatteredMmtesPage.getPage()
        );

        const isExpanded = await filterCriteriaHeader.isVisibleWithTimeout(3000);

        if (!isExpanded) {
            // Click Filters Applied button to expand
            await this.scatteredMmtesPage.filtersAppliedButton.clickWithTimeout(10000);
            // Wait for filter panel to expand
            await filterCriteriaHeader.waitForVisible(10000);
            CSReporter.pass('Filters Applied panel expanded');
        } else {
            CSReporter.info('Filters Applied panel is already expanded');
        }
    }

    @TSBDDStepDef('Filters area should be expanded')
    async verifyFiltersAreaExpanded(): Promise<void> {
        CSReporter.info('Verifying Filters area is expanded');

        const filterCriteriaHeader = CSElementFactory.createByXPath(
            '//div[@id="inlineFilterSportMmte"]//legend[text()="Filter criteria"]',
            'Filter criteria header',
            this.scatteredMmtesPage.getPage()
        );

        const isExpanded = await filterCriteriaHeader.isVisibleWithTimeout(5000);
        if (!isExpanded) {
            throw new Error('Filters area is not expanded');
        }
        CSReporter.pass('Filters area is expanded');
    }

    @TSBDDStepDef('Filter criteria section should be collapsed')
    async verifyFilterCriteriaSectionCollapsed(): Promise<void> {
        CSReporter.info('Verifying Filter criteria section is collapsed');

        const filterCriteriaHeader = CSElementFactory.createByXPath(
            '//div[@id="inlineFilterSportMmte"]//legend[text()="Filter criteria"]',
            'Filter criteria header',
            this.scatteredMmtesPage.getPage()
        );

        const isExpanded = await filterCriteriaHeader.isVisibleWithTimeout(2000);
        if (isExpanded) {
            throw new Error('Filter criteria section should be collapsed');
        }
        CSReporter.pass('Filter criteria section is collapsed');
    }

    @TSBDDStepDef('I select sport mmte rule priority {string} defaulting to Lowest Date')
    async selectSportMmteRulePriorityDefaultingToLowestDate(priority: string): Promise<void> {
        const actualPriority = CSValueResolver.resolve(priority, this.context);

        // If priority is empty or not provided, default to 'Lowest Date'
        const priorityToSelect = (!actualPriority || actualPriority.trim() === '') ? 'Lowest Date' : actualPriority;

        CSReporter.info(`Selecting Sport Mmte Rule Priority: ${priorityToSelect} (input: ${actualPriority || 'empty'})`);

        // Use the page method to select priority
        await this.scatteredMmtesPage.selectFilterSportMmteRulePriority(priorityToSelect);

        this.scenarioContext.setVariable('sportMmteRulePriority', priorityToSelect);
        CSReporter.pass(`Selected Sport Mmte Rule Priority: ${priorityToSelect}`);
    }

    // ===================================================================
    // ADDITIONAL MISSING STEPS
    // ===================================================================

    @TSBDDStepDef('Reset Filters button should be disabled')
    async verifyResetFiltersButtonDisabled(): Promise<void> {
        CSReporter.info('Verifying Reset Filters button is disabled');
        const resetFiltersButton = CSElementFactory.createByXPath(
            '//div[@id="inlineFilterSportMmte"]//button[contains(@class,"sssss-inline-filter-header-actions__clear-button")]',
            'Reset Filters button',
            this.scatteredMmtesPage.getPage()
        );
        const isEnabled = await resetFiltersButton.isEnabledWithTimeout(5000);
        if (isEnabled) {
            throw new Error('Reset Filters button should be disabled');
        }
        CSReporter.pass('Reset Filters button is disabled');
    }

    @TSBDDStepDef('I should see Reset Filters button enabled')
    async verifyResetFiltersButtonEnabled(): Promise<void> {
        CSReporter.info('Verifying Reset Filters button is enabled');
        const resetFiltersButton = CSElementFactory.createByXPath(
            '//div[@id="inlineFilterSportMmte"]//button[contains(@class,"sssss-inline-filter-header-actions__clear-button")]',
            'Reset Filters button',
            this.scatteredMmtesPage.getPage()
        );
        const isEnabled = await resetFiltersButton.isEnabledWithTimeout(5000);
        if (!isEnabled) {
            throw new Error('Reset Filters button should be enabled');
        }
        CSReporter.pass('Reset Filters button is enabled');
    }

    @TSBDDStepDef('all Cumulative Mmte options should match database records')
    async verifyAllCumulativeMmteOptionsMatchDatabase(): Promise<void> {
        CSReporter.info('Verifying all Cumulative Mmte options match database records');

        // Get cumulative mmtes from database
        const dbCumulativeMmtes = await TTTFDatabaseHelper.getAllActiveCumulativeMmteNames();
        CSReporter.info(`Found ${dbCumulativeMmtes.length} cumulative mmtes in database`);

        // Get UI options
        const uiOptions: string[] = [];
        const optionElements = await this.scatteredMmtesPage.getPage().locator(
            '//div[@id="inlineFilterSportMmte"]//button[@name="cumulativeMmteName"]/following-sibling::ul//li'
        ).all();

        for (const option of optionElements) {
            const text = await option.textContent();
            if (text && text.trim() !== 'Select') {
                uiOptions.push(text.trim());
            }
        }

        CSReporter.info(`Found ${uiOptions.length} cumulative mmte options in UI`);

        // Verify counts match (allowing for some variation)
        if (Math.abs(dbCumulativeMmtes.length - uiOptions.length) > 5) {
            CSReporter.warn(`Cumulative mmte count mismatch: DB=${dbCumulativeMmtes.length}, UI=${uiOptions.length}`);
        }

        CSReporter.pass('Cumulative Mmte options verification complete');
    }
