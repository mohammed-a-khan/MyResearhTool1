# CS Playwright TypeScript Framework — Copilot Instructions

> Convert Selenium/Java/QAF scripts OR create new test scripts. Code must be execution-ready on first attempt.

**MANDATORY**: Also refer to `.github/code-examples.md` for detailed code examples.

---

## 1. MANDATORY RULES (Never Skip)

| Rule | Description |
|------|-------------|
| **RULE 1** | Use CORRECT module-specific imports — NEVER single barrel import. See Section 12. |
| **RULE 2** | CSReporter uses STATIC methods — `CSReporter.info()`. NEVER `getInstance()`. |
| **RULE 3** | Page classes MUST implement `initializeElements()` — Required abstract method. |
| **RULE 4** | NEVER redeclare inherited properties — `config`, `browserManager`, `page`, `url`, `elements` are `protected` in CSBasePage. |
| **RULE 5** | NEVER create index.ts or barrel files — Each file standalone. |
| **RULE 6** | All element locators MUST be in page classes — Never in steps/specs. |
| **RULE 7** | All DB queries MUST be in .env files — Never hardcoded. |
| **RULE 8** | Never use raw Playwright APIs — No `page.locator()`, `page.click()`, `page.goto()`. |
| **RULE 9** | Config uses `environments/` subfolder — `config/<project>/environments/dev.env`. |
| **RULE 10** | Check framework utilities first — 310+ methods across 8 classes. |
| **RULE 11** | Use JSON for test data — Not Excel. |
| **RULE 12** | NO duplicate method names — Search ALL classes/packages before creating any method. |
| **RULE 13** | NO duplicate step definitions — Search ALL step files before creating any @CSBDDStepDef. |

### Pre-Implementation Checklist (MANDATORY)

Before creating ANY method or step definition:

1. **Search for existing methods**: Use codebase search to find methods with similar names or functionality across ALL page classes, helpers, and utilities
2. **Search for existing steps**: Use codebase search to find step definitions with similar patterns across ALL step files
3. **Reuse if exists**: If a similar method/step exists, reuse it or extend it — DO NOT create duplicates
4. **Unique naming**: Only create new methods/steps if NO existing implementation covers the need
5. **Consistent naming**: Follow existing naming conventions in the codebase

**Search Commands Before Implementation:**
```bash
# Search for method names across all TypeScript files
grep -r "methodName" --include="*.ts" test/<project>/

# Search for step patterns across all step files
grep -r "step pattern text" --include="*.steps.ts" test/<project>/steps/
```

---

## 2. Project Structure

```
test/<project>/
├── pages/           # Page objects - NO index.ts
├── steps/           # BDD step definitions (.steps.ts)
├── features/        # BDD Gherkin files (.feature)
├── specs/           # Spec style tests (.spec.ts)
├── data/            # JSON test data files
└── helpers/         # Project-specific helpers

config/<project>/
├── common/          # common.env, <project>-db-queries.env
├── environments/    # dev.env, sit.env, uat.env, prod.env
└── global.env
```

**File Naming Conventions (STRICT):**

| Type | Pattern | Example | WRONG |
|------|---------|---------|-------|
| Page class | `<Module>Page.ts` (PascalCase) | `LoginPage.ts`, `UserProfilePage.ts` | `loginPage.ts` |
| Step file | `<area>.steps.ts` (kebab-case) | `user-login.steps.ts`, `order-management.steps.ts` | `UserLoginSteps.java` |
| Feature | `<feature>.feature` (kebab-case) | `user-login.feature` | `UserLogin.feature` |
| Spec | `<feature>.spec.ts` (kebab-case) | `user-login.spec.ts` | `UserLoginSpec.ts` |
| Data | `<feature>-data.json` (kebab-case) | `user-login-data.json` | `userLoginData.json` |

**CRITICAL**: All files are TypeScript (.ts) — NEVER .java. Step files use kebab-case, NOT PascalCase.

---

## 3. Page Object Pattern

**Key Points:**
- Extend `CSBasePage`, use `@CSPage('identifier')` decorator
- Use `@CSGetElement({ xpath/css, description, waitForVisible, alternativeLocators })` for elements
- MUST implement `protected initializeElements(): void { CSReporter.debug('...'); }`
- DO NOT redeclare inherited properties (`config`, `browserManager`, `page`, `url`, `elements`)
- Use `CSElementFactory.createByXPath/CSS/Text()` for dynamic elements

**See**: `code-examples.md` Section 1 for complete example.

---

## 4. @CSGetElement Options

| Option | Type | Description |
|--------|------|-------------|
| `xpath` | string | XPath locator |
| `css` | string | CSS selector |
| `description` | string | Element description for reporting |
| `waitForVisible` | boolean | Wait for visibility on access |
| `waitForEnabled` | boolean | Wait for enabled state |
| `alternativeLocators` | string[] | Fallbacks (prefix: `css:`, `xpath:`, `text:`) |
| `selfHeal` | boolean | Enable AI self-healing |

---

## 5. CSWebElement Methods

**Actions**: `click()`, `dblclick()`, `fill(value)`, `clear()`, `type(text)`, `press(key)`, `selectOption(value/{label}/{index})`, `check()`, `uncheck()`, `hover()`, `focus()`, `setInputFiles()`, `dragTo()`

**With Timeout**: `clickWithTimeout()`, `fillWithTimeout()`, `clearWithTimeout()`

**State**: `isVisible()`, `isEnabled()`, `isChecked()`, `isDisabled()`, `isHidden()`, `isEditable()`

**Data**: `textContent()`, `innerText()`, `inputValue()`, `getAttribute()`, `innerHTML()`, `count()`, `allTextContents()`

**Waits**: `waitForVisible()`, `waitForHidden()`, `waitForEnabled()`, `waitForDisabled()`, `waitForStable()`

---

## 6. BDD Style

**Step Definitions**: Use `@StepDefinitions` class decorator, `@CSBDDStepDef('pattern')` method decorator, `@Page('name')` for page injection.

**Parameters**: `{string}`, `{int}`, `{float}`

**Hooks**: `@CSBefore({ tags })`, `@CSAfter({ tags })`, `@CSBeforeStep()`, `@CSAfterStep()`

**Context**: `CSScenarioContext.getInstance()` for `setVariable()`/`getVariable()`

**See**: `code-examples.md` Section 2-3 for complete examples.

---

## 7. BDD Feature Files

```gherkin
@regression @feature-name
Feature: Feature Title

  Background:
    Given I navigate to the application

  @smoke
  Scenario: Test case name
    When I do something
    Then I verify result

  @data-driven
  Scenario Outline: Data-driven test
    When I use "<param1>" and "<param2>"
    Then I verify "<expected>"

    Examples: {"type": "json", "source": "test/<project>/data/file.json", "path": "$", "filter": "runFlag=Yes"}
```

**CRITICAL**: When using `Examples:` with JSON/CSV/database data source, MUST use `Scenario Outline:` — NOT `Scenario:`. Parameters use `<paramName>` syntax.

**Tags**: `@smoke`, `@regression`, `@wip`, `@TestPlanId:123`, `@TestSuiteId:456`, `@TestCaseId:789`

---

## 8. Spec Style

**Key Points:**
- Import from `@.../spec`: `describe`, `test`, `beforeAll`, `afterAll`, `beforeEach`, `afterEach`
- Auto-injected fixtures: page objects, `config`, `ctx`, `data`, `reporter`, `assert`, `expect`, `navigate`, `browserManager`, `db`, `api`
- Use `test.step('name', async () => {})` for structured reporting
- Execution modes: `describe.serial()`, `describe.parallel()`, `describe.workflow()`
- Dependencies: `{ dependsOn: '@TC001' }` or `{ dependsOn: ['@TC001', '@TC002'] }`
- Test variants: `test.skip()`, `test.only()`, `test.fixme()`, `test.fail()`, `test.slow()`

**Data Sources**: `dataSource: { type: 'inline'|'json'|'csv'|'database'|'api', ... }`

**See**: `code-examples.md` Sections 4-6 for complete examples.

---

## 9. Browser Management

```typescript
// Get instance
const browserManager = CSBrowserManager.getInstance();

// Navigation (ALWAYS use this instead of page.goto)
await browserManager.navigateAndWaitReady(url);
await browserManager.navigateAndWaitReady(url, {
    waitForSpinner: true,
    spinnerSelector: '.loading',
    timeout: 30000
});

// Get current page
const page = browserManager.getPage();
const pages = browserManager.getPages();
const pageCount = browserManager.getPageCount();

// Multi-page/tab handling
await browserManager.switchToPage(index);      // Switch to page by index
await browserManager.switchToLatestPage();     // Switch to most recently opened page
await browserManager.switchToMainPage();       // Switch back to first/main page
const currentIndex = browserManager.getCurrentPageIndex();

// Browser lifecycle
await browserManager.launch('chromium');       // Launch browser (chromium/firefox/webkit)
await browserManager.restartBrowser();         // Restart browser
await browserManager.closePage();              // Close current page
await browserManager.closeContext();           // Close browser context
await browserManager.closeBrowser();           // Close browser
await browserManager.close();                  // Close everything

// Multi-browser support
await browserManager.switchBrowser('firefox'); // Switch to different browser
const browserType = browserManager.getCurrentBrowserType();

// Context management
const context = browserManager.getContext();
await browserManager.clearContextAndReauthenticate();

// Wait for spinners/loading
await browserManager.waitForSpinnersToDisappear(timeout);
```

**NEVER use**: `page.goto()` — Always use `browserManager.navigateAndWaitReady()`
**NEVER use**: `page.waitForSelector()` for spinners — Use `waitForSpinnersToDisappear()`

---

## 10. Assertions

**CSAssert** (getInstance required, methods are async):
```typescript
const assert = CSAssert.getInstance();
await assert.assertTrue(condition, message);
await assert.assertEqual(actual, expected, message);
await assert.assertContains(text, substring, message);
```

**CSExpect** (Playwright-style):
```typescript
import { expect } from '@.../assertions';
await expect(element).toBeVisible();
await expect(element).toHaveText('text');
```

---

## 11. Database Operations

**Config** (`environments/dev.env`): `DB_<ALIAS>_TYPE`, `DB_<ALIAS>_HOST`, `DB_<ALIAS>_PORT`, `DB_<ALIAS>_DATABASE`, `DB_<ALIAS>_USERNAME`, `DB_<ALIAS>_PASSWORD`

**Named Queries** (`common/<project>-db-queries.env`): `DB_QUERY_<NAME>=SELECT ... WHERE col = ?`

**CSDBUtils Methods**:
- `executeQuery()`, `executeNamedQuery()`, `executeSingleValue<T>()`, `executeSingleRow()`, `executeSingleRowOrNull()`
- `exists()`, `count()`, `extractColumn<T>()`, `getMap<K,V>()`
- `executeUpdate()`, `executeInsertAndGetId()`, `executeTransaction()`
- `closeConnection()`, `closeAllConnections()`

**See**: `code-examples.md` Section 9 for complete examples.

---

## 12. API Testing

**CSAPIClient**: `get()`, `post()`, `put()`, `patch()`, `delete()`

**12 Auth Types**: `basic`, `bearer`, `apikey`, `oauth2`, `digest`, `jwt`, `aws`, `ntlm`, `hawk`, `certificate`, `ping`, `custom`

**SOAP**: Use `CSSoapClient`, not CSAPIClient. WS-Security types: `UsernameToken`, `BinarySecurityToken`, `SAMLAssertion`, `Timestamp`, `Signature`

**See**: `code-examples.md` Section 10 for complete examples.

---

## 13. Utility Classes (310+ Methods)

**CRITICAL: Before using ANY utility class, you MUST:**
1. **Read the framework source** — Check actual method signatures in the utility class
2. **Use EXACT method names** — Do NOT guess or make up method names
3. **Match parameters** — Use correct parameter types and order
4. **DO NOT create wrappers** — If framework has the method, use it directly

**WRONG vs CORRECT Examples:**

| WRONG (Made Up) | CORRECT (Actual Framework Method) |
|-----------------|-----------------------------------|
| `CSDateTimeUtility.formatDate(date, 'yyyy-MM-dd')` | `CSDateTimeUtility.format(date, 'YYYY-MM-DD')` |
| `CSDateTimeUtility.getCurrentDate()` | `CSDateTimeUtility.now()` |
| `CSStringUtility.isNullOrEmpty(str)` | `CSStringUtility.isEmpty(str)` |
| `CSArrayUtility.removeDuplicates(arr)` | `CSArrayUtility.unique(arr)` |

**Before converting date/string/array operations:**
1. Check what method exists in the utility class
2. Check the method signature (parameters, return type)
3. Use the EXACT method name — do not invent similar names

| Class | Methods |
|-------|---------|
| **CSStringUtility** | `isEmpty`, `isBlank`, `toCamelCase`, `toSnakeCase`, `capitalize`, `trim`, `pad`, `split`, `join`, `contains`, `base64Encode/Decode` |
| **CSDateTimeUtility** | `parse`, `format`, `addDays/Months/Years`, `diffInDays`, `isBefore`, `isAfter`, `startOfDay`, `addBusinessDays`, `isWeekend`, `now`, `today` |
| **CSArrayUtility** | `unique`, `chunk`, `flatten`, `groupBy`, `intersection`, `union`, `difference`, `sortBy`, `sum`, `average`, `min`, `max` |
| **CSMapUtility** | `fromObject`, `toObject`, `filter`, `merge`, `deepMerge`, `pick`, `omit`, `keys`, `values` |
| **CSCsvUtility** | `read`, `write`, `parse`, `filter`, `sort`, `merge`, `toJSON`, `toExcel` |
| **CSExcelUtility** | `read`, `write`, `readSheet`, `getSheetNames`, `toCSV`, `toJSON` (Heavy - direct import) |

**If unsure about a method, search the framework code first. DO NOT guess.**

---

## 14. QAF Excel to JSON Conversion

**CRITICAL: DO NOT MISS ANY COLUMN DATA. Every single column from Excel MUST appear in JSON.**

**QAF Format** (TD_Key markers wrap EACH data set — multiple data sets in one Excel):
```
| TD_Key  | col1  | col2  | col3  | col4  | col5   |         |
|         | data1 | data2 | data3 | data4 | data5  |         |
|         | data6 | data7 | data8 | data9 | data10 | TD_Key  |

| TD_Key2 | col1   | col2   | col3   | col4   | col5   |         |
|         | data11 | data12 | data13 | data14 | data15 |         |
|         | data16 | data17 | data18 | data19 | data20 | TD_Key2 |
```

**Convert to JSON** (EACH TD_Key block becomes separate JSON or nested structure):

**Option 1: Separate JSON files per TD_Key**
- `feature-data-TD_Key.json`:
```json
[
  { "col1": "data1", "col2": "data2", "col3": "data3", "col4": "data4", "col5": "data5", "runFlag": "Yes" },
  { "col1": "data6", "col2": "data7", "col3": "data8", "col4": "data9", "col5": "data10", "runFlag": "Yes" }
]
```
- `feature-data-TD_Key2.json`:
```json
[
  { "col1": "data11", "col2": "data12", "col3": "data13", "col4": "data14", "col5": "data15", "runFlag": "Yes" },
  { "col1": "data16", "col2": "data17", "col3": "data18", "col4": "data19", "col5": "data20", "runFlag": "Yes" }
]
```

**Option 2: Single JSON with nested structure (use with path parameter)**
```json
{
  "TD_Key": [
    { "col1": "data1", "col2": "data2", "col3": "data3", "col4": "data4", "col5": "data5", "runFlag": "Yes" },
    { "col1": "data6", "col2": "data7", "col3": "data8", "col4": "data9", "col5": "data10", "runFlag": "Yes" }
  ],
  "TD_Key2": [
    { "col1": "data11", "col2": "data12", "col3": "data13", "col4": "data14", "col5": "data15", "runFlag": "Yes" },
    { "col1": "data16", "col2": "data17", "col3": "data18", "col4": "data19", "col5": "data20", "runFlag": "Yes" }
  ]
}
```
Usage: `Examples: {"type": "json", "source": "data/file.json", "path": "$.TD_Key", "filter": "runFlag=Yes"}`

**Each TD_Key block = separate data set. Count rows per block. NO rows should be missing.**

**MANDATORY Conversion Rules:**
1. **Count columns FIRST** — Count ALL columns between TD_Key markers in Excel header row
2. **ALL columns to JSON** — Every single column header becomes a JSON key. NO exceptions
3. **Preserve column order** — Maintain same order as Excel for readability
4. **Empty cells = empty string** — If cell is empty, use `""` not skip the key
5. **Headers → camelCase** — Convert header names to camelCase (e.g., "User Name" → "userName")
6. **Add runFlag** — Add `"runFlag": "Yes"` to each object
7. **Boolean values** — Convert "true"/"false"/"yes"/"no" strings to JSON booleans

**MANDATORY Post-Conversion Audit:**
After generating EACH JSON file, perform this audit:

| Check | Action |
|-------|--------|
| Column count match | Excel columns (excluding TD_Key) = JSON keys count |
| All headers present | Every Excel header appears as JSON key |
| Row count match | Excel data rows = JSON array length |
| No data loss | Spot-check 3 random rows for all values |
| Empty cells handled | Empty Excel cells = `""` in JSON |

**If audit fails, regenerate the JSON file. DO NOT proceed with missing data.**

**See**: `code-examples.md` Section 12 for complete examples.

---

## 15. Java Utility Class Migration

**CommonFunctions / Custom Utility Classes:**
- DO NOT migrate entire utility classes blindly unless user explicitly specifies
- Analyze which methods are actually USED in the Java files being converted
- ONLY migrate the required methods that are used
- Place migrated methods in a project helper class: `test/<project>/helpers/<Project>Helper.ts`
- Before migrating ANY method, check if framework already has equivalent — use framework method instead

**Java Date Utility Classes → CSDateTimeUtility:**
- DO NOT migrate custom date utility classes
- Map ALL Java date methods to `CSDateTimeUtility` framework methods:

| Java Date Method Pattern | CS Framework Equivalent |
|--------------------------|------------------------|
| `getCurrentDate()`, `getToday()` | `CSDateTimeUtility.now()` or `CSDateTimeUtility.today()` |
| `formatDate(date, format)` | `CSDateTimeUtility.format(date, format)` |
| `addDays(date, n)` | `CSDateTimeUtility.addDays(date, n)` |
| `addMonths(date, n)` | `CSDateTimeUtility.addMonths(date, n)` |
| `getDateDifference()`, `daysBetween()` | `CSDateTimeUtility.diffInDays()` |
| `parseDate(str, format)` | `CSDateTimeUtility.parse(str, format)` |
| `isWeekend(date)` | `CSDateTimeUtility.isWeekend(date)` |
| `addBusinessDays(date, n)` | `CSDateTimeUtility.addBusinessDays(date, n)` |

**Java String Utility Classes → CSStringUtility:**
- Map Java string utility methods to `CSStringUtility` framework methods
- Do NOT create custom string helpers if framework has the method

**RULE: If framework has equivalent method, USE IT. Do NOT migrate custom utilities.**

---

## 16. Selenium → CS Playwright Mapping

| Selenium/Java | CS Playwright TypeScript |
|---------------|--------------------------|
| `@FindBy(xpath="...")` | `@CSGetElement({ xpath: "..." })` |
| `WebElement` | `CSWebElement` |
| `element.sendKeys(text)` | `await element.fill(text)` |
| `element.getText()` | `await element.textContent()` |
| `element.isDisplayed()` | `await element.isVisible()` |
| `Select(el).selectByVisibleText(t)` | `await element.selectOption({ label: t })` |
| `driver.get(url)` | `await browserManager.navigateAndWaitReady(url)` |
| `@QAFTestStep("...")` | `@CSBDDStepDef('...')` |
| `Reporter.log(msg)` | `CSReporter.info(msg)` |
| `Assert.assertTrue(c, m)` | `await assert.assertTrue(c, m)` |
| `'${varName}'` in feature file | `"<varName>"` — DOUBLE quotes, angle brackets |

**CRITICAL - Feature File Parameters:**
- Selenium/Java: `Given user logs in with '${UserName}'` (single quotes, `${}` syntax)
- CS Playwright: `Given user logs in with "<UserName>"` (DOUBLE quotes, `<>` syntax)
- ALWAYS convert single quotes to DOUBLE quotes for parameters in feature files

---

## 17. Common Mistakes to AVOID

| WRONG | CORRECT |
|-------|---------|
| Single barrel import `from '@.../cs-playwright-test-framework'` | Module-specific imports |
| `from '.../context'` | Use `/bdd` for CSScenarioContext |
| `from '.../assert'` | Use `/assertions` |
| `from '.../utils'` | Use `/utilities` |
| `CSReporter.getInstance().info()` | `CSReporter.info()` — static |
| `CSAssert.assertTrue()` (static) | `CSAssert.getInstance().assertTrue()` |
| `private config: ...` in page | NEVER redeclare — inherited as `protected` |
| Missing `initializeElements()` | MUST implement in every page |
| Creating `index.ts` files | NEVER create |
| `config/<project>/dev/dev.env` | `config/<project>/environments/dev.env` |
| `page.goto(url)` | `browserManager.navigateAndWaitReady(url)` |
| Hardcoded SQL | Put in `<project>-db-queries.env` |
| Locators in steps/specs | ALL locators in page classes |
| `api.setSOAPSecurity()` | Use `CSSoapClient` |
| `'<param>'` single quotes in feature | `"<param>"` DOUBLE quotes for parameters |
| `'${varName}'` Java syntax | `"<varName>"` angle brackets with double quotes |
| `CSDBUtils from .../database` | Use `.../database-utils` — avoids MongoDB/Redis deps |

---

## 18. Correct Imports (Optimized for Fast Step Loading)

**CRITICAL: Incorrect imports cause slow step loading. Follow these patterns exactly.**

**Import Order (MUST follow):**
1. Framework imports (grouped by module)
2. External libraries (if needed)
3. Local page imports
4. Local helper imports

### Step Definition File Imports (Recommended Pattern):
```typescript
// BDD decorators and context - group related items
import { CSBDDStepDef, Page, StepDefinitions } from '@mdakhan.mak/cs-playwright-test-framework/bdd';
import { CSBDDContext, CSScenarioContext } from '@mdakhan.mak/cs-playwright-test-framework/bdd';

// Reporter (STATIC methods)
import { CSReporter } from '@mdakhan.mak/cs-playwright-test-framework/reporter';

// Utilities (only import what you need)
import { CSValueResolver } from '@mdakhan.mak/cs-playwright-test-framework/utilities';

// Local pages
import { LoginPage } from '../pages/LoginPage';
import { DashboardPage } from '../pages/DashboardPage';

// Local helpers
import { MyProjectDatabaseHelper } from '../helpers/MyProjectDatabaseHelper';
```

### Page Class Imports:
```typescript
// Core - page decorators and base class
import { CSBasePage, CSPage, CSGetElement } from '@mdakhan.mak/cs-playwright-test-framework/core';

// Element types
import { CSWebElement, CSElementFactory } from '@mdakhan.mak/cs-playwright-test-framework/element';

// Reporter
import { CSReporter } from '@mdakhan.mak/cs-playwright-test-framework/reporter';
```

### Database Helper Imports:
```typescript
// Use lightweight path - avoids MongoDB/Redis dependencies
import { CSDBUtils } from '@mdakhan.mak/cs-playwright-test-framework/database-utils';

// Config for named queries
import { CSConfigurationManager } from '@mdakhan.mak/cs-playwright-test-framework/core';
```

### WRONG Import Patterns (Cause Slow Loading):
```typescript
// WRONG - Importing everything from one barrel
import { CSBasePage, CSReporter, CSDBUtils, CSBDDStepDef } from '@mdakhan.mak/cs-playwright-test-framework';

// WRONG - Full database path for just CSDBUtils
import { CSDBUtils } from '@mdakhan.mak/cs-playwright-test-framework/database';

// WRONG - Scattered imports from same module
import { CSBDDStepDef } from '@mdakhan.mak/cs-playwright-test-framework/bdd';
import { StepDefinitions } from '@mdakhan.mak/cs-playwright-test-framework/bdd';
import { Page } from '@mdakhan.mak/cs-playwright-test-framework/bdd';
```

### Module Reference:
| Module Path | Exports |
|-------------|---------|
| `/bdd` | `StepDefinitions`, `CSBDDStepDef`, `Page`, `CSBefore`, `CSAfter`, `CSScenarioContext`, `CSBDDContext` |
| `/core` | `CSBasePage`, `CSPage`, `CSGetElement`, `CSConfigurationManager` |
| `/element` | `CSWebElement`, `CSElementFactory` |
| `/reporter` | `CSReporter` (STATIC) |
| `/browser` | `CSBrowserManager` |
| `/assertions` | `CSAssert`, `expect` |
| `/database-utils` | `CSDBUtils` (lightweight) |
| `/utilities` | `CSValueResolver`, `CSStringUtility`, `CSDateTimeUtility`, `CSCsvUtility` |
| `/api` | `CSAPIClient`, `CSSoapClient` |
| `/spec` | `describe`, `test`, `beforeEach`, `afterEach`, `beforeAll`, `afterAll` |

**Heavy Utilities (use require to avoid loading at startup):**
```typescript
// Only when needed - avoids loading at step file import
const { CSExcelUtility } = require('@mdakhan.mak/cs-playwright-test-framework/dist/utils/CSExcelUtility');
```

---

## 19. CLI Commands

```bash
# BDD
npx cs-playwright-test --project=<project> --features=test/<project>/features/*.feature --tags="@smoke"

# Spec
npx cs-playwright-test --project=<project> --specs=test/<project>/specs/**/*.spec.ts
npx cs-playwright-test --project=<project> --specs=... --test="test name"
npx cs-playwright-test --project=<project> --specs=... --grep="pattern"

# Options
--env=sit|uat|prod --browser=chromium|firefox|webkit --headed|--headless
--parallel --workers=4 --retries=2 --timeout=60000 --debug --lazy-steps

# Generate fixtures
npx cs-playwright-test generate-fixtures --project=<project>
```
--------------------------------------------------------------------------------------------


# CS Playwright Framework — Code Examples

> **Referenced by**: `.github/copilot-instructions.md`
> This file contains detailed code examples for the CS Playwright TypeScript Framework.

---

## 1. Page Object Pattern — Complete Example

```typescript
// CORRECT IMPORTS - Module-specific
import { CSBasePage, CSPage, CSGetElement } from '@mdakhan.mak/cs-playwright-test-framework/core';
import { CSWebElement, CSElementFactory } from '@mdakhan.mak/cs-playwright-test-framework/element';
import { CSReporter } from '@mdakhan.mak/cs-playwright-test-framework/reporter';

@CSPage('app-login')
export class AppLoginPage extends CSBasePage {
    // INHERITED from CSBasePage (DO NOT redeclare):
    // protected config: CSConfigurationManager
    // protected browserManager: CSBrowserManager
    // protected page: Page
    // protected url: string
    // protected elements: Map<string, CSWebElement>

    @CSGetElement({
        xpath: '//input[@name="username" or @id="username"]',
        description: 'Username input field',
        waitForVisible: true,
        alternativeLocators: ['css:input[name="username"]', 'css:input#username']
    })
    public usernameField!: CSWebElement;

    @CSGetElement({
        xpath: '//input[@name="password" or @id="password"]',
        description: 'Password input field',
        waitForVisible: true
    })
    public passwordField!: CSWebElement;

    @CSGetElement({
        xpath: '//button[text()="Log In"]',
        description: 'Log In button',
        waitForVisible: true,
        waitForEnabled: true
    })
    public loginButton!: CSWebElement;

    @CSGetElement({
        xpath: '//span[contains(@class,"error")]',
        description: 'Error message'
    })
    public errorMessage!: CSWebElement;

    // REQUIRED - Must implement this abstract method
    protected initializeElements(): void {
        CSReporter.debug('AppLoginPage elements initialized');
    }

    // Action methods
    public async enterUsername(username: string): Promise<void> {
        await this.usernameField.waitForVisible(10000);
        await this.usernameField.clearWithTimeout(5000);
        await this.usernameField.fillWithTimeout(username, 5000);
        CSReporter.info(`Username entered: ${username}`);
    }

    public async enterPassword(password: string): Promise<void> {
        await this.passwordField.fill(password);
        CSReporter.info('Password entered');
    }

    public async clickLogin(): Promise<void> {
        await this.loginButton.click();
        CSReporter.info('Login button clicked');
    }

    public async login(username: string, password: string): Promise<void> {
        await this.enterUsername(username);
        await this.enterPassword(password);
        await this.clickLogin();
    }

    // Dynamic element methods
    public getMenuItemByName(name: string): CSWebElement {
        return CSElementFactory.createByXPath(`//a[text()='${name}']`, `Menu item: ${name}`);
    }

    public getTableCellByRowCol(row: number, col: number): CSWebElement {
        return CSElementFactory.createByXPath(`//table//tr[${row}]/td[${col}]`, `Cell [${row},${col}]`);
    }

    public getButtonByText(text: string): CSWebElement {
        return CSElementFactory.createByText(text, `Button: ${text}`);
    }
}
```

---

## 2. BDD Step Definitions — Complete Example

```typescript
import { StepDefinitions, CSBDDStepDef, Page, CSBefore, CSAfter, CSBeforeStep, CSAfterStep, CSBDDContext, CSScenarioContext } from '@mdakhan.mak/cs-playwright-test-framework/bdd';
import { CSReporter } from '@mdakhan.mak/cs-playwright-test-framework/reporter';
import { CSBrowserManager } from '@mdakhan.mak/cs-playwright-test-framework/browser';
import { CSAssert } from '@mdakhan.mak/cs-playwright-test-framework/assertions';
import { CSConfigurationManager } from '@mdakhan.mak/cs-playwright-test-framework/core';
import { AppLoginPage } from '../pages/AppLoginPage';
import { AppHomePage } from '../pages/AppHomePage';

@StepDefinitions
export class LoginSteps {

    @Page('app-login')
    private loginPage!: AppLoginPage;

    @Page('app-home')
    private homePage!: AppHomePage;

    private ctx = CSBDDContext.getInstance();
    private scenarioCtx = CSScenarioContext.getInstance();
    private browserManager = CSBrowserManager.getInstance();
    private config = CSConfigurationManager.getInstance();

    // Hooks
    @CSBefore({ tags: '@login' })
    async beforeLogin(): Promise<void> {
        CSReporter.info('Setting up login test');
    }

    @CSAfter({ tags: '@cleanup' })
    async afterCleanup(): Promise<void> {
        CSReporter.info('Cleaning up test data');
    }

    @CSBeforeStep()
    async beforeEachStep(): Promise<void> {
        CSReporter.debug('Step starting');
    }

    @CSAfterStep()
    async afterEachStep(): Promise<void> {
        CSReporter.debug('Step completed');
    }

    // Step Definitions
    @CSBDDStepDef('I navigate to the application')
    async navigateToApp(): Promise<void> {
        const baseUrl = this.config.get('BASE_URL');
        await this.browserManager.navigateAndWaitReady(baseUrl);
        CSReporter.info(`Navigated to: ${baseUrl}`);
    }

    @CSBDDStepDef('I login with username {string} and password {string}')
    async login(username: string, password: string): Promise<void> {
        await this.loginPage.login(username, password);
        this.scenarioCtx.setVariable('currentUser', username);
        CSReporter.pass(`Logged in as: ${username}`);
    }

    @CSBDDStepDef('I enter {string} in the {string} field')
    async enterValue(value: string, fieldName: string): Promise<void> {
        CSReporter.info(`Entering ${value} in ${fieldName}`);
    }

    @CSBDDStepDef('I should see the home page')
    async verifyHomePage(): Promise<void> {
        await this.homePage.verifyPageLoaded();
        CSReporter.pass('Home page displayed');
    }

    @CSBDDStepDef('I should see {string} message')
    async verifyMessage(expectedMessage: string): Promise<void> {
        CSReporter.pass(`Message verified: ${expectedMessage}`);
    }

    @CSBDDStepDef('I verify {int} records are displayed')
    async verifyRecordCount(count: number): Promise<void> {
        const assert = CSAssert.getInstance();
        await assert.assertTrue(true, `Expected ${count} records`);
    }

    @CSBDDStepDef('I wait for {float} seconds')
    async waitSeconds(seconds: number): Promise<void> {
        await new Promise(resolve => setTimeout(resolve, seconds * 1000));
    }

    @CSBDDStepDef('I store the value {string} as {string}')
    async storeValue(value: string, variableName: string): Promise<void> {
        this.scenarioCtx.setVariable(variableName, value);
        CSReporter.info(`Stored ${variableName} = ${value}`);
    }

    @CSBDDStepDef('I use the stored {string} value')
    async useStoredValue(variableName: string): Promise<void> {
        const value = this.scenarioCtx.getVariable(variableName);
        CSReporter.info(`Using stored value: ${value}`);
    }
}
```

---

## 3. BDD Feature File — Complete Example

```gherkin
@regression @login
Feature: User Authentication

  Background:
    Given I navigate to the application

  @smoke @TC001
  Scenario: Successful login with valid credentials
    When I login with username "testuser" and password "Test@123"
    Then I should see the home page
    And I should see "Welcome" message

  @negative
  Scenario: Failed login with invalid password
    When I login with username "testuser" and password "wrongpass"
    Then I should see "Invalid credentials" message

  @data-driven
  Scenario Outline: Login with multiple users
    When I login with username "<username>" and password "<password>"
    Then I should see the home page
    And I verify <recordCount> records are displayed

    Examples: {"type": "json", "source": "test/<project>/data/login-data.json", "path": "$", "filter": "runFlag=Yes"}
```

---

## 4. Spec Style — Complete Example

```typescript
import { describe, test, beforeEach, afterEach, beforeAll, afterAll } from '@mdakhan.mak/cs-playwright-test-framework/spec';
import { AppLoginPage } from '../pages/AppLoginPage';
import { AppHomePage } from '../pages/AppHomePage';

describe('User Authentication', { tags: ['@regression', '@login'] }, () => {

    beforeAll(async ({ browserManager, reporter }) => {
        reporter.info('Suite setup - launching browser');
    });

    afterAll(async ({ reporter }) => {
        reporter.info('Suite teardown');
    });

    beforeEach(async ({ navigate, config }) => {
        await navigate(config.get('BASE_URL'));
    });

    afterEach(async ({ reporter }) => {
        reporter.info('Test cleanup');
    });

    test('TC001: should login successfully', { tags: ['@smoke'] }, async ({
        AppLoginPage,
        AppHomePage,
        reporter,
        assert,
        ctx
    }) => {
        await test.step('Enter username', async () => {
            await AppLoginPage.enterUsername('testuser');
        });

        await test.step('Enter password', async () => {
            await AppLoginPage.enterPassword('Test@123');
        });

        await test.step('Click login button', async () => {
            await AppLoginPage.clickLogin();
        });

        await test.step('Verify home page', async () => {
            const isVisible = await AppHomePage.welcomeMessage.isVisible();
            await assert.assertTrue(isVisible, 'Home page should be displayed');
            reporter.pass('Login successful');
        });

        ctx.setVariable('loggedInUser', 'testuser');
    });

    test('TC002: should show error for invalid credentials', { tags: ['@negative'] }, async ({
        AppLoginPage,
        assert
    }) => {
        await AppLoginPage.login('invalid', 'wrongpass');
        const errorVisible = await AppLoginPage.errorMessage.isVisible();
        await assert.assertTrue(errorVisible, 'Error message should be displayed');
    });
});
```

---

## 5. Spec Style — Data-Driven Examples

### Inline Data
```typescript
describe('Login Tests', {
    dataSource: {
        type: 'inline',
        data: [
            { username: 'admin', password: 'Admin@123', expected: 'success' },
            { username: 'user1', password: 'User1@123', expected: 'success' },
            { username: 'invalid', password: 'wrong', expected: 'failure' }
        ]
    }
}, () => {
    test('Login with {username}', async ({ data, AppLoginPage, assert }) => {
        await AppLoginPage.login(data.username, data.password);
        if (data.expected === 'success') {
            await assert.assertTrue(true, 'Login should succeed');
        } else {
            await assert.assertTrue(await AppLoginPage.errorMessage.isVisible(), 'Error should show');
        }
    });
});
```

### JSON File Data
```typescript
describe('User Search', {
    dataSource: {
        type: 'json',
        source: 'test/<project>/data/search-data.json',
        path: '$[?(@.runFlag=="Yes")]'
    }
}, () => {
    test('Search for {searchTerm}', async ({ data, SearchPage }) => {
        await SearchPage.search(data.searchTerm);
    });
});
```

### CSV Data
```typescript
describe('Product Tests', {
    dataSource: {
        type: 'csv',
        source: 'test/<project>/data/products.csv',
        delimiter: ','
    }
}, () => {
    test('Verify product {productName}', async ({ data }) => {
        // data.productName, data.price, etc.
    });
});
```

### Database Data
```typescript
describe('DB-Driven Tests', {
    dataSource: {
        type: 'database',
        alias: 'MYDB',
        query: 'DB_QUERY_GET_TEST_DATA'
    }
}, () => {
    test('Process record {id}', async ({ data }) => {
        // data contains DB row
    });
});
```

---

## 6. Spec Style — Workflows & Dependencies

### Sequential Execution
```typescript
describe.serial('Sequential Tests', () => {
    test('Step 1: Create record', async () => { /* ... */ });
    test('Step 2: Update record', async () => { /* ... */ });
    test('Step 3: Delete record', async () => { /* ... */ });
});
```

### Workflow with Auto-Dependencies
```typescript
describe.workflow('User CRUD Workflow', () => {
    test('TC001: Create user', async ({ ctx }) => {
        const userId = 'U123';
        ctx.setVariable('createdUserId', userId);
    });

    test('TC002: Read user', async ({ ctx }) => {
        const userId = ctx.getVariable('createdUserId');
    });

    test('TC003: Update user', async ({ ctx }) => {
        // Automatically depends on TC002
    });

    test('TC004: Delete user', async () => {
        // Automatically depends on TC003
    });

    test.cleanup('Cleanup: Remove test data', async () => {
        // Always runs, even if tests fail
    });
});
```

### Explicit Dependencies
```typescript
describe('Tests with Dependencies', () => {
    test('TC001: Setup', { tags: ['@TC001'] }, async ({ ctx }) => {
        ctx.setVariable('setupData', 'value');
    });

    test('TC002: Depends on setup', { dependsOn: '@TC001' }, async ({ ctx }) => {
        const data = ctx.getVariable('setupData');
    });

    test('TC003: Depends on multiple', { dependsOn: ['@TC001', '@TC002'] }, async () => {
        // Runs after both TC001 and TC002
    });
});
```

---

## 7. Browser Management Examples

```typescript
import { CSBrowserManager } from '@mdakhan.mak/cs-playwright-test-framework/browser';

const browser = CSBrowserManager.getInstance();

// Navigation - ALWAYS use this, never page.goto()
await browser.navigateAndWaitReady('https://example.com', {
    waitForSpinner: true,
    spinnerSelector: '.loading',
    timeout: 30000
});

// Multi-browser
await browser.launchBrowser('firefox');
await browser.switchToBrowser('firefox');
await browser.closeBrowser('firefox');

// Multi-tab
await browser.openNewTab();
await browser.switchToTab(1);
await browser.closeTab(1);
const tabCount = browser.getTabCount();

// Get current page/context
const page = browser.getCurrentPage();
const context = browser.getContext();

// Context reset (clears cookies, storage)
await browser.clearContextAndReauthenticate();

// Screenshot
await browser.takeScreenshot('screenshot-name');
```

---

## 8. Assertions Examples

### CSAssert (getInstance required)
```typescript
import { CSAssert } from '@mdakhan.mak/cs-playwright-test-framework/assertions';

const assert = CSAssert.getInstance();

await assert.assertTrue(condition, 'Condition should be true');
await assert.assertFalse(condition, 'Condition should be false');
await assert.assertEqual(actual, expected, 'Values should match');
await assert.assertNotEqual(actual, expected, 'Values should differ');
await assert.assertContains(text, substring, 'Text should contain substring');
await assert.assertNotContains(text, substring, 'Text should not contain');
await assert.assertNull(value, 'Value should be null');
await assert.assertNotNull(value, 'Value should not be null');
await assert.assertGreaterThan(actual, expected, 'Should be greater');
await assert.assertLessThan(actual, expected, 'Should be less');
```

### CSExpect (Playwright-style)
```typescript
import { expect } from '@mdakhan.mak/cs-playwright-test-framework/assertions';

await expect(element).toBeVisible();
await expect(element).toBeHidden();
await expect(element).toBeEnabled();
await expect(element).toBeDisabled();
await expect(element).toHaveText('expected text');
await expect(element).toContainText('partial');
await expect(element).toHaveAttribute('href', '/home');
await expect(element).toHaveValue('input value');
await expect(element).toHaveCount(5);
await expect(element).toBeChecked();
```

---

## 9. Database Operations Examples

### Connection Config (config/<project>/environments/dev.env)
```env
DB_MYDB_TYPE=mssql
DB_MYDB_HOST=dbserver.example.com
DB_MYDB_PORT=1433
DB_MYDB_DATABASE=MyDatabase
DB_MYDB_USERNAME=dbuser
DB_MYDB_PASSWORD={encrypted:xxxxx}
DB_MYDB_TRUSTED_CONNECTION=false
DB_MYDB_POOL_MAX=10
DB_MYDB_POOL_MIN=2
```

### Named Queries (config/<project>/common/<project>-db-queries.env)
```env
DB_QUERY_GET_USER_BY_ID=SELECT * FROM users WHERE user_id = ?
DB_QUERY_GET_USER_BY_NAME=SELECT * FROM users WHERE user_name LIKE '%' + ? + '%'
DB_QUERY_COUNT_ACTIVE=SELECT COUNT(*) as cnt FROM users WHERE status = 'active'
DB_QUERY_INSERT_USER=INSERT INTO users (name, email) VALUES (?, ?)
DB_QUERY_UPDATE_STATUS=UPDATE users SET status = ? WHERE user_id = ?
DB_QUERY_DELETE_USER=DELETE FROM users WHERE user_id = ?
```

### CSDBUtils Usage
```typescript
import { CSDBUtils } from '@mdakhan.mak/cs-playwright-test-framework/database-utils';

// Query execution
const result = await CSDBUtils.executeQuery('MYDB', 'SELECT * FROM users');
const result = await CSDBUtils.executeNamedQuery('MYDB', 'GET_USER_BY_ID', ['U123']);

// Single value/row
const count = await CSDBUtils.executeSingleValue<number>('MYDB', 'DB_QUERY_COUNT_ACTIVE');
const user = await CSDBUtils.executeSingleRow('MYDB', 'DB_QUERY_GET_USER_BY_ID', ['U123']);
const userOrNull = await CSDBUtils.executeSingleRowOrNull('MYDB', sql, params);

// Existence/count
const exists = await CSDBUtils.exists('MYDB', 'SELECT 1 FROM users WHERE id = ?', [123]);
const count = await CSDBUtils.count('MYDB', 'SELECT COUNT(*) FROM users');

// Column extraction
const names = await CSDBUtils.extractColumn<string>('MYDB', sql, 'user_name');
const ids = await CSDBUtils.getColumnList<number>('MYDB', sql, params, 'id');

// Map building
const idToName = await CSDBUtils.getMap<number, string>('MYDB', sql, 'id', 'name');

// Modification
const affected = await CSDBUtils.executeUpdate('MYDB', 'DB_QUERY_UPDATE_STATUS', ['active', 'U123']);
const newId = await CSDBUtils.executeInsertAndGetId('MYDB', 'DB_QUERY_INSERT_USER', ['John', 'john@example.com']);

// Transactions
await CSDBUtils.executeTransaction('MYDB', [
    { sql: 'INSERT INTO ...', params: [...] },
    { sql: 'UPDATE ...', params: [...] }
]);

// Stored procedures
const result = await CSDBUtils.executeStoredProcedure('MYDB', 'sp_GetUserDetails', [userId]);

// Connection management
await CSDBUtils.closeConnection('MYDB');
await CSDBUtils.closeAllConnections();
```

### Database Helper Pattern
```typescript
// helpers/MyAppDatabaseHelper.ts
import { CSDBUtils } from '@mdakhan.mak/cs-playwright-test-framework/database-utils';

export class MyAppDatabaseHelper {
    private static readonly DB_ALIAS = 'MYDB';

    static async getUserByName(name: string): Promise<any> {
        return CSDBUtils.executeSingleRowOrNull(this.DB_ALIAS, 'DB_QUERY_GET_USER_BY_NAME', [name]);
    }

    static async getActiveUserCount(): Promise<number> {
        return CSDBUtils.executeSingleValue<number>(this.DB_ALIAS, 'DB_QUERY_COUNT_ACTIVE');
    }

    static async userExists(userId: string): Promise<boolean> {
        return CSDBUtils.exists(this.DB_ALIAS, 'SELECT 1 FROM users WHERE user_id = ?', [userId]);
    }

    static async createUser(name: string, email: string): Promise<number> {
        return CSDBUtils.executeInsertAndGetId(this.DB_ALIAS, 'DB_QUERY_INSERT_USER', [name, email]);
    }

    static async deleteUser(userId: string): Promise<number> {
        return CSDBUtils.executeUpdate(this.DB_ALIAS, 'DB_QUERY_DELETE_USER', [userId]);
    }
}
```

---

## 10. API Testing Examples

### Basic Usage
```typescript
import { CSAPIClient } from '@mdakhan.mak/cs-playwright-test-framework/api';

const api = CSAPIClient.getInstance();

// HTTP Methods
const response = await api.get('/api/users');
const response = await api.post('/api/users', { name: 'John', email: 'john@example.com' });
const response = await api.put('/api/users/123', { name: 'Updated' });
const response = await api.patch('/api/users/123', { status: 'active' });
const response = await api.delete('/api/users/123');
```

### Request Builder (Fluent API)
```typescript
const response = await api.builder('/api/users')
    .setMethod('POST')
    .setBody({ name: 'John' })
    .setHeader('Content-Type', 'application/json')
    .setHeader('X-Custom-Header', 'value')
    .setQueryParam('page', '1')
    .setTimeout(30000)
    .setBasicAuth('user', 'pass')
    .execute();
```

### 12 REST Authentication Types

```typescript
// 1. Basic Auth
api.setAuth({ type: 'basic', username: 'user', password: 'pass' });

// 2. Bearer Token
api.setAuth({ type: 'bearer', token: 'your-jwt-token' });

// 3. API Key
api.setAuth({ type: 'apikey', apiKey: 'key123', headerName: 'X-API-Key' });

// 4. OAuth2 (9 grant types)
api.setAuth({
    type: 'oauth2',
    tokenUrl: 'https://auth.example.com/token',
    clientId: 'client-id',
    clientSecret: 'client-secret',
    scope: 'read write',
    grantType: 'client_credentials'
});

// 5. Digest Auth
api.setAuth({ type: 'digest', username: 'user', password: 'pass' });

// 6. JWT
api.setAuth({
    type: 'jwt',
    secret: 'secret-key',
    algorithm: 'HS256',
    claims: { iss: 'myapp', sub: 'user123', aud: 'api' },
    expiresIn: '1h'
});

// 7. AWS Signature (V2/V4)
api.setAuth({
    type: 'aws',
    accessKeyId: 'AKIAXXXX',
    secretAccessKey: 'secret',
    region: 'us-east-1',
    service: 's3',
    version: 'v4'
});

// 8. NTLM (Windows)
api.setAuth({
    type: 'ntlm',
    username: 'user',
    password: 'pass',
    domain: 'DOMAIN',
    workstation: 'WORKSTATION'
});

// 9. Hawk
api.setAuth({
    type: 'hawk',
    id: 'hawk-id',
    key: 'hawk-key',
    algorithm: 'sha256'
});

// 10. Certificate (mTLS)
api.setAuth({
    type: 'certificate',
    certPath: '/path/to/cert.pem',
    keyPath: '/path/to/key.pem',
    passphrase: 'optional',
    ca: '/path/to/ca.pem'
});

// 11. Ping Identity
api.setAuth({
    type: 'ping',
    discoveryUrl: 'https://auth.pingone.com/.well-known/openid-configuration',
    clientId: 'client-id',
    clientSecret: 'client-secret'
});

// 12. Custom
api.setAuth({
    type: 'custom',
    handler: async (request) => {
        request.headers['X-Custom-Auth'] = await generateCustomToken();
        return request;
    }
});
```

### SOAP Web Services
```typescript
import { CSSoapClient } from '@mdakhan.mak/cs-playwright-test-framework/api';

const soapClient = new CSSoapClient({
    wsdlUrl: 'https://example.com/service?wsdl',
    endpoint: 'https://example.com/service'
});

// Basic SOAP request
const response = await soapClient.call('GetUser', { userId: '123' });

// With WS-Security UsernameToken
const response = await soapClient.sendWithWsSecurityAuth('GetUser', { userId: '123' }, {
    username: 'user',
    password: 'pass',
    passwordType: 'PasswordDigest'
});

// Security in request options
const response = await soapClient.call('GetUser', body, {
    security: {
        type: 'UsernameToken',
        username: 'user',
        password: 'pass',
        passwordType: 'PasswordDigest',
        timestamp: true
    }
});
```

---

## 11. Configuration Examples

### common.env
```env
BROWSER=chromium
HEADLESS=true
TIMEOUT=30000
SLOW_MO=0
SCREENSHOT_ON_FAILURE=true
VIDEO_ON_FAILURE=true
TRACE_ON_FAILURE=true
RETRY_COUNT=1
```

### environments/dev.env
```env
BASE_URL=https://myapp-dev.example.com
API_BASE_URL=https://api-dev.example.com

DB_MYDB_TYPE=mssql
DB_MYDB_HOST=db-dev.example.com
DB_MYDB_PORT=1433
DB_MYDB_DATABASE=MyApp_DEV
DB_MYDB_USERNAME=devuser
DB_MYDB_PASSWORD={encrypted:xxxx}
```

### Access Configuration
```typescript
import { CSConfigurationManager, CSValueResolver } from '@mdakhan.mak/cs-playwright-test-framework/core';

const config = CSConfigurationManager.getInstance();

const baseUrl = config.get('BASE_URL');
const timeout = config.getNumber('TIMEOUT');
const isHeadless = config.getBoolean('HEADLESS');
const retries = config.getNumber('RETRY_COUNT', 0);

// Value resolution with interpolation
const resolver = CSValueResolver.getInstance();
const url = resolver.resolve('{config:BASE_URL}/api/users');
const envVar = resolver.resolve('{env:MY_ENV_VAR}');
const scenarioVar = resolver.resolve('{scenario:userId}');
```

---

## 12. QAF Excel to JSON Conversion

### QAF Excel Format
```
| TD_LoginData | username | password  | isValid | expectedMsg      |
|              | admin    | Admin@123 | true    | Welcome          |
|              | user1    | wrongpass | false   | Invalid password |
|              | guest    | Guest@123 | true    | Welcome Guest    | TD_LoginData |
```

### QAF Java Usage
```java
@QAFDataProvider(dataFile = "resources/data/testdata.xls", key = "LoginData")
```

### Converted JSON (test/<project>/data/login-data.json)
```json
[
  { "username": "admin", "password": "Admin@123", "isValid": true, "expectedMsg": "Welcome", "runFlag": "Yes" },
  { "username": "user1", "password": "wrongpass", "isValid": false, "expectedMsg": "Invalid password", "runFlag": "Yes" },
  { "username": "guest", "password": "Guest@123", "isValid": true, "expectedMsg": "Welcome Guest", "runFlag": "Yes" }
]
```

### Multiple Data Blocks
```
| TD_LoginData | username | password  |              |
|              | admin    | pass123   |              |
|              | user1    | pass456   | TD_LoginData |
|              |          |           |              |
| TD_SearchData| searchTerm | expectedCount |        |
|              | product1   | 10            |        |
|              | product2   | 5             | TD_SearchData |
```

Convert to:
- `login-data.json` → Data from `TD_LoginData` block
- `search-data.json` → Data from `TD_SearchData` block

---

## 13. Correct Imports Reference

```typescript
// Core - Page base, decorators, config
import { CSBasePage, CSPage, CSGetElement } from '@mdakhan.mak/cs-playwright-test-framework/core';
import { CSConfigurationManager } from '@mdakhan.mak/cs-playwright-test-framework/core';

// Element - WebElement, Factory
import { CSWebElement, CSElementFactory } from '@mdakhan.mak/cs-playwright-test-framework/element';

// Reporter - STATIC methods only
import { CSReporter } from '@mdakhan.mak/cs-playwright-test-framework/reporter';

// Browser
import { CSBrowserManager } from '@mdakhan.mak/cs-playwright-test-framework/browser';

// BDD - Step definitions, hooks, context
import { StepDefinitions, CSBDDStepDef, Page } from '@mdakhan.mak/cs-playwright-test-framework/bdd';
import { CSBefore, CSAfter, CSBeforeStep, CSAfterStep } from '@mdakhan.mak/cs-playwright-test-framework/bdd';
import { CSScenarioContext, CSBDDContext } from '@mdakhan.mak/cs-playwright-test-framework/bdd';

// Assertions
import { CSAssert, expect } from '@mdakhan.mak/cs-playwright-test-framework/assertions';

// Database
import { CSDBUtils } from '@mdakhan.mak/cs-playwright-test-framework/database-utils';
import { CSDatabase, CSDatabaseManager } from '@mdakhan.mak/cs-playwright-test-framework/database';

// API
import { CSAPIClient } from '@mdakhan.mak/cs-playwright-test-framework/api';

// SOAP (separate client)
import { CSSoapClient } from '@mdakhan.mak/cs-playwright-test-framework/api';

// Utilities - Lightweight (exported from barrel)
import { CSStringUtility } from '@mdakhan.mak/cs-playwright-test-framework/utilities';
import { CSDateTimeUtility } from '@mdakhan.mak/cs-playwright-test-framework/utilities';
import { CSCsvUtility } from '@mdakhan.mak/cs-playwright-test-framework/utilities';
import { CSValueResolver, CSEncryptionUtil } from '@mdakhan.mak/cs-playwright-test-framework/utilities';

// Utilities - Heavy (direct import to avoid slow startup)
const { CSExcelUtility } = require('@mdakhan.mak/cs-playwright-test-framework/dist/utils/CSExcelUtility');
const { CSComparisonUtility } = require('@mdakhan.mak/cs-playwright-test-framework/dist/utils/CSComparisonUtility');

// Spec style
import { describe, test, beforeEach, afterEach, beforeAll, afterAll } from '@mdakhan.mak/cs-playwright-test-framework/spec';
```

### WRONG Patterns (Never Use)
```typescript
// WRONG - Single barrel import causes errors
import { CSBasePage, CSWebElement, CSReporter } from '@mdakhan.mak/cs-playwright-test-framework';

// WRONG - /context doesn't exist, use /bdd
import { CSScenarioContext } from '@mdakhan.mak/cs-playwright-test-framework/context';

// WRONG - /assert doesn't exist, use /assertions
import { CSAssert } from '@mdakhan.mak/cs-playwright-test-framework/assert';

// WRONG - /utils doesn't exist, use /utilities
import { CSStringUtility } from '@mdakhan.mak/cs-playwright-test-framework/utils';
```

