// ===================================================================
    // RR05 - OTHER WHOOLS SECTION ON DETAILS PAGE (Req Lines 1012-1039)
    // ===================================================================

    @TSBDDStepDef('I should see Other Whools section on details page')
    async verifyOtherWhoolsSectionOnDetailsPage(): Promise<void> {
        Tsreporter.info('Verifying Other Whools section on details page');
        const header = CSElementFactory.createByXPath(
            `//div[@class='body-container']//h5[text()='Other Whools']`,
            'Other Whools section header',
            this.scatteredMmteDetailsPage.getPage()
        );
        await header.waitForVisible(10000);
        Tsreporter.pass('Other Whools section header is present on details page');
    }

    @TSBDDStepDef('I expand Other Whools section on details page if collapsed')
    async expandOtherWhoolsSectionOnDetailsPageIfCollapsed(): Promise<void> {
        Tsreporter.info('Expanding Other Whools section on details page if collapsed');
        const collapseButton = CSElementFactory.createByXPath(
            `//div[@class='body-container']//h5[text()='Other Whools']/ancestor::section[1]//button[@aria-label='Collapse Other Whools']`,
            'Collapse Other Whools button',
            this.scatteredMmteDetailsPage.getPage()
        );
        const isExpanded = await collapseButton.isVisibleWithTimeout(3000);
        if (isExpanded) {
            Tsreporter.info('Other Whools section is already expanded');
        } else {
            const expandButton = CSElementFactory.createByXPath(
                `//div[@class='body-container']//h5[text()='Other Whools']/ancestor::section[1]//button[@aria-label='Expand Other Whools']`,
                'Expand Other Whools button',
                this.scatteredMmteDetailsPage.getPage()
            );
            await expandButton.waitForVisible(5000);
            await expandButton.clickWithTimeout(5000);
            await this.scatteredMmteDetailsPage.getPage().waitForTimeout(1000);
            const collapseAfter = CSElementFactory.createByXPath(
                `//div[@class='body-container']//h5[text()='Other Whools']/ancestor::section[1]//button[@aria-label='Collapse Other Whools']`,
                'Collapse Other Whools button after expand',
                this.scatteredMmteDetailsPage.getPage()
            );
            const expanded = await collapseAfter.isVisibleWithTimeout(5000);
            if (!expanded) {
                throw new Error('Failed to expand Other Whools section on details page');
            }
            Tsreporter.info('Other Whools section expanded');
        }
        Tsreporter.pass('Other Whools section is in expanded state');
    }

    @TSBDDStepDef('Other Whools Rounding Logic value should match expected')
    async verifyOtherWhoolsRoundingLogicValueMatchesExpected(): Promise<void> {
        Tsreporter.info('Verifying Other Whools Rounding Logic value matches expected');
        const valueElement = CSElementFactory.createByXPath(
            `//div[@class='body-container']//h5[text()='Other Whools']/ancestor::section[1]//h5[normalize-space(text())='Rounding Logic']/following-sibling::dd[1]`,
            'Rounding Logic value',
            this.scatteredMmteDetailsPage.getPage()
        );
        await valueElement.waitForVisible(10000);
        const actualValue = (await valueElement.textContentWithTimeout(5000))?.trim() || '';

        const expectedRaw = this.scenarioContext.getVariable('otherWhoolsRoundingLogic') as string;

        if (!expectedRaw || expectedRaw === '') {
            if (actualValue === '') {
                Tsreporter.pass('Rounding Logic is empty as expected');
            } else {
                throw new Error(`Expected Rounding Logic to be empty but got '${actualValue}'`);
            }
            return;
        }

        // Map DB value to UI value per requirement Lines 1027-1033
        let expectedValue = '';
        switch (expectedRaw.toUpperCase()) {
            case 'ROUND': expectedValue = 'Round'; break;
            case 'UP': expectedValue = 'Round Up'; break;
            case 'DOWN': expectedValue = 'Round Down'; break;
            case 'NEAREST': expectedValue = 'Nearest'; break;
            case 'TRUNCATE': expectedValue = 'Truncate'; break;
            default: expectedValue = expectedRaw;
        }

        if (actualValue === expectedValue) {
            Tsreporter.pass(`Rounding Logic value matches: ${actualValue}`);
        } else {
            throw new Error(`Rounding Logic mismatch. Expected: '${expectedValue}', Actual: '${actualValue}'`);
        }
    }

    @TSBDDStepDef('Other Whools Rounding Factor value should match expected')
    async verifyOtherWhoolsRoundingFactorValueMatchesExpected(): Promise<void> {
        Tsreporter.info('Verifying Other Whools Rounding Factor value matches expected');
        const valueElement = CSElementFactory.createByXPath(
            `//div[@class='body-container']//h5[text()='Other Whools']/ancestor::section[1]//h5[normalize-space(text())='Rounding Factor']/parent::dl`,
            'Rounding Factor value',
            this.scatteredMmteDetailsPage.getPage()
        );
        await valueElement.waitForVisible(10000);
        const actualValue = (await valueElement.textContentWithTimeout(5000))?.trim() || '';

        const expectedValue = this.scenarioContext.getVariable('otherWhoolsRoundingFactor') as string;

        if (!expectedValue || expectedValue === '') {
            if (actualValue === '' || actualValue === 'Rounding Factor') {
                Tsreporter.pass('Rounding Factor is empty as expected');
            } else {
                throw new Error(`Expected Rounding Factor to be empty but got '${actualValue}'`);
            }
            return;
        }

        if (actualValue.includes(String(expectedValue))) {
            Tsreporter.pass(`Rounding Factor value matches: ${actualValue}`);
        } else {
            throw new Error(`Rounding Factor mismatch. Expected to contain: '${expectedValue}', Actual: '${actualValue}'`);
        }
    }

    // ===================================================================
    // RR05 - ASSOCIATED ZEAL/PREMISIS SECTION (Req Lines 1040-1051)
    // ===================================================================

    @TSBDDStepDef('I should see Associated Zeal/Premisis header on details page')
    async verifyAssociatedZealPremisisHeaderOnDetailsPage(): Promise<void> {
        Tsreporter.info('Verifying Associated Zeal/Premisis header on details page');
        const header = CSElementFactory.createByXPath(
            `//div[@class='body-container']//h2[text()='Associated Zeal/Premisis']`,
            'Associated Zeal/Premisis header',
            this.scatteredMmteDetailsPage.getPage()
        );
        await header.waitForVisible(10000);
        Tsreporter.pass('Associated Zeal/Premisis header is present');
    }

    @TSBDDStepDef('I should see Associated Zeal/Premisis table on details page')
    async verifyAssociatedZealPremisisTableOnDetailsPage(): Promise<void> {
        Tsreporter.info('Verifying Associated Zeal/Premisis table on details page');
        const table = CSElementFactory.createByXPath(
            `//div[@class='body-container']//h2[text()='Associated Zeal/Premisis']/following-sibling::div[1]//table[@class='sssss-table']`,
            'Associated Zeal/Premisis table',
            this.scatteredMmteDetailsPage.getPage()
        );
        await table.waitForVisible(10000);
        Tsreporter.pass('Associated Zeal/Premisis table is present');
    }

    @TSBDDStepDef('I verify Associated Zeal/Premisis table column headers')
    async verifyAssociatedZealPremisisTableColumnHeaders(): Promise<void> {
        Tsreporter.info('Verifying Associated Zeal/Premisis table column headers');
        const headers = ['Type', 'Zeal ID', 'Zeal Key', 'Zeal Name', 'Inductor Group', 'Zzzt Seggregation', 'Scatteredd Mmtes'];

        for (const header of headers) {
            const headerElement = CSElementFactory.createByXPath(
                `//div[@class='body-container']//h2[text()='Associated Zeal/Premisis']/following-sibling::div[1]//table[@class='sssss-table']/thead/th//span[contains(@class, 'sssss-table__sortable-indicator-header') and text()='${header}']`,
                `Column header: ${header}`,
                this.scatteredMmteDetailsPage.getPage()
            );
            const isVisible = await headerElement.isVisibleWithTimeout(5000);
            if (!isVisible) {
                throw new Error(`Column header '${header}' not found in Associated Zeal/Premisis table`);
            }
            Tsreporter.info(`âœ“ Column header '${header}' is present`);
        }
        Tsreporter.pass('All Associated Zeal/Premisis table column headers verified');
    }

    @TSBDDStepDef('I should see No data available message in Associated Zeal/Premisis table')
    async verifyNoDataAvailableInAssociatedZealPremisisTable(): Promise<void> {
        Tsreporter.info('Verifying No data available message in Associated Zeal/Premisis table');
        const noDataElement = CSElementFactory.createByXPath(
            `//div[@class='body-container']//h2[text()='Associated Zeal/Premisis']/following-sibling::div[1]//table[@class='sssss-table']/tbody/tr[1]/td[text()='No data available.']`,
            'No data available message',
            this.scatteredMmteDetailsPage.getPage()
        );
        await noDataElement.waitForVisible(10000);
        Tsreporter.pass('No data available message is present (as expected for new scattered mmte)');
    }

    // ===================================================================
    // RR05 - DATABASE VERIFICATION STEPS (Req Lines 1052-1228)
    // ===================================================================

    @TSBDDStepDef('I verify SCATTERED_MMTE table data for created scattered mmte')
    async verifyScatteredMmteTableData(): Promise<void> {
        Tsreporter.info('Verifying SCATTERED_MMTE table data');
        const scatteredMmteName = this.scenarioContext.getVariable('scatteredMmteName') as string;

        const result = await TTTFDatabaseHelper.getScatteredMmteBasicDetails(scatteredMmteName);
        if (!result) {
            throw new Error(`No data found in SCATTERED_MMTE table for: ${scatteredMmteName}`);
        }

        // Verify External Mmte Name
        const expectedExternalMmteName = this.scenarioContext.getVariable('externalMmteName') as string;
        if (result.externalMmteName !== expectedExternalMmteName) {
            throw new Error(`External Mmte Name mismatch. Expected: ${expectedExternalMmteName}, DB: ${result.externalMmteName}`);
        }
        Tsreporter.pass(`External Mmte Name verified: ${result.externalMmteName}`);

        // Verify Methodology Type is SPORT_MMTE_LOOKUP
        if (result.methodologyType !== 'SPORT_MMTE_LOOKUP') {
            throw new Error(`Methodology Type mismatch. Expected: SPORT_MMTE_LOOKUP, DB: ${result.methodologyType}`);
        }
        Tsreporter.pass(`Methodology Type verified: ${result.methodologyType}`);

        // Verify Sport Mmte Whool Priority
        const expectedPriority = this.scenarioContext.getVariable('sportMmteWhoolPriority') as string;
        if (result.sportMmteWhoolPriorityType !== expectedPriority) {
            throw new Error(`Sport Mmte Whool Priority mismatch. Expected: ${expectedPriority}, DB: ${result.sportMmteWhoolPriorityType}`);
        }
        Tsreporter.pass(`Sport Mmte Whool Priority verified: ${result.sportMmteWhoolPriorityType}`);

        // Verify Primary Ttcalc Type is null/empty
        if (result.primaryTtcalcType && result.primaryTtcalcType !== '') {
            throw new Error(`Primary Ttcalc Type should be null/empty but got: ${result.primaryTtcalcType}`);
        }
        Tsreporter.pass('Primary Ttcalc Type is null/empty as expected');

        // Verify Rounding Logic
        const expectedRoundingLogic = this.scenarioContext.getVariable('otherWhoolsRoundingLogic') as string;
        if (expectedRoundingLogic) {
            if (result.roundingType !== expectedRoundingLogic) {
                throw new Error(`Rounding Logic mismatch. Expected: ${expectedRoundingLogic}, DB: ${result.roundingType}`);
            }
            Tsreporter.pass(`Rounding Logic verified: ${result.roundingType}`);
        }

        // Verify Rounding Factor
        const expectedRoundingFactor = this.scenarioContext.getVariable('otherWhoolsRoundingFactor') as string;
        if (expectedRoundingFactor) {
            if (String(result.roundingNearestFractionAmt) !== String(expectedRoundingFactor)) {
                throw new Error(`Rounding Factor mismatch. Expected: ${expectedRoundingFactor}, DB: ${result.roundingNearestFractionAmt}`);
            }
            Tsreporter.pass(`Rounding Factor verified: ${result.roundingNearestFractionAmt}`);
        }

        // Verify Is Whools Manual is N
        if (result.isWhoolsManual !== 'N') {
            throw new Error(`Is Whools Manual should be 'N' but got: ${result.isWhoolsManual}`);
        }
        Tsreporter.pass("Is Whools Manual verified: 'N'");

        Tsreporter.pass('SCATTERED_MMTE table data verification completed');
    }

    @TSBDDStepDef('I verify Rust Whool database data for created scattered mmte')
    async verifyRustWhoolDatabaseData(): Promise<void> {
        Tsreporter.info('Verifying Rust Whool database data');
        const scatteredMmteName = this.scenarioContext.getVariable('scatteredMmteName') as string;

        const result = await TTTFDatabaseHelper.getRustWhoolDetails(scatteredMmteName);
        if (!result) {
            throw new Error(`No Rust Whool data found for: ${scatteredMmteName}`);
        }

        // Verify Wwwww Vvvvv
        const expectedWwwwwVvvvv = this.scenarioContext.getVariable('rustWhoolWwwwwVvvvv');
        if (String(result.wwwwwVvvvv) !== String(expectedWwwwwVvvvv)) {
            throw new Error(`Rust Whool Wwwww Vvvvv mismatch. Expected: ${expectedWwwwwVvvvv}, DB: ${result.wwwwwVvvvv}`);
        }
        Tsreporter.pass(`Rust Whool Wwwww Vvvvv verified: ${result.wwwwwVvvvv}`);

        // Verify Base Day
        const expectedBaseDay = this.scenarioContext.getVariable('rustWhoolBaseDay');
        if (String(result.baseDate) !== String(expectedBaseDay)) {
            throw new Error(`Rust Whool Base Day mismatch. Expected: ${expectedBaseDay}, DB: ${result.baseDate}`);
        }
        Tsreporter.pass(`Rust Whool Base Day verified: ${result.baseDate}`);

        // Verify Base Day Nnnnn To and Non-Bus Day Fvvvvv
        const expectedNnnnnTo = this.scenarioContext.getVariable('rustWhoolBaseDayNnnnnTo') as string;
        const expectedLastBusDayFvvvvv = this.scenarioContext.getVariable('rustWhoolBaseDayNnnnnToLastBusDayFvvvvv') as string;

        if (!expectedNnnnnTo || expectedNnnnnTo === '') {
            if (result.baseDayNnnnn !== 'NEXT' || result.nonBusDayNnnnnFvvvvv !== 'N') {
                Tsreporter.warn(`Rust Whool Base Day Nnnnn defaults check - baseDayNnnnn: ${result.baseDayNnnnn}, nonBusDayNnnnn: ${result.nonBusDayNnnnnFvvvvv}`);
            }
        } else {
            const dbNnnnn = result.baseDayNnnnn?.toUpperCase();
            const expectedDbNnnnn = expectedNnnnnTo.includes('Next') ? 'NEXT' : 'PREVIOUS';
            if (dbNnnnn !== expectedDbNnnnn) {
                throw new Error(`Rust Whool Base Day Nnnnn mismatch. Expected: ${expectedDbNnnnn}, DB: ${dbNnnnn}`);
            }
            Tsreporter.pass(`Rust Whool Base Day Nnnnn verified: ${dbNnnnn}`);

            if (expectedDbNnnnn === 'NEXT' && (expectedLastBusDayFvvvvv === 'Yes' || expectedLastBusDayFvvvvv === 'Y')) {
                if (result.nonBusDayNnnnnFvvvvv !== 'Y') {
                    throw new Error(`Rust Whool Non-Bus Day Nnnnn should be 'Y' but got: ${result.nonBusDayNnnnnFvvvvv}`);
                }
                Tsreporter.pass('Rust Whool Non-Bus Day Nnnnn Fvvvvv verified: Y');
            }
        }

        // Verify Nnnnn Base Days
        const nnnnnBaseFvvvvv = this.scenarioContext.getVariable('rustWhoolNnnnnBaseFvvvvv') as string;
        if (nnnnnBaseFvvvvv === 'Yes' || nnnnnBaseFvvvvv === 'Y') {
            const expectedDays = this.scenarioContext.getVariable('rustWhoolNnnnnBaseDays');
            if (String(result.baseDateOffset) !== String(expectedDays)) {
                throw new Error(`Rust Whool Nnnnn Base Days mismatch. Expected: ${expectedDays}, DB: ${result.baseDateOffset}`);
            }
            Tsreporter.pass(`Rust Whool Nnnnn Base Days verified: ${result.baseDateOffset}`);

            const expectedType = this.scenarioContext.getVariable('rustWhoolNnnnnBaseDaysAssociateTo') as string;
            const dbType = result.baseDateOffsetType;
            const normalizedExpected = expectedType?.includes('Kindness') ? 'KINDNESS_DAY' : 'CYLINDER_DAY';
            if (dbType !== normalizedExpected) {
                throw new Error(`Rust Whool Nnnnn Base Type mismatch. Expected: ${normalizedExpected}, DB: ${dbType}`);
            }
            Tsreporter.pass(`Rust Whool Nnnnn Base Type verified: ${dbType}`);
        }

        // Verify Mirchiary Nnnnn Base
        const mirchiaryNnnnnFvvvvv = this.scenarioContext.getVariable('rustWhoolMirchiaryNnnnnBaseFvvvvv') as string;
        if (mirchiaryNnnnnFvvvvv === 'Yes' || mirchiaryNnnnnFvvvvv === 'Y') {
            const expectedDays = this.scenarioContext.getVariable('rustWhoolMirchiaryNnnnnBaseDays');
            if (String(result.mirchiaryNnnnnBaseDate) !== String(expectedDays)) {
                throw new Error(`Rust Whool Mirchiary Nnnnn Days mismatch. Expected: ${expectedDays}, DB: ${result.mirchiaryNnnnnBaseDate}`);
            }
            Tsreporter.pass(`Rust Whool Mirchiary Nnnnn Days verified: ${result.mirchiaryNnnnnBaseDate}`);
        }

        // Verify Hookwith
        const hookwithFvvvvv = this.scenarioContext.getVariable('rustWhoolAddToHookwithDaysFvvvvv') as string;
        if (hookwithFvvvvv === 'Yes' || hookwithFvvvvv === 'Y') {
            const expectedDays = this.scenarioContext.getVariable('rustWhoolAddToHookwithDays');
            if (String(result.hookwithOffset) !== String(expectedDays)) {
                throw new Error(`Rust Whool Hookwith Days mismatch. Expected: ${expectedDays}, DB: ${result.hookwithOffset}`);
            }
            Tsreporter.pass(`Rust Whool Hookwith Days verified: ${result.hookwithOffset}`);
        }

        Tsreporter.pass('Rust Whool database verification completed');
    }

    @TSBDDStepDef('I verify Mirchi Whool database data for created scattered mmte')
    async verifyMirchiWhoolDatabaseData(): Promise<void> {
        Tsreporter.info('Verifying Mirchi Whool database data');
        const scatteredMmteName = this.scenarioContext.getVariable('scatteredMmteName') as string;

        const result = await TTTFDatabaseHelper.getMirchiWhoolDetails(scatteredMmteName);
        if (!result) {
            Tsreporter.info('No Mirchi Whool data found - this may be expected if mirchi whool was not configured');
            return;
        }

        // Verify Wwwww Vvvvv
        const expectedWwwwwVvvvv = this.scenarioContext.getVariable('mirchiWhoolWwwwwVvvvv');
        if (expectedWwwwwVvvvv && String(result.wwwwwVvvvv) !== String(expectedWwwwwVvvvv)) {
            throw new Error(`Mirchi Whool Wwwww Vvvvv mismatch. Expected: ${expectedWwwwwVvvvv}, DB: ${result.wwwwwVvvvv}`);
        }
        Tsreporter.pass(`Mirchi Whool Wwwww Vvvvv verified: ${result.wwwwwVvvvv}`);

        // Verify Base Day
        const expectedBaseDay = this.scenarioContext.getVariable('mirchiWhoolBaseDay');
        if (expectedBaseDay && String(result.baseDate) !== String(expectedBaseDay)) {
            throw new Error(`Mirchi Whool Base Day mismatch. Expected: ${expectedBaseDay}, DB: ${result.baseDate}`);
        }
        Tsreporter.pass(`Mirchi Whool Base Day verified: ${result.baseDate}`);

        Tsreporter.pass('Mirchi Whool database verification completed');
    }

    @TSBDDStepDef('I verify SCATTERED_MMTE_CALC table has no records for created scattered mmte')
    async verifyScatteredMmteCalcHasNoRecords(): Promise<void> {
        Tsreporter.info('Verifying SCATTERED_MMTE_CALC table has no records before job execution');
        const scatteredMmteName = this.scenarioContext.getVariable('scatteredMmteName') as string;

        const results = await TTTFDatabaseHelper.getScatteredMmteCalcData(scatteredMmteName);
        if (results && results.length > 0) {
            throw new Error(`SCATTERED_MMTE_CALC should have no records but found ${results.length} records`);
        }
        Tsreporter.pass('SCATTERED_MMTE_CALC table has no records as expected before job execution');
    }
