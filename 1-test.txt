async waitForFullPageLoad(): Promise<void> {
        CSReporter.info('Waiting for CRM page to fully load...');

        // Use the framework's SSO handler to:
        //   1. Block ALL *.powerapps.com domains (prevents PowerApps from loading/authenticating)
        //   2. Block MSAL.js silent auth for PowerApps scopes (prevents 400 → popup escalation)
        //   3. Inject MutationObserver + polling to auto-dismiss popups as they appear
        // This prevents the infinite "Sign in required" popup that PowerApps triggers on VDI.
        const ssoHandler = new CSMicrosoftSSOHandler();
        await ssoHandler.suppressPowerAppsSignInPopups(this.page);

        // Wait for DOM content loaded, then network idle
        await this.waitForDomContentLoaded();

        try {
            await this.waitForNetworkIdle();
        } catch {
            // Network idle may timeout due to CRM long-polling — that's OK.
            // The MutationObserver handles any popups that appear during the wait.
            CSReporter.debug('Network idle timeout — continuing (CRM uses long-polling)');
        }

        CSReporter.pass('CRM page loaded');
    }
