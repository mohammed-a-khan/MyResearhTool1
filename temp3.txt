// ===================================================================
    // CP03: CONDITIONS FORM-FILLING METHODS
    // ===================================================================

    /**
     * Select Primary Ttcalc from dropdown (Compound/Simple)
     */
    public async selectPrimaryTtcalc(value: string): Promise<void> {
        Tsreporter.info(`Selecting Primary Ttcalc: ${value}`);
        await this.primaryTtcalcDropdown.waitForVisible(10000);
        await this.primaryTtcalcDropdown.clickWithTimeout(10000);

        const dropdownList = CSElementFactory.createByXPath(
            '//div[contains(@class, "sssss-balloon") and @name="ttcalcDurationType"]//ul[@role="listbox"]',
            'Primary Ttcalc dropdown list',
            this.page
        );
        await dropdownList.waitForVisible(10000);

        const option = CSElementFactory.createByXPath(
            `//div[contains(@class, 'sssss-balloon') and @name='ttcalcDurationType']//li[@role='option']//span[contains(@class, 'sssss-menu-item__label')]/span[text()='${value}']`,
            `Primary Ttcalc option: ${value}`,
            this.page
        );
        await option.waitForVisible(10000);
        await option.clickWithTimeout(10000);
        Tsreporter.pass(`Selected Primary Ttcalc: ${value}`);
    }

    /**
     * Select Annual Accrual Days from dropdown (360/365)
     */
    public async selectAnnualAccrualDays(value: string): Promise<void> {
        Tsreporter.info(`Selecting Annual Accrual Days: ${value}`);
        await this.annualAccrualDaysDropdown.waitForVisible(10000);
        await this.annualAccrualDaysDropdown.clickWithTimeout(10000);

        const dropdownList = CSElementFactory.createByXPath(
            '//div[contains(@class, "sssss-balloon") and @name="annualAccrualDays"]//ul[@role="listbox"]',
            'Annual Accrual Days dropdown list',
            this.page
        );
        await dropdownList.waitForVisible(10000);

        const option = CSElementFactory.createByXPath(
            `//div[contains(@class, 'sssss-balloon') and @name='annualAccrualDays']//li[@role='option']//span[contains(@class, 'sssss-menu-item__label')]/span[text()='${value}']`,
            `Annual Accrual Days option: ${value}`,
            this.page
        );
        await option.waitForVisible(10000);
        await option.clickWithTimeout(10000);
        Tsreporter.pass(`Selected Annual Accrual Days: ${value}`);
    }

    // ===================================================================
    // CP03: MMTE START DATE FORM-FILLING METHODS
    // ===================================================================

    /**
     * Enter Mmte Start Date Wwwww Vvvvv
     */
    public async enterMmteStartDateWwwwwVvvvv(wwwwwVvvvv: string): Promise<void> {
        Tsreporter.info(`Entering Mmte Start Date Wwwww Vvvvv: ${wwwwwVvvvv}`);
        await this.mmteStartDateWwwwwVvvvvInput.waitForVisible(10000);
        await this.mmteStartDateWwwwwVvvvvInput.clear();
        await this.mmteStartDateWwwwwVvvvvInput.fill(wwwwwVvvvv);
        Tsreporter.pass(`Entered Mmte Start Date Wwwww Vvvvv: ${wwwwwVvvvv}`);
    }

    /**
     * Enter Mmte Start Date Base Day
     */
    public async enterMmteStartDateBaseDay(baseDay: string): Promise<void> {
        Tsreporter.info(`Entering Mmte Start Date Base Day: ${baseDay}`);
        await this.mmteStartDateBaseDayInput.waitForVisible(10000);
        await this.mmteStartDateBaseDayInput.clear();
        await this.mmteStartDateBaseDayInput.fill(baseDay);
        Tsreporter.pass(`Entered Mmte Start Date Base Day: ${baseDay}`);
    }

    /**
     * Select Mmte Start Date Base Day Nnnnn To (Next or Previous Kindness Day)
     */
    public async selectMmteStartDateBaseDayNnnnnTo(nnnnnTo: string): Promise<void> {
        Tsreporter.info(`Selecting Mmte Start Date Base Day Nnnnn To: ${nnnnnTo}`);
        if (nnnnnTo.toLowerCase().includes('next')) {
            await this.mmteStartDateNextKindnessDayRadio.clickWithTimeout(10000);
        } else if (nnnnnTo.toLowerCase().includes('previous')) {
            await this.mmteStartDatePreviousKindnessDayRadio.clickWithTimeout(10000);
        }
        await this.page.waitForTimeout(300);
        Tsreporter.pass(`Selected Mmte Start Date Base Day Nnnnn To: ${nnnnnTo}`);
    }

    /**
     * Check Mmte Start Date Nnnnn to Last Kindness Day checkbox
     */
    public async checkMmteStartDateNnnnnToLastBusDay(shouldCheck: boolean): Promise<void> {
        Tsreporter.info(`Setting Mmte Start Date Nnnnn to Last Bus Day: ${shouldCheck}`);
        const ariaChecked = await this.mmteStartDateNnnnnToLastBusDayCheckbox.getAttributeWithTimeout('aria-checked', 5000);
        const isCurrentlyChecked = ariaChecked === 'true';
        if (shouldCheck !== isCurrentlyChecked) {
            await this.mmteStartDateNnnnnToLastBusDayCheckbox.clickWithTimeout(10000);
            await this.page.waitForTimeout(300);
        }
        Tsreporter.pass(`Mmte Start Date Nnnnn to Last Bus Day set to: ${shouldCheck}`);
    }

    /**
     * Configure Mmte Start Date Nnnnn Base (checkbox + days + type radio)
     */
    public async configureMmteStartDateNnnnnBase(days: string, associateTo: string): Promise<void> {
        Tsreporter.info(`Configuring Mmte Start Date Nnnnn Base: ${days}, ${associateTo}`);
        const ariaChecked = await this.mmteStartDateNnnnnBaseCheckbox.getAttributeWithTimeout('aria-checked', 5000);
        if (ariaChecked !== 'true') {
            await this.mmteStartDateNnnnnBaseCheckbox.clickWithTimeout(10000);
            await this.page.waitForTimeout(300);
        }
        await this.mmteStartDateNnnnnBaseDaysInput.waitForVisible(10000);
        await this.mmteStartDateNnnnnBaseDaysInput.clear();
        await this.mmteStartDateNnnnnBaseDaysInput.fill(days);
        if (associateTo.toLowerCase().includes('kindness')) {
            await this.mmteStartDateNnnnnBaseKindnessDaysRadio.clickWithTimeout(10000);
        } else {
            await this.mmteStartDateNnnnnBaseCylinderDaysRadio.clickWithTimeout(10000);
        }
        Tsreporter.pass(`Configured Mmte Start Date Nnnnn Base: ${days} ${associateTo}`);
    }

    /**
     * Configure Mmte Start Date Mirchiary Nnnnn Base (checkbox + days + type radio)
     */
    public async configureMmteStartDateMirchiaryNnnnnBase(days: string, associateTo: string): Promise<void> {
        Tsreporter.info(`Configuring Mmte Start Date Mirchiary Nnnnn Base: ${days}, ${associateTo}`);
        const ariaChecked = await this.mmteStartDateMirchiaryNnnnnBaseCheckbox.getAttributeWithTimeout('aria-checked', 5000);
        if (ariaChecked !== 'true') {
            await this.mmteStartDateMirchiaryNnnnnBaseCheckbox.clickWithTimeout(10000);
            await this.page.waitForTimeout(300);
        }
        await this.mmteStartDateMirchiaryNnnnnBaseDaysInput.waitForVisible(10000);
        await this.mmteStartDateMirchiaryNnnnnBaseDaysInput.clear();
        await this.mmteStartDateMirchiaryNnnnnBaseDaysInput.fill(days);
        if (associateTo.toLowerCase().includes('kindness')) {
            await this.mmteStartDateMirchiaryNnnnnBaseKindnessDaysRadio.clickWithTimeout(10000);
        } else {
            await this.mmteStartDateMirchiaryNnnnnBaseCylinderDaysRadio.clickWithTimeout(10000);
        }
        Tsreporter.pass(`Configured Mmte Start Date Mirchiary Nnnnn Base: ${days} ${associateTo}`);
    }

    /**
     * Configure Mmte Start Date Add to Hookwith (checkbox + days + weekends/borings)
     */
    public async configureMmteStartDateAddToHookwith(days: string, includeWeekends: boolean, includeBorings: boolean): Promise<void> {
        Tsreporter.info(`Configuring Mmte Start Date Add to Hookwith: ${days}, weekends=${includeWeekends}, borings=${includeBorings}`);
        const ariaChecked = await this.mmteStartDateAddToHookwithCheckbox.getAttributeWithTimeout('aria-checked', 5000);
        if (ariaChecked !== 'true') {
            await this.mmteStartDateAddToHookwithCheckbox.clickWithTimeout(10000);
            await this.page.waitForTimeout(300);
        }
        await this.mmteStartDateHookwithDaysInput.waitForVisible(10000);
        await this.mmteStartDateHookwithDaysInput.clear();
        await this.mmteStartDateHookwithDaysInput.fill(days);
        if (includeWeekends) {
            const weekendsChecked = await this.mmteStartDateIncludeWeekendsCheckbox.getAttributeWithTimeout('aria-checked', 5000);
            if (weekendsChecked !== 'true') {
                await this.mmteStartDateIncludeWeekendsCheckbox.clickWithTimeout(10000);
            }
        }
        if (includeBorings) {
            const boringsChecked = await this.mmteStartDateIncludeBoringsCheckbox.getAttributeWithTimeout('aria-checked', 5000);
            if (boringsChecked !== 'true') {
                await this.mmteStartDateIncludeBoringsCheckbox.clickWithTimeout(10000);
            }
        }
        Tsreporter.pass(`Configured Mmte Start Date Add to Hookwith`);
    }

    /**
     * Select Mmte Start Date Hookwith Associate Cylinders from popup
     */
    public async selectMmteStartDateHookwithAssociateCylinders(cylinders: string[]): Promise<void> {
        Tsreporter.info(`Selecting Mmte Start Date Hookwith Associate Cylinders: ${cylinders.join(', ')}`);
        await this.mmteStartDateHookwithCylindersButton.waitForVisible(10000);
        await this.mmteStartDateHookwithCylindersButton.clickWithTimeout(10000);
        await this.addCylinderPopup.waitForVisible(10000);
        for (const cylinder of cylinders) {
            const cylinderCheckbox = CSElementFactory.createByXPath(
                `//div[@class='sssss-panel__content-wrapper']//div[@class='sssss-panel__body']//table[@class='sssss-table']/tbody//td/div[text()='${cylinder}']/ancestor::tr[1]/td[1]//span[@role='checkbox']`,
                `Cylinder checkbox: ${cylinder}`,
                this.page
            );
            const ariaChecked = await cylinderCheckbox.getAttributeWithTimeout('aria-checked', 5000);
            if (ariaChecked !== 'true') {
                await cylinderCheckbox.clickWithTimeout(10000);
                await this.page.waitForTimeout(200);
            }
        }
        await this.cylinderPopupApplyButton.waitForVisible(10000);
        await this.cylinderPopupApplyButton.clickWithTimeout(10000);
        await this.addCylinderPopup.waitForDetached(10000);
        Tsreporter.pass(`Selected Mmte Start Date Hookwith Associate Cylinders: ${cylinders.join(', ')}`);
    }

    // ===================================================================
    // CP03: MMTE END DATE FORM-FILLING METHODS
    // ===================================================================

    /**
     * Enter Mmte End Date Wwwww Vvvvv
     */
    public async enterMmteEndDateWwwwwVvvvv(wwwwwVvvvv: string): Promise<void> {
        Tsreporter.info(`Entering Mmte End Date Wwwww Vvvvv: ${wwwwwVvvvv}`);
        await this.mmteEndDateWwwwwVvvvvInput.waitForVisible(10000);
        await this.mmteEndDateWwwwwVvvvvInput.clear();
        await this.mmteEndDateWwwwwVvvvvInput.fill(wwwwwVvvvv);
        Tsreporter.pass(`Entered Mmte End Date Wwwww Vvvvv: ${wwwwwVvvvv}`);
    }

    /**
     * Enter Mmte End Date Base Day
     */
    public async enterMmteEndDateBaseDay(baseDay: string): Promise<void> {
        Tsreporter.info(`Entering Mmte End Date Base Day: ${baseDay}`);
        await this.mmteEndDateBaseDayInput.waitForVisible(10000);
        await this.mmteEndDateBaseDayInput.clear();
        await this.mmteEndDateBaseDayInput.fill(baseDay);
        Tsreporter.pass(`Entered Mmte End Date Base Day: ${baseDay}`);
    }

    /**
     * Select Mmte End Date Base Day Nnnnn To (Next or Previous Kindness Day)
     */
    public async selectMmteEndDateBaseDayNnnnnTo(nnnnnTo: string): Promise<void> {
        Tsreporter.info(`Selecting Mmte End Date Base Day Nnnnn To: ${nnnnnTo}`);
        if (nnnnnTo.toLowerCase().includes('next')) {
            await this.mmteEndDateNextKindnessDayRadio.clickWithTimeout(10000);
        } else if (nnnnnTo.toLowerCase().includes('previous')) {
            await this.mmteEndDatePreviousKindnessDayRadio.clickWithTimeout(10000);
        }
        await this.page.waitForTimeout(300);
        Tsreporter.pass(`Selected Mmte End Date Base Day Nnnnn To: ${nnnnnTo}`);
    }

    /**
     * Check Mmte End Date Nnnnn to Last Kindness Day checkbox
     */
    public async checkMmteEndDateNnnnnToLastBusDay(shouldCheck: boolean): Promise<void> {
        Tsreporter.info(`Setting Mmte End Date Nnnnn to Last Bus Day: ${shouldCheck}`);
        const ariaChecked = await this.mmteEndDateNnnnnToLastBusDayCheckbox.getAttributeWithTimeout('aria-checked', 5000);
        const isCurrentlyChecked = ariaChecked === 'true';
        if (shouldCheck !== isCurrentlyChecked) {
            await this.mmteEndDateNnnnnToLastBusDayCheckbox.clickWithTimeout(10000);
            await this.page.waitForTimeout(300);
        }
        Tsreporter.pass(`Mmte End Date Nnnnn to Last Bus Day set to: ${shouldCheck}`);
    }

    /**
     * Select Mmte End Date Associate Cylinders from popup
     */
    public async selectMmteEndDateAssociateCylinders(cylinders: string[]): Promise<void> {
        Tsreporter.info(`Selecting Mmte End Date Associate Cylinders: ${cylinders.join(', ')}`);
        await this.mmteEndDateAssociateCylindersButton.waitForVisible(10000);
        await this.mmteEndDateAssociateCylindersButton.clickWithTimeout(10000);
        await this.addCylinderPopup.waitForVisible(10000);
        for (const cylinder of cylinders) {
            const cylinderCheckbox = CSElementFactory.createByXPath(
                `//div[@class='sssss-panel__content-wrapper']//div[@class='sssss-panel__body']//table[@class='sssss-table']/tbody//td/div[text()='${cylinder}']/ancestor::tr[1]/td[1]//span[@role='checkbox']`,
                `Cylinder checkbox: ${cylinder}`,
                this.page
            );
            const ariaChecked = await cylinderCheckbox.getAttributeWithTimeout('aria-checked', 5000);
            if (ariaChecked !== 'true') {
                await cylinderCheckbox.clickWithTimeout(10000);
                await this.page.waitForTimeout(200);
            }
        }
        await this.cylinderPopupApplyButton.waitForVisible(10000);
        await this.cylinderPopupApplyButton.clickWithTimeout(10000);
        await this.addCylinderPopup.waitForDetached(10000);
        Tsreporter.pass(`Selected Mmte End Date Associate Cylinders: ${cylinders.join(', ')}`);
    }

    /**
     * Configure Mmte End Date Nnnnn Base (checkbox + days + type radio)
     */
    public async configureMmteEndDateNnnnnBase(days: string, associateTo: string): Promise<void> {
        Tsreporter.info(`Configuring Mmte End Date Nnnnn Base: ${days}, ${associateTo}`);
        const ariaChecked = await this.mmteEndDateNnnnnBaseCheckbox.getAttributeWithTimeout('aria-checked', 5000);
        if (ariaChecked !== 'true') {
            await this.mmteEndDateNnnnnBaseCheckbox.clickWithTimeout(10000);
            await this.page.waitForTimeout(300);
        }
        await this.mmteEndDateNnnnnBaseDaysInput.waitForVisible(10000);
        await this.mmteEndDateNnnnnBaseDaysInput.clear();
        await this.mmteEndDateNnnnnBaseDaysInput.fill(days);
        if (associateTo.toLowerCase().includes('kindness')) {
            await this.mmteEndDateNnnnnBaseKindnessDaysRadio.clickWithTimeout(10000);
        } else {
            await this.mmteEndDateNnnnnBaseCylinderDaysRadio.clickWithTimeout(10000);
        }
        Tsreporter.pass(`Configured Mmte End Date Nnnnn Base: ${days} ${associateTo}`);
    }

    /**
     * Configure Mmte End Date Mirchiary Nnnnn Base (checkbox + days + type radio)
     */
    public async configureMmteEndDateMirchiaryNnnnnBase(days: string, associateTo: string): Promise<void> {
        Tsreporter.info(`Configuring Mmte End Date Mirchiary Nnnnn Base: ${days}, ${associateTo}`);
        const ariaChecked = await this.mmteEndDateMirchiaryNnnnnBaseCheckbox.getAttributeWithTimeout('aria-checked', 5000);
        if (ariaChecked !== 'true') {
            await this.mmteEndDateMirchiaryNnnnnBaseCheckbox.clickWithTimeout(10000);
            await this.page.waitForTimeout(300);
        }
        await this.mmteEndDateMirchiaryNnnnnBaseDaysInput.waitForVisible(10000);
        await this.mmteEndDateMirchiaryNnnnnBaseDaysInput.clear();
        await this.mmteEndDateMirchiaryNnnnnBaseDaysInput.fill(days);
        if (associateTo.toLowerCase().includes('kindness')) {
            await this.mmteEndDateMirchiaryNnnnnBaseKindnessDaysRadio.clickWithTimeout(10000);
        } else {
            await this.mmteEndDateMirchiaryNnnnnBaseCylinderDaysRadio.clickWithTimeout(10000);
        }
        Tsreporter.pass(`Configured Mmte End Date Mirchiary Nnnnn Base: ${days} ${associateTo}`);
    }

    /**
     * Configure Mmte End Date Add to Hookwith (checkbox + days + weekends/borings)
     */
    public async configureMmteEndDateAddToHookwith(days: string, includeWeekends: boolean, includeBorings: boolean): Promise<void> {
        Tsreporter.info(`Configuring Mmte End Date Add to Hookwith: ${days}, weekends=${includeWeekends}, borings=${includeBorings}`);
        const ariaChecked = await this.mmteEndDateAddToHookwithCheckbox.getAttributeWithTimeout('aria-checked', 5000);
        if (ariaChecked !== 'true') {
            await this.mmteEndDateAddToHookwithCheckbox.clickWithTimeout(10000);
            await this.page.waitForTimeout(300);
        }
        await this.mmteEndDateHookwithDaysInput.waitForVisible(10000);
        await this.mmteEndDateHookwithDaysInput.clear();
        await this.mmteEndDateHookwithDaysInput.fill(days);
        if (includeWeekends) {
            const weekendsChecked = await this.mmteEndDateIncludeWeekendsCheckbox.getAttributeWithTimeout('aria-checked', 5000);
            if (weekendsChecked !== 'true') {
                await this.mmteEndDateIncludeWeekendsCheckbox.clickWithTimeout(10000);
            }
        }
        if (includeBorings) {
            const boringsChecked = await this.mmteEndDateIncludeBoringsCheckbox.getAttributeWithTimeout('aria-checked', 5000);
            if (boringsChecked !== 'true') {
                await this.mmteEndDateIncludeBoringsCheckbox.clickWithTimeout(10000);
            }
        }
        Tsreporter.pass(`Configured Mmte End Date Add to Hookwith`);
    }

    /**
     * Select Mmte End Date Hookwith Associate Cylinders from popup
     */
    public async selectMmteEndDateHookwithAssociateCylinders(cylinders: string[]): Promise<void> {
        Tsreporter.info(`Selecting Mmte End Date Hookwith Associate Cylinders: ${cylinders.join(', ')}`);
        await this.mmteEndDateHookwithCylindersButton.waitForVisible(10000);
        await this.mmteEndDateHookwithCylindersButton.clickWithTimeout(10000);
        await this.addCylinderPopup.waitForVisible(10000);
        for (const cylinder of cylinders) {
            const cylinderCheckbox = CSElementFactory.createByXPath(
                `//div[@class='sssss-panel__content-wrapper']//div[@class='sssss-panel__body']//table[@class='sssss-table']/tbody//td/div[text()='${cylinder}']/ancestor::tr[1]/td[1]//span[@role='checkbox']`,
                `Cylinder checkbox: ${cylinder}`,
                this.page
            );
            const ariaChecked = await cylinderCheckbox.getAttributeWithTimeout('aria-checked', 5000);
            if (ariaChecked !== 'true') {
                await cylinderCheckbox.clickWithTimeout(10000);
                await this.page.waitForTimeout(200);
            }
        }
        await this.cylinderPopupApplyButton.waitForVisible(10000);
        await this.cylinderPopupApplyButton.clickWithTimeout(10000);
        await this.addCylinderPopup.waitForDetached(10000);
        Tsreporter.pass(`Selected Mmte End Date Hookwith Associate Cylinders: ${cylinders.join(', ')}`);
    }

    /**
     * Configure Mmte End Date Lockout (checkbox + days)
     */
    public async configureMmteEndDateLockout(days: string): Promise<void> {
        Tsreporter.info(`Configuring Mmte End Date Lockout: ${days} days`);
        const ariaChecked = await this.mmteEndDateAddLockoutCheckbox.getAttributeWithTimeout('aria-checked', 5000);
        if (ariaChecked !== 'true') {
            await this.mmteEndDateAddLockoutCheckbox.clickWithTimeout(10000);
            await this.page.waitForTimeout(300);
        }
        await this.mmteEndDateLockoutDaysInput.waitForVisible(10000);
        await this.mmteEndDateLockoutDaysInput.clear();
        await this.mmteEndDateLockoutDaysInput.fill(days);
        Tsreporter.pass(`Configured Mmte End Date Lockout: ${days} days`);
    }


    -------------------------------------------------------------------------------

    import { CSBasePage, CSPage, CSGetElement } from '@mdakhan.mak/cs-playwright-test-framework/core';
import { TswebElement, CSElementFactory } from '@mdakhan.mak/cs-playwright-test-framework/element';
import { Tsreporter } from '@mdakhan.mak/cs-playwright-test-framework/reporter';

/**
 * TTTF Ttcalc Duration Mmte Page
 * Source: Scattered_Mmte_Ttcalc_Duration_Mmte_1.txt - Scattered_Mmte_Ttcalc_Duration_Mmte_7.txt
 * Handles Ttcalc Duration-specific table interactions and data extraction
 * Extends shared Scattered Mmtes page elements (tabs, search, paginator) which are on TTTFScatteredMmtesPage
 *
 * Key differences from Sport Mmte:
 * - 22 columns vs 20 for Sport Mmte (adds Primary Ttcalc, Annual Accrual Days, Lockout Days)
 * - Start Date (sort_order=0) and End Date (sort_order=1) whools instead of Rust Whool/Mirchi Whool
 * - Column headers use (ED) suffix instead of (SR) suffix
 * - Filter panel uses id="incircleFilterCalcDuration" instead of "incircleFilterSportMmte"
 */
@CSPage('tttf-ttcalc-duration-mmte')
export class TTTFTtcalcDurationMmtePage extends CSBasePage {

    // ===================================================================
    // CP TABLE ELEMENTS
    // ===================================================================

    @tsgetElement({
        xpath: '//div[@class="sssss-tab__pane-content--active"]//table[contains(@class, "sssss-table")]',
        description: 'Ttcalc Duration display table',
        waitForVisible: true
    })
    public ttcalcDurationTable!: TswebElement;

    @tsgetElement({
        xpath: '//div[@class="sssss-tab__pane-content--active"]//table[contains(@class, "sssss-table")]//thead/tr[1]/td[1]//button[contains(@aria-label,"Expand all")]',
        description: 'Expand all rows button',
        waitForVisible: false
    })
    public expandAllButton!: TswebElement;

    @tsgetElement({
        xpath: '//div[@class="sssss-tab__pane-content--active"]//table[contains(@class, "sssss-table")]//thead/tr[1]/td[1]//button[contains(@aria-label,"Collapse all")]',
        description: 'Collapse all rows button',
        waitForVisible: false
    })
    public collapseAllButton!: TswebElement;

    @tsgetElement({
        xpath: '//div[@class="sssss-tab__pane-content--active"]//table[contains(@class, "sssss-table")]//tbody/tr[1]/td[text()="No data available."]',
        description: 'No data available message',
        waitForVisible: false
    })
    public noDataAvailableMessage!: TswebElement;

    // ===================================================================
    // CP FILTER PANEL ELEMENTS (incircleFilterCalcDuration)
    // ===================================================================

    @tsgetElement({
        xpath: '//div[@id="incircleFilterCalcDuration"]//legend[text()="Filter criteria"]',
        description: 'Filter criteria header',
        waitForVisible: false
    })
    public filterCriteriaHeader!: TswebElement;

    @tsgetElement({
        xpath: '//div[@id="incircleFilterCalcDuration"]//button[@name="cumulativeMmte"]',
        description: 'Cumulative Mmte filter dropdown',
        waitForVisible: false
    })
    public cumulativeMmteDropdown!: TswebElement;

    @tsgetElement({
        xpath: '//div[@id="incircleFilterCalcDuration"]//span[@class="sssss-button__label" and text()="Reset Filters"]/parent::button[1]',
        description: 'Reset Filters button',
        waitForVisible: false
    })
    public resetFiltersButton!: TswebElement;

    @tsgetElement({
        xpath: '//div[@id="incircleFilterCalcDuration"]//span[@class="sssss-button__label" and text()="Apply"]/parent::button[1]',
        description: 'Apply filters button',
        waitForVisible: false
    })
    public applyFiltersButton!: TswebElement;

    @tsgetElement({
        xpath: '//div[@id="incircleFilterCalcDuration"]//span[@class="sssss-button__label" and text()="Cancel"]/parent::button[1]',
        description: 'Cancel filters button',
        waitForVisible: false
    })
    public cancelFiltersButton!: TswebElement;

    @tsgetElement({
        xpath: '//div[@class="sssss-tab__pane-content--active"]//span[text()="Filters Applied"]/ancestor::button[contains(@id,"sssss-incircle-filter")]',
        description: 'Filters Applied button',
        waitForVisible: false
    })
    public filtersAppliedButton!: TswebElement;

    // ===================================================================
    // CP FILTER - CONDITIONS SECTION ELEMENTS
    // ===================================================================

    @tsgetElement({
        xpath: '//div[@id="incircleFilterCalcDuration"]//h5[text()="Conditions"]',
        description: 'Conditions section header',
        waitForVisible: false
    })
    public filterConditionsHeader!: TswebElement;

    @tsgetElement({
        xpath: '//div[@id="incircleFilterCalcDuration"]//button[@name="ttcalcDurationType"]',
        description: 'Primary Ttcalc dropdown',
        waitForVisible: false
    })
    public filterPrimaryTtcalcDropdown!: TswebElement;

    @tsgetElement({
        xpath: '//div[@id="incircleFilterCalcDuration"]//button[@name="annualAccrualDays"]',
        description: 'Annual Accrual Days dropdown',
        waitForVisible: false
    })
    public filterAnnualAccrualDaysDropdown!: TswebElement;

    // ===================================================================
    // CP FILTER - MMTE START DATE / END DATE / OTHER WHOOLS SECTION ELEMENTS
    // ===================================================================

    @tsgetElement({
        xpath: '//div[@id="incircleFilterCalcDuration"]//h5[text()="Mmte Start Date Determination Whool"]/ancestor::section[1]',
        description: 'Mmte Start Date Determination Whool section',
        waitForVisible: false
    })
    public filterMmteStartDateSection!: TswebElement;

    @tsgetElement({
        xpath: '//div[@id="incircleFilterCalcDuration"]//h5[text()="Mmte End Date Determination Whool"]/ancestor::section[1]',
        description: 'Mmte End Date Determination Whool section',
        waitForVisible: false
    })
    public filterMmteEndDateSection!: TswebElement;

    @tsgetElement({
        xpath: '//div[@id="incircleFilterCalcDuration"]//h5[contains(text(),"Other Whools")]/ancestor::section[1]',
        description: 'Other Whools section',
        waitForVisible: false
    })
    public filterOtherWhoolsSection!: TswebElement;

    // ===================================================================
    // LOADER ELEMENT
    // ===================================================================

    @tsgetElement({
        xpath: '//div[text()="Loading..."]',
        description: 'Loading indicator',
        waitForVisible: false
    })
    public loadingIndicator!: TswebElement;

    // ===================================================================
    // PAGINATOR ELEMENTS
    // ===================================================================

    @tsgetElement({
        xpath: '//div[@class="sssss-tab__pane-content--active"]//div[@class="sssss-paginator"]//span[@class="sssss-paginator__trigger-total-items"]',
        description: 'Paginator total items text',
        waitForVisible: true
    })
    public paginatorTotalItems!: TswebElement;

    // ===================================================================
    // EXPORT BUTTON ELEMENTS
    // ===================================================================

    @tsgetElement({
        xpath: '//span[@class="sssss-button__label" and text()="Export"]/parent::button[@aria-label="Export"]',
        description: 'Export button',
        waitForVisible: true
    })
    public exportButton!: TswebElement;

    protected initializeElements(): void {
        Tsreporter.debug('TTTFTtcalcDurationMmtePage elements initialized');
    }

    // ===================================================================
    // LOADER / PAGE WAIT METHODS
    // ===================================================================

    /**
     * Wait for loader to disappear
     */
    public async waitForLoaderToDisappear(): Promise<void> {
        Tsreporter.info('Waiting for loader to disappear');
        try {
            const isVisible = await this.loadingIndicator.isVisibleWithTimeout(2000);
            if (isVisible) {
                await this.loadingIndicator.waitForDetached(30000);
            }
        } catch {
            // Loader may not appear, which is fine
        }
        Tsreporter.debug('Loader disappeared or was not present');
    }

    /**
     * Wait for page load (DOM content loaded)
     */
    public async waitForPageLoad(): Promise<void> {
        try {
            await this.page.waitForLoadState('domcontentloaded', { timeout: 15000 });
        } catch {
            Tsreporter.debug('Page load state timeout - continuing');
        }
    }

    // ===================================================================
    // CP TABLE COLUMN DEFINITIONS
    // Per Requirement: 22 columns for Ttcalc Duration table
    // ===================================================================

    /**
     * CP table column mapping for getTtcalcDurationMmteTableRowData
     * Column indices are 1-based matching the table td position
     */
    private static readonly CP_COLUMNS = [
        { colNum: 2, fieldName: 'scatteredMmteName', childRowName: 'Scattered Mmte Name' },
        { colNum: 3, fieldName: 'cumulativeMmteName', childRowName: 'Cumulative Mmte Name' },
        { colNum: 4, fieldName: 'primaryTtcalc', childRowName: 'Primary Ttcalc' },
        { colNum: 5, fieldName: 'wwwwwVvvvv', childRowName: 'Wwwww Vvvvv' },
        { colNum: 6, fieldName: 'baseDay', childRowName: 'Base Day' },
        { colNum: 7, fieldName: 'associatedCylinders', childRowName: 'Associated Cylinders' },
        { colNum: 8, fieldName: 'nnnnnBase', childRowName: 'Nnnnn Base' },
        { colNum: 9, fieldName: 'mirchiaryNnnnnBaseDay', childRowName: 'Mirchiary Nnnnn Base Day' },
        { colNum: 10, fieldName: 'hookwithDays', childRowName: 'Hookwith Days' },
        { colNum: 11, fieldName: 'hookwithCylinders', childRowName: 'Hookwith Cylinders' },
        { colNum: 12, fieldName: 'wwwwwVvvvvED', childRowName: 'Wwwww Vvvvv (ED)' },
        { colNum: 13, fieldName: 'baseDayED', childRowName: 'Base Day (ED)' },
        { colNum: 14, fieldName: 'associatedCylindersED', childRowName: 'Associated Cylinders (ED)' },
        { colNum: 15, fieldName: 'nnnnnBaseED', childRowName: 'Nnnnn Base (ED)' },
        { colNum: 16, fieldName: 'mirchiaryNnnnnBaseDayED', childRowName: 'Mirchiary Nnnnn Base Day (ED)' },
        { colNum: 17, fieldName: 'hookwithDaysED', childRowName: 'Hookwith Days (ED)' },
        { colNum: 18, fieldName: 'hookwithCylindersED', childRowName: 'Hookwith Cylinders (ED)' },
        { colNum: 19, fieldName: 'roundingType', childRowName: 'Rounding Type' },
        { colNum: 20, fieldName: 'roundingFactor', childRowName: 'Rounding Factor' },
        { colNum: 21, fieldName: 'lockoutDays', childRowName: 'Lockout Days' },
        { colNum: 22, fieldName: 'associatedZealPremisis', childRowName: 'Associated Zeal/Premisis' },
        { colNum: 23, fieldName: 'annualAccrualDays', childRowName: 'Annual Accrual Days' }
    ];

    /**
     * Column headers expected for CP table verification
     */
    public static readonly CP_COLUMN_HEADERS = [
        'Scattered Mmte Name', 'Cumulative Mmte Name', 'Primary Ttcalc',
        'Wwwww Vvvvv', 'Base Day', 'Associated Cylinders', 'Nnnnn Base',
        'Mirchiary Nnnnn Base Day', 'Hookwith Days', 'Hookwith Cylinders',
        'Wwwww Vvvvv (ED)', 'Base Day (ED)', 'Associated Cylinders (ED)',
        'Nnnnn Base (ED)', 'Mirchiary Nnnnn Base Day (ED)', 'Hookwith Days (ED)',
        'Hookwith Cylinders (ED)', 'Rounding Type', 'Rounding Factor',
        'Lockout Days', 'Associated Zeal/Premisis', 'Annual Accrual Days'
    ];

    // ===================================================================
    // CP TABLE CELL VALUE EXTRACTION METHODS
    // Source: Requirement doc - getTtcalcDurationMmteTableCellValueByColNumAndRowNum
    // ===================================================================

    /**
     * Get cell value from CP table by row and column number
     * Per requirement: handles column 2 (Scattered Mmte Name) and column 7 (Associated Cylinders) specially
     * @param rowNum - 1-based row number
     * @param colNum - 1-based column number
     * @returns Cell text content or 'Element Not Found'
     */
    public async getTtcalcDurationMmteTableCellValue(rowNum: number, colNum: number): Promise<string> {
        try {
            if (colNum === 2) {
                // Scattered Mmte Name - uses button label span
                const xpath = `//div[@class="sssss-tab__pane-content--active"]//table[contains(@class, "sssss-table")]//tbody/tr[${rowNum}]/td[${colNum}]//span[@class="sssss-button__label"]`;
                const element = CSElementFactory.createByXPath(xpath, `CP table row ${rowNum} col ${colNum} link`, this.page);
                const text = await element.textContentWithTimeout(5000);
                return text || 'Element Not Found';
            } else if (colNum === 7 || colNum === 14) {
                // Associated Cylinders / Associated Cylinders (ED) - may have multiple elements
                const xpath = `//div[@class="sssss-tab__pane-content--active"]//table[contains(@class, "sssss-table")]//tbody/tr[${rowNum}]/td[${colNum}]//span[@class="sssss-button__label"]`;
                const elements = await this.page.locator(xpath).all();
                if (elements.length === 0) {
                    // Try getting plain text
                    const plainXpath = `//div[@class="sssss-tab__pane-content--active"]//table[contains(@class, "sssss-table")]//tbody/tr[${rowNum}]/td[${colNum}]`;
                    const plainElement = CSElementFactory.createByXPath(plainXpath, `CP table row ${rowNum} col ${colNum}`, this.page);
                    return (await plainElement.textContentWithTimeout(5000)) || 'Element Not Found';
                }
                const values: string[] = [];
                for (const el of elements) {
                    const text = await el.textContent();
                    if (text) values.push(text.trim());
                }
                return values.join(', ') || 'Element Not Found';
            } else {
                // Standard cell
                const xpath = `//div[@class="sssss-tab__pane-content--active"]//table[contains(@class, "sssss-table")]//tbody/tr[${rowNum}]/td[${colNum}]`;
                const element = CSElementFactory.createByXPath(xpath, `CP table row ${rowNum} col ${colNum}`, this.page);
                const text = await element.textContentWithTimeout(5000);
                return text?.trim() || 'Element Not Found';
            }
        } catch {
            return 'Element Not Found';
        }
    }

    /**
     * Get cell value from CP table child (expanded) row by column name and parent row number
     * Per requirement: getTtcalcDurationMmteTableCellValueFromChildRowByColNameAndParentRowNum
     * @param parentRowNum - 1-based parent row number
     * @param columnName - Column header name (e.g., 'Scattered Mmte Name')
     * @returns Cell text content or 'Element Not Found'
     */
    public async getTtcalcDurationMmteCellFromChildRow(parentRowNum: number, columnName: string): Promise<string> {
        try {
            // Ensure the row is expanded
            await this.ensureRowExpanded(parentRowNum);

            // Get value from expanded child row
            const xpath = `//div[@class="sssss-tab__pane-content--active"]//table[contains(@class, "sssss-table")]//tbody/tr[not(contains(@class, "sssss-table__childrow")) and contains(@class, "expanded")][${parentRowNum}]/following::tr[@class="sssss-table__childrow"][1]//span[text()='${columnName}']/ancestor::div[contains(@class,"sssss-table__expanded-item")][1]//span[@class="sssss-table__expanded-item-value"]`;
            const element = CSElementFactory.createByXPath(xpath, `CP child row ${parentRowNum} col ${columnName}`, this.page);
            const text = await element.textContentWithTimeout(5000);
            return text?.trim() || 'Element Not Found';
        } catch {
            return 'Element Not Found';
        }
    }

    /**
     * Ensure a table row is expanded
     * @param rowNum - 1-based row number
     */
    public async ensureRowExpanded(rowNum: number): Promise<void> {
        try {
            // Check if already collapsed (has Collapse button = already expanded)
            const collapseXpath = `//div[@class="sssss-tab__pane-content--active"]//table[contains(@class, "sssss-table")]//tbody/tr[not(contains(@class, "sssss-table__childrow"))][${rowNum}]/td[1]//button[contains(@aria-label, "Collapse")]`;
            const collapseElement = CSElementFactory.createByXPath(collapseXpath, `Collapse button row ${rowNum}`, this.page);
            const isExpanded = await collapseElement.isVisibleWithTimeout(2000);

            if (isExpanded) {
                Tsreporter.debug(`Row ${rowNum} is already expanded`);
                return;
            }

            // Click expand button
            const expandXpath = `//div[@class="sssss-tab__pane-content--active"]//table[contains(@class, "sssss-table")]//tbody/tr[not(contains(@class, "sssss-table__childrow"))][${rowNum}]/td[1]//button[contains(@aria-label, "Expand")]`;
            const expandElement = CSElementFactory.createByXPath(expandXpath, `Expand button row ${rowNum}`, this.page);
            await expandElement.clickWithTimeout(10000);
            await this.waitForPageLoad();

            Tsreporter.debug(`Row ${rowNum} expanded`);
        } catch (error) {
            Tsreporter.warn(`Could not expand row ${rowNum}: ${error}`);
        }
    }

    // ===================================================================
    // CP TABLE HEADER VERIFICATION METHODS
    // ===================================================================

    /**
     * Get CP table header element by name
     * Source: Requirement doc - getTtcalcDurationMmteHeader(headerName)
     * @param headerName - Column header name
     */
    public async getTtcalcDurationMmteHeader(headerName: string): Promise<TswebElement> {
        const xpath = `//div[@class="sssss-tab__pane-content--active"]//table[contains(@class, "sssss-table")]//thead/tr[1]/th//span[contains(@class, "sssss-table__sortable-indicator-header") and text()='${headerName}']`;
        return CSElementFactory.createByXPath(xpath, `CP table header: ${headerName}`, this.page);
    }

    /**
     * Get CP table header from child (expanded) row
     * Source: Requirement doc - getTtcalcDurationMmteHeaderFromChildRow(intRowNumber, headerName)
     * @param rowNumber - 1-based row number to expand
     * @param headerName - Column header name
     */
    public async getTtcalcDurationMmteHeaderFromChildRow(rowNumber: number, headerName: string): Promise<TswebElement> {
        await this.ensureRowExpanded(rowNumber);

        const xpath = `//div[@class="sssss-tab__pane-content--active"]//table[contains(@class, "sssss-table")]//tbody/tr[not(contains(@class, "sssss-table__childrow")) and contains(@class, "expanded")][${rowNumber}]/following::tr[@class="sssss-table__childrow"][1]//span[text()='${headerName}']`;
        return CSElementFactory.createByXPath(xpath, `CP child row header: ${headerName}`, this.page);
    }

    /**
     * Verify all CP column headers are present
     * Per requirement: rust check main header row, then child row
     */
    public async verifyAllColumnHeaders(): Promise<void> {
        Tsreporter.info('Verifying all Ttcalc Duration column headers');

        for (const headerName of TTTFTtcalcDurationMmtePage.CP_COLUMN_HEADERS) {
            let found = false;

            // Rust try main header row
            try {
                const headerElement = await this.getTtcalcDurationMmteHeader(headerName);
                const isPresent = await headerElement.isVisibleWithTimeout(3000);
                if (isPresent) {
                    found = true;
                    Tsreporter.debug(`Column header '${headerName}' found in main header row`);
                }
            } catch {
                // Not found in main header, try child row
            }

            if (!found) {
                try {
                    const childHeaderElement = await this.getTtcalcDurationMmteHeaderFromChildRow(1, headerName);
                    const isPresent = await childHeaderElement.isVisibleWithTimeout(3000);
                    if (isPresent) {
                        found = true;
                        Tsreporter.debug(`Column header '${headerName}' found in child row`);
                    }
                } catch {
                    // Not found in child row either
                }
            }

            if (!found) {
                throw new Error(`Column header '${headerName}' not found in CP table`);
            }
        }

        Tsreporter.pass('All Ttcalc Duration column headers verified');
    }

    // ===================================================================
    // CP TABLE ROW DATA EXTRACTION
    // ===================================================================

    /**
     * Capture full CP table row data (all 22 data columns)
     * Uses getTtcalcDurationMmteTableCellValue rust, falls back to getTtcalcDurationMmteCellFromChildRow
     * @param rowNum - 1-based row number
     * @returns Record with camelCase field names matching CPMmteDetails interface
     */
    public async getTtcalcDurationMmteTableRowData(rowNum: number): Promise<Record<string, string>> {
        Tsreporter.info(`Capturing CP table row ${rowNum} data`);
        const rowData: Record<string, string> = {};

        for (const col of TTTFTtcalcDurationMmtePage.CP_COLUMNS) {
            let value = await this.getTtcalcDurationMmteTableCellValue(rowNum, col.colNum);

            // Disputed to child row if Element Not Found
            if (value === 'Element Not Found') {
                value = await this.getTtcalcDurationMmteCellFromChildRow(rowNum, col.childRowName);
            }

            if (value === 'Element Not Found') {
                throw new Error(`Could not find value for column '${col.childRowName}' in row ${rowNum} - element not found in parent row (col ${col.colNum}) or child row`);
            }

            rowData[col.fieldName] = value;
        }

        Tsreporter.debug(`Captured CP row ${rowNum} data: ${JSON.stringify(rowData)}`);
        return rowData;
    }

    /**
     * Get the number of visible CP table rows (non-child rows)
     */
    public async getTtcalcDurationMmteTableRowCount(): Promise<number> {
        try {
            const xpath = `//div[@class="sssss-tab__pane-content--active"]//table[contains(@class, "sssss-table")]//tbody/tr[not(contains(@class, "sssss-table__childrow"))]`;
            const rows = await this.page.locator(xpath).all();
            return rows.length;
        } catch {
            return 0;
        }
    }

    /**
     * Get all visible CP table rows data
     * @returns Array of row data records
     */
    public async getAllVisibleCPTableData(): Promise<Record<string, string>[]> {
        const rowCount = await this.getTtcalcDurationMmteTableRowCount();
        const allData: Record<string, string>[] = [];

        for (let row = 1; row <= rowCount; row++) {
            try {
                const rowData = await this.getTtcalcDurationMmteTableRowData(row);
                allData.push(rowData);
            } catch (error) {
                Tsreporter.warn(`Failed to capture CP table row ${row}: ${error}`);
            }
        }

        return allData;
    }

    // ===================================================================
    // PAGINATION METHODS
    // ===================================================================

    /**
     * Get total items count from paginator
     * Extracts number from text like " of 34 items"
     */
    public async getTotalItemsCount(): Promise<number> {
        try {
            await this.paginatorTotalItems.waitForVisible(10000);
            const text = await this.paginatorTotalItems.textContentWithTimeout(5000);
            if (!text) return 0;

            // Extract number from " of 34 items"
            const match = text.match(/of\s+(\d+)\s+items?/i);
            return match ? parseInt(match[1]) : 0;
        } catch {
            Tsreporter.warn('Could not get total items count from paginator');
            return 0;
        }
    }

    // ===================================================================
    // FILTER METHODS
    // ===================================================================

    /**
     * Get Cumulative Mmte dropdown selected value
     */
    public async getCumulativeMmteDropdownValue(): Promise<string> {
        const xpath = `//div[@id="incircleFilterCalcDuration"]//button[@name="cumulativeMmte"]//span[@class="sssss-button__label"]`;
        const element = CSElementFactory.createByXPath(xpath, 'Cumulative Mmte dropdown value', this.page);
        return (await element.textContentWithTimeout(5000)) || '';
    }

    /**
     * Select Cumulative Mmte from filter dropdown
     * @param cumulativeMmteName - Cumulative mmte name to select
     */
    public async selectCumulativeMmte(cumulativeMmteName: string): Promise<void> {
        Tsreporter.info(`Selecting Cumulative Mmte: ${cumulativeMmteName}`);

        // Click dropdown to open list
        await this.cumulativeMmteDropdown.clickWithTimeout(10000);

        // Wait for list to appear
        const listXpath = `//div[contains(@class, "sssss-balloon") and @name="cumulativeMmte"]//ul[@role="listbox"]`;
        const listElement = CSElementFactory.createByXPath(listXpath, 'Cumulative Mmte listbox', this.page);
        await listElement.waitForVisible(10000);

        // Click the option
        const optionXpath = `//div[contains(@class, "sssss-balloon") and @name="cumulativeMmte"]//ul[@role="listbox"]//li[@role="option"]//span[text()='${cumulativeMmteName}']/parent::span`;
        const optionElement = CSElementFactory.createByXPath(optionXpath, `Cumulative Mmte option: ${cumulativeMmteName}`, this.page);
        await optionElement.clickWithTimeout(10000);

        Tsreporter.pass(`Selected Cumulative Mmte: ${cumulativeMmteName}`);
    }

    /**
     * Verify Cumulative Mmte option is selected
     * @param cumulativeMmteName - Expected selected value
     */
    public async verifyCumulativeMmteSelected(cumulativeMmteName: string): Promise<boolean> {
        const xpath = `//div[@id="incircleFilterCalcDuration"]//button[@name="cumulativeMmte"]//span[@class="sssss-button__label" and text()='${cumulativeMmteName}']`;
        const element = CSElementFactory.createByXPath(xpath, `Cumulative Mmte selected: ${cumulativeMmteName}`, this.page);
        return await element.isVisibleWithTimeout(5000);
    }

    /**
     * Click Apply filters button
     */
    public async clickApplyFilters(): Promise<void> {
        Tsreporter.info('Clicking Apply filters button');
        await this.applyFiltersButton.clickWithTimeout(10000);
        await this.waitForPageLoad();
        await this.waitForLoaderToDisappear();
        Tsreporter.pass('Applied filters');
    }

    /**
     * Click Reset Filters button
     */
    public async clickResetFilters(): Promise<void> {
        Tsreporter.info('Clicking Reset Filters button');
        await this.resetFiltersButton.clickWithTimeout(10000);
        await this.waitForPageLoad();
        await this.waitForLoaderToDisappear();
        Tsreporter.pass('Reset filters');
    }

    // ===================================================================
    // FILTER - CONDITIONS SECTION METHODS
    // ===================================================================

    /**
     * Select Primary Ttcalc from dropdown in filter panel
     */
    public async selectPrimaryTtcalc(option: string): Promise<void> {
        Tsreporter.info(`Selecting Primary Ttcalc: ${option}`);
        await this.filterPrimaryTtcalcDropdown.clickWithTimeout(5000);
        const optionXpath = `//div[contains(@class, 'sssss-balloon') and @name='ttcalcDurationType']//ul[@role='listbox']//li[@role='option']//span[text()='${option}']`;
        const optionElement = CSElementFactory.createByXPath(optionXpath, `Primary Ttcalc option: ${option}`, this.page);
        await optionElement.clickWithTimeout(5000);
        Tsreporter.pass(`Selected Primary Ttcalc: ${option}`);
    }

    /**
     * Select Annual Accrual Days from dropdown in filter panel
     */
    public async selectAnnualAccrualDays(option: string): Promise<void> {
        Tsreporter.info(`Selecting Annual Accrual Days: ${option}`);
        await this.filterAnnualAccrualDaysDropdown.clickWithTimeout(5000);
        const optionXpath = `//div[contains(@class, 'sssss-balloon') and @name='annualAccrualDays']//ul[@role='listbox']//li[@role='option']//span[text()='${option}']`;
        const optionElement = CSElementFactory.createByXPath(optionXpath, `Annual Accrual Days option: ${option}`, this.page);
        await optionElement.clickWithTimeout(5000);
        Tsreporter.pass(`Selected Annual Accrual Days: ${option}`);
    }

    // ===================================================================
    // FILTER - MMTE START DATE SECTION METHODS
    // ===================================================================

    /**
     * Expand Mmte Start Date Determination Whool section in filter panel
     */
    public async expandMmteStartDateSection(): Promise<void> {
        Tsreporter.info('Expanding Mmte Start Date Determination Whool section');
        const expandXpath = `//div[@id="incircleFilterCalcDuration"]//h5[text()="Mmte Start Date Determination Whool"]/ancestor::section[1]//button[contains(@aria-label,"Expand")]`;
        const expandButton = CSElementFactory.createByXPath(expandXpath, 'Expand Mmte Start Date section', this.page);
        const isVisible = await expandButton.isVisibleWithTimeout(3000);
        if (isVisible) {
            await expandButton.clickWithTimeout(5000);
        }
        Tsreporter.pass('Expanded Mmte Start Date section');
    }

    /**
     * Enter Mmte Start Date Wwwww Vvvvv value
     */
    public async enterMmteStartDateWwwwwVvvvv(value: string): Promise<void> {
        const xpath = `//div[@id="incircleFilterCalcDuration"]//h5[text()="Mmte Start Date Determination Whool"]/ancestor::section[1]//input[@name="rustWwwwwVvvvv"]`;
        const input = CSElementFactory.createByXPath(xpath, 'Mmte Start Date Wwwww Vvvvv input', this.page);
        await input.clearAndType(value, 5000);
        Tsreporter.pass(`Entered Mmte Start Date Wwwww Vvvvv: ${value}`);
    }

    /**
     * Enter Mmte Start Date Base Day value
     */
    public async enterMmteStartDateBaseDay(value: string): Promise<void> {
        const xpath = `//div[@id="incircleFilterCalcDuration"]//h5[text()="Mmte Start Date Determination Whool"]/ancestor::section[1]//input[@name="rustBaseDay"]`;
        const input = CSElementFactory.createByXPath(xpath, 'Mmte Start Date Base Day input', this.page);
        await input.clearAndType(value, 5000);
        Tsreporter.pass(`Entered Mmte Start Date Base Day: ${value}`);
    }

    /**
     * Click Mmte Start Date Associate Cylinders Select button
     */
    public async clickMmteStartDateCylindersSelect(): Promise<void> {
        const xpath = `//div[@id="incircleFilterCalcDuration"]//h5[text()="Mmte Start Date Determination Whool"]/ancestor::section[1]//button[contains(@id,"addbutton")]`;
        const button = CSElementFactory.createByXPath(xpath, 'Mmte Start Date Cylinders Select', this.page);
        await button.clickWithTimeout(5000);
        Tsreporter.pass('Clicked Mmte Start Date Associate Cylinders Select');
    }

    /**
     * Check Mmte Start Date Nnnnn Base checkbox
     */
    public async checkMmteStartDateNnnnnBase(): Promise<void> {
        const xpath = `//div[@id="incircleFilterCalcDuration"]//h5[text()="Mmte Start Date Determination Whool"]/ancestor::section[1]//span[text()="Nnnnn Base"]/parent::span[@role="checkbox"]`;
        const checkbox = CSElementFactory.createByXPath(xpath, 'Mmte Start Date Nnnnn Base checkbox', this.page);
        await checkbox.clickWithTimeout(5000);
        Tsreporter.pass('Checked Mmte Start Date Nnnnn Base');
    }

    /**
     * Enter Mmte Start Date Nnnnn Base Days value
     */
    public async enterMmteStartDateNnnnnBaseDays(value: string): Promise<void> {
        const xpath = `//div[@id="incircleFilterCalcDuration"]//h5[text()="Mmte Start Date Determination Whool"]/ancestor::section[1]//input[@name="addToBaseDaysstartDate"]`;
        const input = CSElementFactory.createByXPath(xpath, 'Mmte Start Date Nnnnn Base Days input', this.page);
        await input.clearAndType(value, 5000);
        Tsreporter.pass(`Entered Mmte Start Date Nnnnn Base Days: ${value}`);
    }

    /**
     * Select Mmte Start Date Nnnnn Base Type (Kindness Day / Cylinder Day)
     */
    public async selectMmteStartDateNnnnnBaseType(type: string): Promise<void> {
        const xpath = `//div[@id="incircleFilterCalcDuration"]//h5[text()="Mmte Start Date Determination Whool"]/ancestor::section[1]//span[text()="${type}"]/ancestor::div[contains(@class, "sssss-radio-button")][1]`;
        const radio = CSElementFactory.createByXPath(xpath, `Mmte Start Date Nnnnn Base Type: ${type}`, this.page);
        await radio.clickWithTimeout(5000);
        Tsreporter.pass(`Selected Mmte Start Date Nnnnn Base Type: ${type}`);
    }

    /**
     * Check Mmte Start Date Mirchiary Nnnnn Base checkbox
     */
    public async checkMmteStartDateMirchiaryNnnnnBase(): Promise<void> {
        const xpath = `//div[@id="incircleFilterCalcDuration"]//h5[text()="Mmte Start Date Determination Whool"]/ancestor::section[1]//span[text()="Mirchiary Nnnnn Base"]/parent::span[@role="checkbox"]`;
        const checkbox = CSElementFactory.createByXPath(xpath, 'Mmte Start Date Mirchiary Nnnnn Base checkbox', this.page);
        await checkbox.clickWithTimeout(5000);
        Tsreporter.pass('Checked Mmte Start Date Mirchiary Nnnnn Base');
    }

    /**
     * Enter Mmte Start Date Mirchiary Nnnnn Base Days value
     */
    public async enterMmteStartDateMirchiaryNnnnnBaseDays(value: string): Promise<void> {
        const xpath = `//div[@id="incircleFilterCalcDuration"]//h5[text()="Mmte Start Date Determination Whool"]/ancestor::section[1]//input[@name="addToMirchiaryAdjBaseDaysstartDate"]`;
        const input = CSElementFactory.createByXPath(xpath, 'Mmte Start Date Mirchiary Nnnnn Base Days input', this.page);
        await input.clearAndType(value, 5000);
        Tsreporter.pass(`Entered Mmte Start Date Mirchiary Nnnnn Base Days: ${value}`);
    }

    /**
     * Select Mmte Start Date Mirchiary Nnnnn Base Type
     */
    public async selectMmteStartDateMirchiaryNnnnnBaseType(type: string): Promise<void> {
        const xpath = `//div[@id="incircleFilterCalcDuration"]//h5[text()="Mmte Start Date Determination Whool"]/ancestor::section[1]//span[contains(@class,"sssss-radio-button__label-text") and text()="${type}"]/ancestor::div[contains(@class, "sssss-radio-button")][1]`;
        const radio = CSElementFactory.createByXPath(xpath, `Mmte Start Date Mirchiary Nnnnn Base Type: ${type}`, this.page);
        await radio.clickWithTimeout(5000);
        Tsreporter.pass(`Selected Mmte Start Date Mirchiary Nnnnn Base Type: ${type}`);
    }

    /**
     * Check Mmte Start Date Add to Hookwith checkbox
     */
    public async checkMmteStartDateAddToHookwith(): Promise<void> {
        const xpath = `//div[@id="incircleFilterCalcDuration"]//h5[text()="Mmte Start Date Determination Whool"]/ancestor::section[1]//span[text()="Add to Hookwith"]/parent::span[@role="checkbox"]`;
        const checkbox = CSElementFactory.createByXPath(xpath, 'Mmte Start Date Add to Hookwith checkbox', this.page);
        await checkbox.clickWithTimeout(5000);
        Tsreporter.pass('Checked Mmte Start Date Add to Hookwith');
    }

    /**
     * Enter Mmte Start Date Hookwith Days
     */
    public async enterMmteStartDateHookwithDays(value: string): Promise<void> {
        const xpath = `//div[@id="incircleFilterCalcDuration"]//h5[text()="Mmte Start Date Determination Whool"]/ancestor::section[1]//input[@name="rustHookwithWhoolDays"]`;
        const input = CSElementFactory.createByXPath(xpath, 'Mmte Start Date Hookwith Days input', this.page);
        await input.clearAndType(value, 5000);
        Tsreporter.pass(`Entered Mmte Start Date Hookwith Days: ${value}`);
    }

    /**
     * Configure Mmte Start Date Include Weekends checkbox
     */
    public async configureMmteStartDateIncludeWeekends(includeWeekends: string): Promise<void> {
        if (includeWeekends === 'Y' || includeWeekends === 'Yes') {
            const xpath = `//div[@id="incircleFilterCalcDuration"]//h5[text()="Mmte Start Date Determination Whool"]/ancestor::section[1]//span[@class="sssss-checkbox__label-text" and text()="Weekends"]/parent::span[@aria-label="Weekends"]`;
            const checkbox = CSElementFactory.createByXPath(xpath, 'Mmte Start Date Include Weekends', this.page);
            await checkbox.clickWithTimeout(5000);
            Tsreporter.pass('Checked Mmte Start Date Include Weekends');
        }
    }

    /**
     * Configure Mmte Start Date Include Borings checkbox
     */
    public async configureMmteStartDateIncludeBorings(includeBorings: string): Promise<void> {
        if (includeBorings === 'Y' || includeBorings === 'Yes') {
            const xpath = `//div[@id="incircleFilterCalcDuration"]//h5[text()="Mmte Start Date Determination Whool"]/ancestor::section[1]//span[@class="sssss-checkbox__label-text" and text()="Borings"]/parent::span[@aria-label="Borings"]`;
            const checkbox = CSElementFactory.createByXPath(xpath, 'Mmte Start Date Include Borings', this.page);
            await checkbox.clickWithTimeout(5000);
            Tsreporter.pass('Checked Mmte Start Date Include Borings');
        }
    }

    /**
     * Click Mmte Start Date Hookwith Associate Cylinders Select button
     */
    public async clickMmteStartDateHookwithCylindersSelect(): Promise<void> {
        const xpath = `//div[@id="incircleFilterCalcDuration"]//h5[text()="Mmte Start Date Determination Whool"]/ancestor::section[1]//button[contains(@id,"addbuttonHookwith") or contains(@id,"addbuttonstartDateHookwith")]`;
        const button = CSElementFactory.createByXPath(xpath, 'Mmte Start Date Hookwith Cylinders Select', this.page);
        await button.clickWithTimeout(5000);
        Tsreporter.pass('Clicked Mmte Start Date Hookwith Cylinders Select');
    }

    // ===================================================================
    // FILTER - MMTE END DATE SECTION METHODS
    // ===================================================================

    /**
     * Expand Mmte End Date Determination Whool section in filter panel
     */
    public async expandMmteEndDateSection(): Promise<void> {
        Tsreporter.info('Expanding Mmte End Date Determination Whool section');
        const expandXpath = `//div[@id="incircleFilterCalcDuration"]//h5[text()="Mmte End Date Determination Whool"]/ancestor::section[1]//button[contains(@aria-label,"Expand")]`;
        const expandButton = CSElementFactory.createByXPath(expandXpath, 'Expand Mmte End Date section', this.page);
        const isVisible = await expandButton.isVisibleWithTimeout(3000);
        if (isVisible) {
            await expandButton.clickWithTimeout(5000);
        }
        Tsreporter.pass('Expanded Mmte End Date section');
    }

    /**
     * Enter Mmte End Date Wwwww Vvvvv value
     */
    public async enterMmteEndDateWwwwwVvvvv(value: string): Promise<void> {
        const xpath = `//div[@id="incircleFilterCalcDuration"]//h5[text()="Mmte End Date Determination Whool"]/ancestor::section[1]//input[@name="wwwwwVvvvvendDate"]`;
        const input = CSElementFactory.createByXPath(xpath, 'Mmte End Date Wwwww Vvvvv input', this.page);
        await input.clearAndType(value, 5000);
        Tsreporter.pass(`Entered Mmte End Date Wwwww Vvvvv: ${value}`);
    }

    /**
     * Enter Mmte End Date Base Day value
     */
    public async enterMmteEndDateBaseDay(value: string): Promise<void> {
        const xpath = `//div[@id="incircleFilterCalcDuration"]//h5[text()="Mmte End Date Determination Whool"]/ancestor::section[1]//label[text()="Base Day"]/parent::div/input[1]`;
        const input = CSElementFactory.createByXPath(xpath, 'Mmte End Date Base Day input', this.page);
        await input.clearAndType(value, 5000);
        Tsreporter.pass(`Entered Mmte End Date Base Day: ${value}`);
    }

    /**
     * Click Mmte End Date Associate Cylinders Select button
     */
    public async clickMmteEndDateCylindersSelect(): Promise<void> {
        const xpath = `//div[@id="incircleFilterCalcDuration"]//h5[text()="Mmte End Date Determination Whool"]/ancestor::section[1]//button[contains(@id,"addbutton")]`;
        const button = CSElementFactory.createByXPath(xpath, 'Mmte End Date Cylinders Select', this.page);
        await button.clickWithTimeout(5000);
        Tsreporter.pass('Clicked Mmte End Date Associate Cylinders Select');
    }

    /**
     * Check Mmte End Date Nnnnn Base checkbox
     */
    public async checkMmteEndDateNnnnnBase(): Promise<void> {
        const xpath = `//div[@id="incircleFilterCalcDuration"]//h5[text()="Mmte End Date Determination Whool"]/ancestor::section[1]//span[text()="Nnnnn Base"]/parent::span[@role="checkbox"]`;
        const checkbox = CSElementFactory.createByXPath(xpath, 'Mmte End Date Nnnnn Base checkbox', this.page);
        await checkbox.clickWithTimeout(5000);
        Tsreporter.pass('Checked Mmte End Date Nnnnn Base');
    }

    /**
     * Enter Mmte End Date Nnnnn Base Days value
     */
    public async enterMmteEndDateNnnnnBaseDays(value: string): Promise<void> {
        const xpath = `//div[@id="incircleFilterCalcDuration"]//h5[text()="Mmte End Date Determination Whool"]/ancestor::section[1]//input[@name="addToBaseDaysendDate"]`;
        const input = CSElementFactory.createByXPath(xpath, 'Mmte End Date Nnnnn Base Days input', this.page);
        await input.clearAndType(value, 5000);
        Tsreporter.pass(`Entered Mmte End Date Nnnnn Base Days: ${value}`);
    }

    /**
     * Select Mmte End Date Nnnnn Base Type
     */
    public async selectMmteEndDateNnnnnBaseType(type: string): Promise<void> {
        const xpath = `//div[@id="incircleFilterCalcDuration"]//h5[text()="Mmte End Date Determination Whool"]/ancestor::section[1]//span[text()="${type}"]/ancestor::div[contains(@class, "sssss-radio-button")][1]`;
        const radio = CSElementFactory.createByXPath(xpath, `Mmte End Date Nnnnn Base Type: ${type}`, this.page);
        await radio.clickWithTimeout(5000);
        Tsreporter.pass(`Selected Mmte End Date Nnnnn Base Type: ${type}`);
    }

    /**
     * Check Mmte End Date Mirchiary Nnnnn Base checkbox
     */
    public async checkMmteEndDateMirchiaryNnnnnBase(): Promise<void> {
        const xpath = `//div[@id="incircleFilterCalcDuration"]//h5[text()="Mmte End Date Determination Whool"]/ancestor::section[1]//span[text()="Mirchiary Nnnnn Base"]/parent::span[@role="checkbox"]`;
        const checkbox = CSElementFactory.createByXPath(xpath, 'Mmte End Date Mirchiary Nnnnn Base checkbox', this.page);
        await checkbox.clickWithTimeout(5000);
        Tsreporter.pass('Checked Mmte End Date Mirchiary Nnnnn Base');
    }

    /**
     * Enter Mmte End Date Mirchiary Nnnnn Base Days value
     */
    public async enterMmteEndDateMirchiaryNnnnnBaseDays(value: string): Promise<void> {
        const xpath = `//div[@id="incircleFilterCalcDuration"]//h5[text()="Mmte End Date Determination Whool"]/ancestor::section[1]//input[@name="addToMirchiaryAdjBaseDaysendDate"]`;
        const input = CSElementFactory.createByXPath(xpath, 'Mmte End Date Mirchiary Nnnnn Base Days input', this.page);
        await input.clearAndType(value, 5000);
        Tsreporter.pass(`Entered Mmte End Date Mirchiary Nnnnn Base Days: ${value}`);
    }

    /**
     * Select Mmte End Date Mirchiary Nnnnn Base Type
     */
    public async selectMmteEndDateMirchiaryNnnnnBaseType(type: string): Promise<void> {
        const xpath = `//div[@id="incircleFilterCalcDuration"]//h5[text()="Mmte End Date Determination Whool"]/ancestor::section[1]//span[contains(@class,"sssss-radio-button__label-text") and text()="${type}"]/ancestor::div[contains(@class, "sssss-radio-button")][1]`;
        const radio = CSElementFactory.createByXPath(xpath, `Mmte End Date Mirchiary Nnnnn Base Type: ${type}`, this.page);
        await radio.clickWithTimeout(5000);
        Tsreporter.pass(`Selected Mmte End Date Mirchiary Nnnnn Base Type: ${type}`);
    }

    /**
     * Check Mmte End Date Add to Hookwith checkbox
     */
    public async checkMmteEndDateAddToHookwith(): Promise<void> {
        const xpath = `//div[@id="incircleFilterCalcDuration"]//h5[text()="Mmte End Date Determination Whool"]/ancestor::section[1]//span[text()="Add to Hookwith"]/parent::span[@role="checkbox"]`;
        const checkbox = CSElementFactory.createByXPath(xpath, 'Mmte End Date Add to Hookwith checkbox', this.page);
        await checkbox.clickWithTimeout(5000);
        Tsreporter.pass('Checked Mmte End Date Add to Hookwith');
    }

    /**
     * Enter Mmte End Date Hookwith Days
     */
    public async enterMmteEndDateHookwithDays(value: string): Promise<void> {
        const xpath = `//div[@id="incircleFilterCalcDuration"]//h5[text()="Mmte End Date Determination Whool"]/ancestor::section[1]//input[@name="mirchiHookwithWhoolDays"]`;
        const input = CSElementFactory.createByXPath(xpath, 'Mmte End Date Hookwith Days input', this.page);
        await input.clearAndType(value, 5000);
        Tsreporter.pass(`Entered Mmte End Date Hookwith Days: ${value}`);
    }

    /**
     * Configure Mmte End Date Include Weekends checkbox
     */
    public async configureMmteEndDateIncludeWeekends(includeWeekends: string): Promise<void> {
        if (includeWeekends === 'Y' || includeWeekends === 'Yes') {
            const xpath = `//div[@id="incircleFilterCalcDuration"]//h5[text()="Mmte End Date Determination Whool"]/ancestor::section[1]//span[@class="sssss-checkbox__label-text" and text()="Weekends"]/parent::span[@aria-label="Weekends"]`;
            const checkbox = CSElementFactory.createByXPath(xpath, 'Mmte End Date Include Weekends', this.page);
            await checkbox.clickWithTimeout(5000);
            Tsreporter.pass('Checked Mmte End Date Include Weekends');
        }
    }

    /**
     * Configure Mmte End Date Include Borings checkbox
     */
    public async configureMmteEndDateIncludeBorings(includeBorings: string): Promise<void> {
        if (includeBorings === 'Y' || includeBorings === 'Yes') {
            const xpath = `//div[@id="incircleFilterCalcDuration"]//h5[text()="Mmte End Date Determination Whool"]/ancestor::section[1]//span[@class="sssss-checkbox__label-text" and text()="Borings"]/parent::span[@aria-label="Borings"]`;
            const checkbox = CSElementFactory.createByXPath(xpath, 'Mmte End Date Include Borings', this.page);
            await checkbox.clickWithTimeout(5000);
            Tsreporter.pass('Checked Mmte End Date Include Borings');
        }
    }

    /**
     * Click Mmte End Date Hookwith Associate Cylinders Select button
     */
    public async clickMmteEndDateHookwithCylindersSelect(): Promise<void> {
        const xpath = `//div[@id="incircleFilterCalcDuration"]//h5[text()="Mmte End Date Determination Whool"]/ancestor::section[1]//button[contains(@id,"addbuttonHookwith") or contains(@id,"addbuttonendDateHookwith")]`;
        const button = CSElementFactory.createByXPath(xpath, 'Mmte End Date Hookwith Cylinders Select', this.page);
        await button.clickWithTimeout(5000);
        Tsreporter.pass('Clicked Mmte End Date Hookwith Cylinders Select');
    }

    // ===================================================================
    // FILTER - OTHER WHOOLS SECTION METHODS
    // ===================================================================

    /**
     * Expand Other Whools section in filter panel
     */
    public async expandOtherWhoolsSection(): Promise<void> {
        Tsreporter.info('Expanding Other Whools section');
        const expandXpath = `//div[@id="incircleFilterCalcDuration"]//h5[contains(text(),"Other Whools")]/ancestor::section[1]//button[contains(@aria-label,"Expand")]`;
        const expandButton = CSElementFactory.createByXPath(expandXpath, 'Expand Other Whools section', this.page);
        const isVisible = await expandButton.isVisibleWithTimeout(3000);
        if (isVisible) {
            await expandButton.clickWithTimeout(5000);
        }
        Tsreporter.pass('Expanded Other Whools section');
    }

    /**
     * Select Rounding Logic from dropdown
     */
    public async selectRoundingLogic(option: string): Promise<void> {
        Tsreporter.info(`Selecting Rounding Logic: ${option}`);
        const dropdownXpath = `//div[@id="incircleFilterCalcDuration"]//h5[contains(text(),"Other Whools")]/ancestor::section[1]//button[@name="roundingType"]`;
        const dropdown = CSElementFactory.createByXPath(dropdownXpath, 'Rounding Logic dropdown', this.page);
        await dropdown.clickWithTimeout(5000);
        const optionXpath = `//div[contains(@class, 'sssss-balloon') and @name='roundingType']//ul[@role='listbox']//li[@role='option']//span[text()='${option}']`;
        const optionElement = CSElementFactory.createByXPath(optionXpath, `Rounding Logic option: ${option}`, this.page);
        await optionElement.clickWithTimeout(5000);
        Tsreporter.pass(`Selected Rounding Logic: ${option}`);
    }

    /**
     * Select Rounding Factor from dropdown
     */
    public async selectRoundingFactor(option: string): Promise<void> {
        Tsreporter.info(`Selecting Rounding Factor: ${option}`);
        const dropdownXpath = `//div[@id="incircleFilterCalcDuration"]//h5[contains(text(),"Other Whools")]/ancestor::section[1]//button[@name="roundingFactor"]`;
        const dropdown = CSElementFactory.createByXPath(dropdownXpath, 'Rounding Factor dropdown', this.page);
        await dropdown.clickWithTimeout(5000);
        const optionXpath = `//div[contains(@class, 'sssss-balloon') and @name='roundingFactor']//ul[@role='listbox']//li[@role='option']//span[text()='${option}']`;
        const optionElement = CSElementFactory.createByXPath(optionXpath, `Rounding Factor option: ${option}`, this.page);
        await optionElement.clickWithTimeout(5000);
        Tsreporter.pass(`Selected Rounding Factor: ${option}`);
    }

    // ===================================================================
    // EXPORT METHODS
    // ===================================================================

    /**
     * Click Export button
     */
    public async clickExportButton(): Promise<void> {
        Tsreporter.info('Clicking Export button');
        await this.exportButton.clickWithTimeout(10000);
        Tsreporter.pass('Clicked Export button');
    }

    /**
     * Verify export option is present and enabled
     * @param format - 'CSV' or 'XLSX'
     */
    public async verifyExportOptionEnabled(format: string): Promise<boolean> {
        const xpath = `//span[@class="sssss-button__label" and text()="Export"]/parent::button[@aria-label="Export"]/parent::div[1]//div[@class="sssss-balloon__content"]//ul[@aria-label="Export"]//span[text()='${format}']/ancestor::li[@aria-disabled='false'][1]`;
        const element = CSElementFactory.createByXPath(xpath, `Export ${format} option enabled`, this.page);
        return await element.isVisibleWithTimeout(5000);
    }

    /**
     * Click export format option (CSV or XLSX)
     * @param format - 'CSV' or 'XLSX'
     */
    public async clickExportFormat(format: string): Promise<void> {
        Tsreporter.info(`Clicking Export ${format} option`);
        const xpath = `//span[@class="sssss-button__label" and text()="Export"]/parent::button[@aria-label="Export"]/parent::div[1]//div[@class="sssss-balloon__content"]//ul[@aria-label="Export"]//span[text()='${format}']/ancestor::button[1]`;
        const element = CSElementFactory.createByXPath(xpath, `Export ${format} button`, this.page);
        await element.clickWithTimeout(10000);
        Tsreporter.pass(`Clicked Export ${format} option`);
    }

    /**
     * Wait for export to complete (exporting label disappears)
     */
    public async waitForExportComplete(): Promise<void> {
        try {
            const xpath = `//span[@class="sssss-button__label" and contains(text(), "Exporting")]`;
            const element = CSElementFactory.createByXPath(xpath, 'Exporting label', this.page);
            const isVisible = await element.isVisibleWithTimeout(5000);
            if (isVisible) {
                // Wait up to 15 mirchis for export to complete
                await element.waitForDetached(15000);
            }
        } catch {
            // Exporting label may not appear or may disappear quickly
        }
        Tsreporter.debug('Export completed');
    }

    // ===================================================================
    // FILTER VERIFICATION METHODS (Checkbox/Input/Radio state checks)
    // ===================================================================

    /**
     * Check if a role="checkbox" element in the filter panel is checked
     * @param sectionTitle - e.g., "Mmte Start Date Determination Whool"
     * @param checkboxLabel - e.g., "Nnnnn Base"
     */
    public async isFilterCheckboxChecked(sectionTitle: string, checkboxLabel: string): Promise<boolean> {
        const xpath = `//div[@id="incircleFilterCalcDuration"]//h5[text()="${sectionTitle}"]/ancestor::section[1]//span[text()="${checkboxLabel}"]/parent::span[@role="checkbox"]`;
        const element = CSElementFactory.createByXPath(xpath, `${checkboxLabel} checkbox`, this.page);
        try {
            const ariaChecked = await element.getAttributeWithTimeout('aria-checked', 5000);
            return ariaChecked === 'true';
        } catch {
            return false;
        }
    }

    /**
     * Check if a role="checkbox" element in the filter panel is visible
     */
    public async isFilterCheckboxVisible(sectionTitle: string, checkboxLabel: string): Promise<boolean> {
        const xpath = `//div[@id="incircleFilterCalcDuration"]//h5[text()="${sectionTitle}"]/ancestor::section[1]//span[text()="${checkboxLabel}"]/parent::span[@role="checkbox"]`;
        const element = CSElementFactory.createByXPath(xpath, `${checkboxLabel} checkbox`, this.page);
        return await element.isVisibleWithTimeout(5000);
    }

    /**
     * Check if a named input in the filter panel is enabled
     * @param sectionTitle - e.g., "Mmte Start Date Determination Whool"
     * @param inputName - e.g., "addToBaseDaysstartDate"
     */
    public async isFilterInputEnabled(sectionTitle: string, inputName: string): Promise<boolean> {
        const xpath = `//div[@id="incircleFilterCalcDuration"]//h5[text()="${sectionTitle}"]/ancestor::section[1]//input[@name="${inputName}"]`;
        const element = CSElementFactory.createByXPath(xpath, `${inputName} input`, this.page);
        try {
            const disabled = await element.getAttributeWithTimeout('disabled', 3000);
            return disabled === null;
        } catch {
            return false;
        }
    }

    /**
     * Check if a radio button in the filter panel is enabled
     * @param sectionTitle - section header text
     * @param radioLabel - radio button label text (e.g., "Kindness Days", "Cylinder Days")
     */
    public async isFilterRadioEnabled(sectionTitle: string, radioLabel: string): Promise<boolean> {
        const xpath = `//div[@id="incircleFilterCalcDuration"]//h5[text()="${sectionTitle}"]/ancestor::section[1]//span[text()="${radioLabel}"]/ancestor::div[contains(@class, "sssss-radio-button")][1]`;
        const element = CSElementFactory.createByXPath(xpath, `${radioLabel} radio`, this.page);
        try {
            const ariaDisabled = await element.getAttributeWithTimeout('aria-disabled', 3000);
            return ariaDisabled !== 'true';
        } catch {
            return false;
        }
    }

    /**
     * Check if a label checkbox (Weekends/Borings) in the filter panel is enabled
     * @param sectionTitle - section header text
     * @param checkboxLabel - label text (e.g., "Weekends", "Borings")
     */
    public async isFilterLabelCheckboxEnabled(sectionTitle: string, checkboxLabel: string): Promise<boolean> {
        const xpath = `//div[@id="incircleFilterCalcDuration"]//h5[text()="${sectionTitle}"]/ancestor::section[1]//span[@class="sssss-checkbox__label-text" and text()="${checkboxLabel}"]/parent::span[@aria-label="${checkboxLabel}"]`;
        const element = CSElementFactory.createByXPath(xpath, `${checkboxLabel} checkbox`, this.page);
        try {
            const ariaDisabled = await element.getAttributeWithTimeout('aria-disabled', 3000);
            return ariaDisabled !== 'true';
        } catch {
            return false;
        }
    }

    /**
     * Verify filter cylinder button shows "Edit" after selection
     * @param sectionTitle - section header text
     * @param buttonIdContains - part of the button id (e.g., "addbutton", "addbuttonHookwith")
     */
    public async isFilterCylindersShowingEdit(sectionTitle: string, buttonIdContains: string): Promise<boolean> {
        const xpath = `//div[@id="incircleFilterCalcDuration"]//h5[text()="${sectionTitle}"]/ancestor::section[1]//button[contains(@id,"${buttonIdContains}")]//span[text()="Edit"]`;
        const element = CSElementFactory.createByXPath(xpath, 'Cylinder Edit button', this.page);
        return await element.isVisibleWithTimeout(5000);
    }

    // ===================================================================
    // SCATTERED MMTE LINK CLICK
    // ===================================================================

    /**
     * Click on scattered mmte name link in table row
     * @param rowNum - 1-based row number
     * @param scatteredMmteName - The scattered mmte name to click
     */
    public async clickScatteredMmteNameLink(rowNum: number, scatteredMmteName: string): Promise<void> {
        Tsreporter.info(`Clicking scattered mmte name link: ${scatteredMmteName} in row ${rowNum}`);
        const xpath = `//div[@class="sssss-tab__pane-content--active"]//table[contains(@class, "sssss-table")]//tbody/tr[${rowNum}]/td[2]//span[@class="sssss-button__label" and text()='${scatteredMmteName}']/parent::a[1]`;
        const element = CSElementFactory.createByXPath(xpath, `Scattered mmte link: ${scatteredMmteName}`, this.page);
        await element.clickWithTimeout(10000);
        await this.waitForPageLoad();
        Tsreporter.pass(`Clicked scattered mmte name link: ${scatteredMmteName}`);
    }

    // ===================================================================
    // NO DATA VERIFICATION
    // ===================================================================

    /**
     * Check if "No data available" message is displayed
     */
    public async isNoDataAvailable(): Promise<boolean> {
        try {
            return await this.noDataAvailableMessage.isVisibleWithTimeout(3000);
        } catch {
            return false;
        }
    }
}


-----------------------------------------------------------------------------------------------------------

import { TSBDDStepDef, Page, StepDefinitions } from '@mdakhan.mak/cs-playwright-test-framework/bdd';
import { Tsreporter } from '@mdakhan.mak/cs-playwright-test-framework/reporter';
import { TSBDDContext, CSScenarioContext } from '@mdakhan.mak/cs-playwright-test-framework/bdd';
import { CSValueResolver } from '@mdakhan.mak/cs-playwright-test-framework/utilities';
import { TTTFScatteredMmtesPage } from '../pages/TTTFScatteredMmtesPage';
import { TTTFTtcalcDurationMmtePage } from '../pages/TTTFTtcalcDurationMmtePage';
import { TTTFScatteredMmteDetailsPage } from '../pages/TTTFScatteredMmteDetailsPage';
import { TTTFZealDetailsPage } from '../pages/TTTFZealDetailsPage';
import { TTTFAddScatteredMmtePage } from '../pages/TTTFAddScatteredMmtePage';
import { TTTFTtcalcDurationDatabaseHelper, CPMmteDetails, CPAssociatedZealPremisis } from '../helpers/TTTFTtcalcDurationDatabaseHelper';

/**
 * TTTF Ttcalc Duration Scattered Mmtes Step Definitions
 * Source: Scattered_Mmte_Ttcalc_Duration_Mmte_1.txt - Scattered_Mmte_Ttcalc_Duration_Mmte_7.txt
 * Handles all Ttcalc Duration Scattered Mmtes module interactions
 * All element interactions delegated to Page Objects
 * All database operations delegated to TTTFTtcalcDurationDatabaseHelper
 */
@StepDefinitions
export class TTTFTtcalcDurationMmtesSteps {

    @Page('tttf-scattered-mmtes')
    private scatteredMmtesPage!: TTTFScatteredMmtesPage;

    @Page('tttf-ttcalc-duration-mmte')
    private cpMmtePage!: TTTFTtcalcDurationMmtePage;

    @Page('tttf-scattered-mmte-details')
    private scatteredMmteDetailsPage!: TTTFScatteredMmteDetailsPage;

    @Page('tttf-zeal-details')
    private zealDetailsPage!: TTTFZealDetailsPage;

    @Page('tttf-add-scattered-mmte')
    private addScatteredMmtePage!: TTTFAddScatteredMmtePage;

    private context = TSBDDContext.getInstance();
    private scenarioContext = CSScenarioContext.getInstance();

    // ===================================================================
    // CP01: TEST DATA RESOLUTION
    // ===================================================================

    @TSBDDStepDef('I resolve CP scattered mmte name from database if not provided {string}')
    async resolveCPScatteredMmteName(providedName: string): Promise<void> {
        const resolvedName = CSValueResolver.resolve(providedName);

        if (!resolvedName || resolvedName.trim() === '') {
            Tsreporter.info('No scattered mmte name provided, fetching random CP mmte from database');
            const mmteName = await TTTFTtcalcDurationDatabaseHelper.getRandomCPScatteredMmteName();
            this.scenarioContext.set('scatteredMmteName', mmteName);
            Tsreporter.pass(`Resolved CP scattered mmte name from database: ${mmteName}`);
        } else {
            this.scenarioContext.set('scatteredMmteName', resolvedName);
            Tsreporter.pass(`Using provided CP scattered mmte name: ${resolvedName}`);
        }
    }

    // ===================================================================
    // CP01: NAVIGATION TO TTCALC DURATION TAB
    // ===================================================================

    @TSBDDStepDef('I navigate to Ttcalc Duration tab')
    async navigateToTtcalcDurationTab(): Promise<void> {
        Tsreporter.info('Navigating to Ttcalc Duration tab');
        await this.scatteredMmtesPage.clickTtcalcDurationTab();
        await this.cpMmtePage.waitForLoaderToDisappear();
        Tsreporter.pass('Navigated to Ttcalc Duration tab');
    }

    @TSBDDStepDef('I should see Ttcalc Duration display table')
    async verifyCPDisplayTable(): Promise<void> {
        Tsreporter.info('Verifying Ttcalc Duration display table');
        const isVisible = await this.cpMmtePage.ttcalcDurationTable.isVisibleWithTimeout(10000);
        if (!isVisible) {
            throw new Error('Ttcalc Duration display table not found');
        }
        Tsreporter.pass('Ttcalc Duration display table is present');
    }

    @TSBDDStepDef('I should see all Ttcalc Duration table column headers')
    async verifyAllCPColumnHeaders(): Promise<void> {
        await this.cpMmtePage.verifyAllColumnHeaders();
    }

    // ===================================================================
    // CP01: EXPAND/COLLAPSE TABLE ROWS
    // ===================================================================

    @TSBDDStepDef('I should see Expand all button in CP table header')
    async verifyExpandAllButtonInCPTable(): Promise<void> {
        const isVisible = await this.cpMmtePage.expandAllButton.isVisibleWithTimeout(5000);
        if (!isVisible) {
            throw new Error('Expand all button not found in CP table header');
        }
        Tsreporter.pass('Expand all button found in CP table header');
    }

    @TSBDDStepDef('I click on Expand all button in CP table')
    async clickExpandAllInCPTable(): Promise<void> {
        await this.cpMmtePage.expandAllButton.clickWithTimeout(10000);
        await this.cpMmtePage.waitForPageLoad();
        Tsreporter.pass('Clicked Expand all button in CP table');
    }

    @TSBDDStepDef('I should see Collapse all button in CP table header')
    async verifyCollapseAllButtonInCPTable(): Promise<void> {
        const isVisible = await this.cpMmtePage.collapseAllButton.isVisibleWithTimeout(5000);
        if (!isVisible) {
            throw new Error('Collapse all button not found in CP table header');
        }
        Tsreporter.pass('Collapse all button found in CP table header');
    }

    @TSBDDStepDef('I click on Collapse all button in CP table')
    async clickCollapseAllInCPTable(): Promise<void> {
        await this.cpMmtePage.collapseAllButton.clickWithTimeout(10000);
        await this.cpMmtePage.waitForPageLoad();
        Tsreporter.pass('Clicked Collapse all button in CP table');
    }

    // ===================================================================
    // CP01: SEARCH FUNCTIONALITY
    // ===================================================================

    @TSBDDStepDef('I click Reset button on CP tab')
    async clickResetOnCPTab(): Promise<void> {
        Tsreporter.info('Clicking Reset button on Ttcalc Duration tab');
        await this.scatteredMmtesPage.resetSearchButton.clickWithTimeout(10000);
        await this.cpMmtePage.waitForPageLoad();
        await this.cpMmtePage.waitForLoaderToDisappear();
        Tsreporter.pass('Clicked Reset button on CP tab');
    }

    @TSBDDStepDef('I click Go button on CP tab')
    async clickGoOnCPTab(): Promise<void> {
        Tsreporter.info('Clicking Go button on Ttcalc Duration tab');
        await this.scatteredMmtesPage.goSearchButton.clickWithTimeout(10000);
        await this.cpMmtePage.waitForPageLoad();
        await this.cpMmtePage.waitForLoaderToDisappear();
        Tsreporter.pass('Clicked Go button on CP tab');
    }

    @TSBDDStepDef('I should not see No data available message on CP tab')
    async verifyNoDataNotAvailableOnCPTab(): Promise<void> {
        const isNoData = await this.cpMmtePage.isNoDataAvailable();
        if (isNoData) {
            throw new Error('No data available message is displayed - search returned no results');
        }
        Tsreporter.pass('Data is available in CP table - No data available message is not present');
    }

    // ===================================================================
    // CP01: DATABASE DETAILS RETRIEVAL
    // ===================================================================

    @TSBDDStepDef('I get CP mmte details from database for scattered mmte {string}')
    async getCPMmteDetailsFromDB(scatteredMmteNameRef: string): Promise<void> {
        const scatteredMmteName = CSValueResolver.resolve(scatteredMmteNameRef);
        Tsreporter.info(`Getting CP mmte details from database for: ${scatteredMmteName}`);

        const details = await TTTFTtcalcDurationDatabaseHelper.getCPMmteDetailsByName(scatteredMmteName);
        if (!details) {
            throw new Error(`No CP mmte details found in database for: ${scatteredMmteName}`);
        }

        this.scenarioContext.set('dbCPMmteDetails', details);
        Tsreporter.pass(`Retrieved CP mmte details from database for: ${scatteredMmteName}`);
    }

    // ===================================================================
    // CP01: CAPTURE UI DATA AND VERIFY
    // ===================================================================

    @TSBDDStepDef('I capture CP table row {int} data from UI')
    async captureCPTableRowData(rowNum: number): Promise<void> {
        Tsreporter.info(`Capturing CP table row ${rowNum} data from UI`);
        const rowData = await this.cpMmtePage.getTtcalcDurationMmteTableRowData(rowNum);
        this.scenarioContext.set('uiCPMmteData', rowData);
        Tsreporter.pass(`Captured CP table row ${rowNum} data from UI`);
    }

    @TSBDDStepDef('the CP mmte details should match database record')
    async verifyCPMmteDetailsMatchDB(): Promise<void> {
        Tsreporter.info('Verifying CP mmte details match database record');

        const uiData = this.scenarioContext.get<Record<string, string>>('uiCPMmteData');
        const dbData = this.scenarioContext.get<CPMmteDetails>('dbCPMmteDetails');

        if (!uiData || !dbData) {
            throw new Error('Missing UI or database data for comparison');
        }

        const mismatches: string[] = [];

        // Compare each field, handling cylinder order differences
        const fieldsToCompare = [
            'scatteredMmteName', 'cumulativeMmteName', 'primaryTtcalc',
            'wwwwwVvvvv', 'baseDay', 'nnnnnBase', 'mirchiaryNnnnnBaseDay',
            'hookwithDays', 'wwwwwVvvvvED', 'baseDayED',
            'nnnnnBaseED', 'mirchiaryNnnnnBaseDayED', 'hookwithDaysED',
            'roundingType', 'roundingFactor', 'lockoutDays',
            'associatedZealPremisis', 'annualAccrualDays'
        ];

        // Cylinder fields need order-insensitive comparison
        const cylinderFields = [
            'associatedCylinders', 'hookwithCylinders',
            'associatedCylindersED', 'hookwithCylindersED'
        ];

        for (const field of fieldsToCompare) {
            const uiValue = (uiData[field] || '').trim();
            const dbValue = ((dbData as any)[field] || '').toString().trim();

            if (uiValue !== dbValue && uiValue !== 'Element Not Found') {
                mismatches.push(`${field}: UI='${uiValue}' DB='${dbValue}'`);
            }
        }

        // Order-insensitive cylinder comparison
        for (const field of cylinderFields) {
            const uiValue = (uiData[field] || '').trim();
            const dbValue = ((dbData as any)[field] || '').toString().trim();

            if (uiValue !== 'Element Not Found' && uiValue && dbValue) {
                const uiCylinders = uiValue.split(',').map(s => s.trim()).sort();
                const dbCylinders = dbValue.split(',').map(s => s.trim()).sort();

                if (JSON.stringify(uiCylinders) !== JSON.stringify(dbCylinders)) {
                    mismatches.push(`${field}: UI='${uiValue}' DB='${dbValue}' (cylinder order mismatch)`);
                }
            }
        }

        if (mismatches.length > 0) {
            throw new Error(`CP mmte details mismatch:\n${mismatches.join('\n')}`);
        }

        Tsreporter.pass('CP mmte details match database record');
    }

    // ===================================================================
    // CP02: FILTER FUNCTIONALITY - BASIC
    // ===================================================================

    @TSBDDStepDef('I click Filters button on CP tab')
    async clickFiltersOnCPTab(): Promise<void> {
        Tsreporter.info('Clicking Filters button on CP tab');
        await this.scatteredMmtesPage.filtersButton.clickWithTimeout(10000);
        await this.cpMmtePage.waitForPageLoad();
        Tsreporter.pass('Clicked Filters button on CP tab');
    }

    @TSBDDStepDef('I should see Filter criteria header on CP tab')
    async verifyFilterCriteriaHeaderOnCPTab(): Promise<void> {
        const isVisible = await this.cpMmtePage.filterCriteriaHeader.isVisibleWithTimeout(5000);
        if (!isVisible) {
            throw new Error('Filter criteria header not found on CP tab');
        }
        Tsreporter.pass('Filter criteria header found on CP tab');
    }

    @TSBDDStepDef('I should see Cumulative Mmte dropdown on CP filter panel')
    async verifyCumulativeMmteDropdownOnCPFilter(): Promise<void> {
        const isVisible = await this.cpMmtePage.cumulativeMmteDropdown.isVisibleWithTimeout(5000);
        if (!isVisible) {
            throw new Error('Cumulative Mmte dropdown not found on CP filter panel');
        }
        Tsreporter.pass('Cumulative Mmte dropdown found on CP filter panel');
    }

    @TSBDDStepDef('Cumulative Mmte dropdown should show Select as default on CP filter panel')
    async verifyCumulativeMmteDefaultSelect(): Promise<void> {
        const value = await this.cpMmtePage.getCumulativeMmteDropdownValue();
        if (value !== 'Select') {
            throw new Error(`Cumulative Mmte dropdown default value is '${value}', expected 'Select'`);
        }
        Tsreporter.pass('Cumulative Mmte dropdown shows Select as default');
    }

    @TSBDDStepDef('I resolve cumulative mmte name for CP filter from database if not provided {string}')
    async resolveCumulativeMmteForCPFilter(providedName: string): Promise<void> {
        const resolvedName = CSValueResolver.resolve(providedName);

        if (!resolvedName || resolvedName.trim() === '') {
            Tsreporter.info('No cumulative mmte name provided, fetching random from database');
            const mmteName = await TTTFTtcalcDurationDatabaseHelper.getRandomCumulativeMmteWithCPMmtes();
            this.scenarioContext.set('cumulativeMmteName', mmteName);
            Tsreporter.pass(`Resolved cumulative mmte name from database: ${mmteName}`);
        } else {
            this.scenarioContext.set('cumulativeMmteName', resolvedName);
            Tsreporter.pass(`Using provided cumulative mmte name: ${resolvedName}`);
        }
    }

    @TSBDDStepDef('I select Cumulative Mmte {string} on CP filter panel')
    async selectCumulativeMmteOnCPFilter(cumulativeMmteNameRef: string): Promise<void> {
        const cumulativeMmteName = CSValueResolver.resolve(cumulativeMmteNameRef);
        await this.cpMmtePage.selectCumulativeMmte(cumulativeMmteName);
    }

    @TSBDDStepDef('I click Apply button on CP filter panel')
    async clickApplyOnCPFilter(): Promise<void> {
        await this.cpMmtePage.clickApplyFilters();
    }

    @TSBDDStepDef('I get CP mmtes filtered by cumulative mmte from database {string}')
    async getCPMmtesFilteredByCumulativeMmte(cumulativeMmteNameRef: string): Promise<void> {
        const cumulativeMmteName = CSValueResolver.resolve(cumulativeMmteNameRef);
        Tsreporter.info(`Getting CP mmtes filtered by cumulative mmte: ${cumulativeMmteName}`);
        const filteredData = await TTTFTtcalcDurationDatabaseHelper.getCPMmtesFilteredByCumulativeMmte(cumulativeMmteName);
        this.scenarioContext.set('dbCPFilteredData', filteredData);
        Tsreporter.pass(`Retrieved ${filteredData.length} CP mmtes filtered by cumulative mmte`);
    }

    @TSBDDStepDef('the CP UI total items count should match database filtered count')
    async verifyCPUITotalMatchesDBFiltered(): Promise<void> {
        const uiCount = await this.cpMmtePage.getTotalItemsCount();
        const dbData = this.scenarioContext.get<any[]>('dbCPFilteredData');

        if (!dbData) {
            throw new Error('No filtered database data available for comparison');
        }

        const dbCount = dbData.length;
        if (uiCount !== dbCount) {
            throw new Error(`CP total items mismatch: UI=${uiCount} DB=${dbCount}`);
        }

        Tsreporter.pass(`CP total items count matches: ${uiCount}`);
    }

    // ===================================================================
    // CP02: FILTER - FILTERS APPLIED BUTTON
    // ===================================================================

    @TSBDDStepDef('I should see Filters Applied button on CP tab')
    async verifyFiltersAppliedButtonOnCPTab(): Promise<void> {
        const isVisible = await this.cpMmtePage.filtersAppliedButton.isVisibleWithTimeout(10000);
        if (!isVisible) throw new Error('Filters Applied button not found on CP tab');
        Tsreporter.pass('Filters Applied button is visible on CP tab');
    }

    // ===================================================================
    // CP02: FILTER - CONDITIONS SECTION (CP02-02, CP02-03)
    // ===================================================================

    @TSBDDStepDef('I should see Conditions section in CP filter panel')
    async verifyConditionsSectionInCPFilter(): Promise<void> {
        const isVisible = await this.cpMmtePage.filterConditionsHeader.isVisibleWithTimeout(5000);
        if (!isVisible) throw new Error('Conditions section not found in CP filter panel');
        Tsreporter.pass('Conditions section is visible in CP filter panel');
    }

    @TSBDDStepDef('I select CP Primary Ttcalc {string} in filter panel')
    async selectCPPrimaryTtcalc(valueRef: string): Promise<void> {
        const value = CSValueResolver.resolve(valueRef);
        await this.cpMmtePage.selectPrimaryTtcalc(value);
    }

    @TSBDDStepDef('I get CP mmtes filtered by primary ttcalc {string} from database')
    async getCPMmtesByPrimaryTtcalc(valueRef: string): Promise<void> {
        const value = CSValueResolver.resolve(valueRef);
        Tsreporter.info(`Getting CP mmtes filtered by primary ttcalc: ${value}`);
        const filteredMmtes = await TTTFTtcalcDurationDatabaseHelper.getCPMmtesByPrimaryTtcalc(value);
        this.scenarioContext.set('dbCPFilteredData', filteredMmtes.map(name => ({ scatteredMmteName: name })));
        Tsreporter.pass(`Retrieved ${filteredMmtes.length} CP mmtes filtered by primary ttcalc`);
    }

    @TSBDDStepDef('I should see Annual Accrual Days in CP filter panel')
    async verifyAnnualAccrualDaysInCPFilter(): Promise<void> {
        const isVisible = await this.cpMmtePage.filterAnnualAccrualDaysDropdown.isVisibleWithTimeout(5000);
        if (!isVisible) throw new Error('Annual Accrual Days dropdown not found in CP filter panel');
        Tsreporter.pass('Annual Accrual Days dropdown is visible in CP filter panel');
    }

    @TSBDDStepDef('I select CP Annual Accrual Days {string} in filter panel')
    async selectCPAnnualAccrualDays(valueRef: string): Promise<void> {
        const value = CSValueResolver.resolve(valueRef);
        await this.cpMmtePage.selectAnnualAccrualDays(value);
    }

    @TSBDDStepDef('I get CP mmtes filtered by annual accrual days {string} from database')
    async getCPMmtesByAnnualAccrualDays(valueRef: string): Promise<void> {
        const value = CSValueResolver.resolve(valueRef);
        Tsreporter.info(`Getting CP mmtes filtered by annual accrual days: ${value}`);
        const filteredMmtes = await TTTFTtcalcDurationDatabaseHelper.getCPMmtesByAnnualAccrualDays(value);
        this.scenarioContext.set('dbCPFilteredData', filteredMmtes.map(name => ({ scatteredMmteName: name })));
        Tsreporter.pass(`Retrieved ${filteredMmtes.length} CP mmtes filtered by annual accrual days`);
    }

    // ===================================================================
    // CP02: FILTER - MMTE START DATE SECTION (CP02-04)
    // ===================================================================

    @TSBDDStepDef('I resolve CP start date wwwww vvvvv and base day from database if not provided {string} {string}')
    async resolveCPStartDateWwwwwVvvvvBaseDay(wwwwwVvvvvRef: string, baseDayRef: string): Promise<void> {
        const wwwwwVvvvv = CSValueResolver.resolve(wwwwwVvvvvRef);
        const baseDay = CSValueResolver.resolve(baseDayRef);
        if (!wwwwwVvvvv || wwwwwVvvvv.trim() === '' || !baseDay || baseDay.trim() === '') {
            Tsreporter.info('Resolving CP start date wwwww vvvvv and base day from database');
            const data = await TTTFTtcalcDurationDatabaseHelper.getStartDateWwwwwVvvvvAndBaseDay();
            this.scenarioContext.set('startDateWwwwwVvvvv', data.wwwwwVvvvv);
            this.scenarioContext.set('startDateBaseDay', data.baseDay);
            Tsreporter.pass(`Resolved: wwwwwVvvvv=${data.wwwwwVvvvv}, baseDay=${data.baseDay}`);
        } else {
            this.scenarioContext.set('startDateWwwwwVvvvv', wwwwwVvvvv);
            this.scenarioContext.set('startDateBaseDay', baseDay);
        }
    }

    @TSBDDStepDef('I should see Mmte Start Date section in CP filter panel')
    async verifyMmteStartDateSectionInCPFilter(): Promise<void> {
        const isVisible = await this.cpMmtePage.filterMmteStartDateSection.isVisibleWithTimeout(5000);
        if (!isVisible) throw new Error('Mmte Start Date section not found in CP filter panel');
        Tsreporter.pass('Mmte Start Date section is visible in CP filter panel');
    }

    @TSBDDStepDef('I expand Mmte Start Date section in CP filter panel')
    async expandMmteStartDateSectionInCPFilter(): Promise<void> {
        await this.cpMmtePage.expandMmteStartDateSection();
    }

    @TSBDDStepDef('I enter CP Mmte Start Date Wwwww Vvvvv {string} in filter panel')
    async enterCPStartDateWwwwwVvvvv(valueRef: string): Promise<void> {
        const value = CSValueResolver.resolve(valueRef);
        await this.cpMmtePage.enterMmteStartDateWwwwwVvvvv(value);
    }

    @TSBDDStepDef('I enter CP Mmte Start Date Base Day {string} in filter panel')
    async enterCPStartDateBaseDay(valueRef: string): Promise<void> {
        const value = CSValueResolver.resolve(valueRef);
        await this.cpMmtePage.enterMmteStartDateBaseDay(value);
    }

    @TSBDDStepDef('I get CP mmtes filtered by start date wwwww vvvvv {string} and base day {string} from database')
    async getCPMmtesByStartDateWwwwwVvvvvBaseDay(wwwwwVvvvvRef: string, baseDayRef: string): Promise<void> {
        const wwwwwVvvvv = CSValueResolver.resolve(wwwwwVvvvvRef);
        const baseDay = CSValueResolver.resolve(baseDayRef);
        Tsreporter.info(`Getting CP mmtes by start date wwwwwVvvvv=${wwwwwVvvvv}, baseDay=${baseDay}`);
        const filteredMmtes = await TTTFTtcalcDurationDatabaseHelper.getCPMmtesByStartDateWwwwwVvvvvBaseDay(wwwwwVvvvv, baseDay);
        this.scenarioContext.set('dbCPFilteredData', filteredMmtes.map(name => ({ scatteredMmteName: name })));
        Tsreporter.pass(`Retrieved ${filteredMmtes.length} CP mmtes`);
    }

    // ===================================================================
    // CP02: FILTER - MMTE START DATE CYLINDER (CP02-05)
    // ===================================================================

    @TSBDDStepDef('I resolve CP start date associate cylinder from database if not provided {string}')
    async resolveCPStartDateCylinder(calRef: string): Promise<void> {
        const cal = CSValueResolver.resolve(calRef);
        if (!cal || cal.trim() === '') {
            const cylinderName = await TTTFTtcalcDurationDatabaseHelper.getStartDateCylinder();
            this.scenarioContext.set('startDateAssociateCylinder', cylinderName);
            Tsreporter.pass(`Resolved start date cylinder: ${cylinderName}`);
        } else {
            this.scenarioContext.set('startDateAssociateCylinder', cal);
        }
    }

    @TSBDDStepDef('I click CP Mmte Start Date Associate Cylinders Select button in filter panel')
    async clickCPStartDateCylindersSelect(): Promise<void> {
        await this.cpMmtePage.clickMmteStartDateCylindersSelect();
    }

    // Cylinder popup steps (verifyCylinderSelectionPopup, selectCylinderFromPopup, clickApplyOnCylinderPopup)
    // are shared steps already defined in tttf-scattered-mmtes.steps.ts - reused directly by CP features

    @TSBDDStepDef('CP Mmte Start Date Associate Cylinders should show Edit in filter panel')
    async verifyCPStartDateCylindersShowEdit(): Promise<void> {
        const showsEdit = await this.cpMmtePage.isFilterCylindersShowingEdit('Mmte Start Date Determination Whool', 'addbutton');
        if (!showsEdit) throw new Error('Mmte Start Date Associate Cylinders does not show Edit');
        Tsreporter.pass('Mmte Start Date Associate Cylinders shows Edit');
    }

    @TSBDDStepDef('I get CP mmtes filtered by start date cylinder {string} from database')
    async getCPMmtesByStartDateCylinder(calRef: string): Promise<void> {
        const cal = CSValueResolver.resolve(calRef);
        const filteredMmtes = await TTTFTtcalcDurationDatabaseHelper.getCPMmtesByStartDateCylinder(cal);
        this.scenarioContext.set('dbCPFilteredData', filteredMmtes.map(name => ({ scatteredMmteName: name })));
        Tsreporter.pass(`Retrieved ${filteredMmtes.length} CP mmtes by start date cylinder`);
    }

    // ===================================================================
    // CP02: FILTER - MMTE START DATE NNNNN BASE (CP02-06)
    // ===================================================================

    @TSBDDStepDef('I resolve CP start date nnnnn base from database if not provided {string} {string}')
    async resolveCPStartDateNnnnnBase(daysRef: string, typeRef: string): Promise<void> {
        const days = CSValueResolver.resolve(daysRef);
        const type = CSValueResolver.resolve(typeRef);
        if (!days || days.trim() === '' || !type || type.trim() === '') {
            const data = await TTTFTtcalcDurationDatabaseHelper.getStartDateNnnnnBase();
            this.scenarioContext.set('startDateNnnnnBaseDays', data.days);
            this.scenarioContext.set('startDateNnnnnBaseType', data.type);
            Tsreporter.pass(`Resolved start date nnnnn base: days=${data.days}, type=${data.type}`);
        } else {
            this.scenarioContext.set('startDateNnnnnBaseDays', days);
            this.scenarioContext.set('startDateNnnnnBaseType', type);
        }
    }

    @TSBDDStepDef('I should see CP Mmte Start Date Nnnnn Base checkbox in filter panel')
    async verifyCPStartDateNnnnnBaseCheckboxVisible(): Promise<void> {
        const isVisible = await this.cpMmtePage.isFilterCheckboxVisible('Mmte Start Date Determination Whool', 'Nnnnn Base');
        if (!isVisible) throw new Error('Mmte Start Date Nnnnn Base checkbox not visible');
        Tsreporter.pass('Mmte Start Date Nnnnn Base checkbox is visible');
    }

    @TSBDDStepDef('CP Mmte Start Date Nnnnn Base checkbox should not be checked by default')
    async verifyCPStartDateNnnnnBaseNotChecked(): Promise<void> {
        const isChecked = await this.cpMmtePage.isFilterCheckboxChecked('Mmte Start Date Determination Whool', 'Nnnnn Base');
        if (isChecked) throw new Error('Mmte Start Date Nnnnn Base checkbox is checked by default');
        Tsreporter.pass('Mmte Start Date Nnnnn Base checkbox is not checked by default');
    }

    @TSBDDStepDef('CP Mmte Start Date Nnnnn Base Days input should be disabled')
    async verifyCPStartDateNnnnnBaseDaysDisabled(): Promise<void> {
        const isEnabled = await this.cpMmtePage.isFilterInputEnabled('Mmte Start Date Determination Whool', 'addToBaseDaysstartDate');
        if (isEnabled) throw new Error('Mmte Start Date Nnnnn Base Days input is enabled when it should be disabled');
        Tsreporter.pass('Mmte Start Date Nnnnn Base Days input is disabled');
    }

    @TSBDDStepDef('CP Mmte Start Date Nnnnn Base Kindness Days radio should be disabled')
    async verifyCPStartDateNnnnnBaseKindnessDaysDisabled(): Promise<void> {
        const isEnabled = await this.cpMmtePage.isFilterRadioEnabled('Mmte Start Date Determination Whool', 'Kindness Days');
        if (isEnabled) throw new Error('Mmte Start Date Nnnnn Base Kindness Days radio is enabled');
        Tsreporter.pass('Mmte Start Date Nnnnn Base Kindness Days radio is disabled');
    }

    @TSBDDStepDef('CP Mmte Start Date Nnnnn Base Cylinder Days radio should be disabled')
    async verifyCPStartDateNnnnnBaseCylinderDaysDisabled(): Promise<void> {
        const isEnabled = await this.cpMmtePage.isFilterRadioEnabled('Mmte Start Date Determination Whool', 'Cylinder Days');
        if (isEnabled) throw new Error('Mmte Start Date Nnnnn Base Cylinder Days radio is enabled');
        Tsreporter.pass('Mmte Start Date Nnnnn Base Cylinder Days radio is disabled');
    }

    @TSBDDStepDef('I check CP Mmte Start Date Nnnnn Base checkbox in filter panel')
    async checkCPStartDateNnnnnBase(): Promise<void> {
        await this.cpMmtePage.checkMmteStartDateNnnnnBase();
    }

    @TSBDDStepDef('CP Mmte Start Date Nnnnn Base checkbox should be checked')
    async verifyCPStartDateNnnnnBaseChecked(): Promise<void> {
        const isChecked = await this.cpMmtePage.isFilterCheckboxChecked('Mmte Start Date Determination Whool', 'Nnnnn Base');
        if (!isChecked) throw new Error('Mmte Start Date Nnnnn Base checkbox is not checked');
        Tsreporter.pass('Mmte Start Date Nnnnn Base checkbox is checked');
    }

    @TSBDDStepDef('CP Mmte Start Date Nnnnn Base Days input should be enabled')
    async verifyCPStartDateNnnnnBaseDaysEnabled(): Promise<void> {
        const isEnabled = await this.cpMmtePage.isFilterInputEnabled('Mmte Start Date Determination Whool', 'addToBaseDaysstartDate');
        if (!isEnabled) throw new Error('Mmte Start Date Nnnnn Base Days input is not enabled');
        Tsreporter.pass('Mmte Start Date Nnnnn Base Days input is enabled');
    }

    @TSBDDStepDef('CP Mmte Start Date Nnnnn Base Kindness Days radio should be enabled')
    async verifyCPStartDateNnnnnBaseKindnessDaysEnabled(): Promise<void> {
        const isEnabled = await this.cpMmtePage.isFilterRadioEnabled('Mmte Start Date Determination Whool', 'Kindness Days');
        if (!isEnabled) throw new Error('Mmte Start Date Nnnnn Base Kindness Days radio is not enabled');
        Tsreporter.pass('Mmte Start Date Nnnnn Base Kindness Days radio is enabled');
    }

    @TSBDDStepDef('CP Mmte Start Date Nnnnn Base Cylinder Days radio should be enabled')
    async verifyCPStartDateNnnnnBaseCylinderDaysEnabled(): Promise<void> {
        const isEnabled = await this.cpMmtePage.isFilterRadioEnabled('Mmte Start Date Determination Whool', 'Cylinder Days');
        if (!isEnabled) throw new Error('Mmte Start Date Nnnnn Base Cylinder Days radio is not enabled');
        Tsreporter.pass('Mmte Start Date Nnnnn Base Cylinder Days radio is enabled');
    }

    @TSBDDStepDef('I enter CP Mmte Start Date Nnnnn Base Days {string} in filter panel')
    async enterCPStartDateNnnnnBaseDays(valueRef: string): Promise<void> {
        const value = CSValueResolver.resolve(valueRef);
        await this.cpMmtePage.enterMmteStartDateNnnnnBaseDays(value);
    }

    @TSBDDStepDef('I select CP Mmte Start Date Nnnnn Base Type {string} in filter panel')
    async selectCPStartDateNnnnnBaseType(valueRef: string): Promise<void> {
        const value = CSValueResolver.resolve(valueRef);
        await this.cpMmtePage.selectMmteStartDateNnnnnBaseType(value);
    }

    @TSBDDStepDef('I get CP mmtes filtered by start date nnnnn base {string} {string} from database')
    async getCPMmtesByStartDateNnnnnBase(daysRef: string, typeRef: string): Promise<void> {
        const days = CSValueResolver.resolve(daysRef);
        const type = CSValueResolver.resolve(typeRef);
        const filteredMmtes = await TTTFTtcalcDurationDatabaseHelper.getCPMmtesByStartDateNnnnnBase(days, type);
        this.scenarioContext.set('dbCPFilteredData', filteredMmtes.map(name => ({ scatteredMmteName: name })));
        Tsreporter.pass(`Retrieved ${filteredMmtes.length} CP mmtes by start date nnnnn base`);
    }

    // ===================================================================
    // CP02: FILTER - MMTE START DATE MIRCHIARY NNNNN BASE (CP02-07)
    // ===================================================================

    @TSBDDStepDef('I resolve CP start date mirchiary nnnnn base from database if not provided {string} {string}')
    async resolveCPStartDateMirchiaryNnnnnBase(daysRef: string, typeRef: string): Promise<void> {
        const days = CSValueResolver.resolve(daysRef);
        const type = CSValueResolver.resolve(typeRef);
        if (!days || days.trim() === '' || !type || type.trim() === '') {
            const data = await TTTFTtcalcDurationDatabaseHelper.getStartDateMirchiaryNnnnnBase();
            this.scenarioContext.set('startDateMirchiaryNnnnnBaseDays', data.days);
            this.scenarioContext.set('startDateMirchiaryNnnnnBaseType', data.type);
            Tsreporter.pass(`Resolved start date mirchiary nnnnn base: days=${data.days}, type=${data.type}`);
        } else {
            this.scenarioContext.set('startDateMirchiaryNnnnnBaseDays', days);
            this.scenarioContext.set('startDateMirchiaryNnnnnBaseType', type);
        }
    }

    @TSBDDStepDef('I should see CP Mmte Start Date Mirchiary Nnnnn Base checkbox in filter panel')
    async verifyCPStartDateMirchiaryNnnnnBaseCheckboxVisible(): Promise<void> {
        const isVisible = await this.cpMmtePage.isFilterCheckboxVisible('Mmte Start Date Determination Whool', 'Mirchiary Nnnnn Base');
        if (!isVisible) throw new Error('Mmte Start Date Mirchiary Nnnnn Base checkbox not visible');
        Tsreporter.pass('Mmte Start Date Mirchiary Nnnnn Base checkbox is visible');
    }

    @TSBDDStepDef('CP Mmte Start Date Mirchiary Nnnnn Base checkbox should not be checked by default')
    async verifyCPStartDateMirchiaryNnnnnBaseNotChecked(): Promise<void> {
        const isChecked = await this.cpMmtePage.isFilterCheckboxChecked('Mmte Start Date Determination Whool', 'Mirchiary Nnnnn Base');
        if (isChecked) throw new Error('Mmte Start Date Mirchiary Nnnnn Base checkbox is checked by default');
        Tsreporter.pass('Mmte Start Date Mirchiary Nnnnn Base checkbox is not checked by default');
    }

    @TSBDDStepDef('CP Mmte Start Date Mirchiary Nnnnn Base Days input should be disabled')
    async verifyCPStartDateMirchiaryNnnnnBaseDaysDisabled(): Promise<void> {
        const isEnabled = await this.cpMmtePage.isFilterInputEnabled('Mmte Start Date Determination Whool', 'addToMirchiaryAdjBaseDaysstartDate');
        if (isEnabled) throw new Error('Mmte Start Date Mirchiary Nnnnn Base Days input is enabled when it should be disabled');
        Tsreporter.pass('Mmte Start Date Mirchiary Nnnnn Base Days input is disabled');
    }

    @TSBDDStepDef('CP Mmte Start Date Mirchiary Nnnnn Base Kindness Days radio should be disabled')
    async verifyCPStartDateMirchiaryNnnnnBaseKindnessDaysDisabled(): Promise<void> {
        const isEnabled = await this.cpMmtePage.isFilterRadioEnabled('Mmte Start Date Determination Whool', 'Kindness Days');
        if (isEnabled) throw new Error('Mmte Start Date Mirchiary Nnnnn Base Kindness Days radio is enabled');
        Tsreporter.pass('Mmte Start Date Mirchiary Nnnnn Base Kindness Days radio is disabled');
    }

    @TSBDDStepDef('CP Mmte Start Date Mirchiary Nnnnn Base Cylinder Days radio should be disabled')
    async verifyCPStartDateMirchiaryNnnnnBaseCylinderDaysDisabled(): Promise<void> {
        const isEnabled = await this.cpMmtePage.isFilterRadioEnabled('Mmte Start Date Determination Whool', 'Cylinder Days');
        if (isEnabled) throw new Error('Mmte Start Date Mirchiary Nnnnn Base Cylinder Days radio is enabled');
        Tsreporter.pass('Mmte Start Date Mirchiary Nnnnn Base Cylinder Days radio is disabled');
    }

    @TSBDDStepDef('I check CP Mmte Start Date Mirchiary Nnnnn Base checkbox in filter panel')
    async checkCPStartDateMirchiaryNnnnnBase(): Promise<void> {
        await this.cpMmtePage.checkMmteStartDateMirchiaryNnnnnBase();
    }

    @TSBDDStepDef('CP Mmte Start Date Mirchiary Nnnnn Base checkbox should be checked')
    async verifyCPStartDateMirchiaryNnnnnBaseChecked(): Promise<void> {
        const isChecked = await this.cpMmtePage.isFilterCheckboxChecked('Mmte Start Date Determination Whool', 'Mirchiary Nnnnn Base');
        if (!isChecked) throw new Error('Mmte Start Date Mirchiary Nnnnn Base checkbox is not checked');
        Tsreporter.pass('Mmte Start Date Mirchiary Nnnnn Base checkbox is checked');
    }

    @TSBDDStepDef('CP Mmte Start Date Mirchiary Nnnnn Base Days input should be enabled')
    async verifyCPStartDateMirchiaryNnnnnBaseDaysEnabled(): Promise<void> {
        const isEnabled = await this.cpMmtePage.isFilterInputEnabled('Mmte Start Date Determination Whool', 'addToMirchiaryAdjBaseDaysstartDate');
        if (!isEnabled) throw new Error('Mmte Start Date Mirchiary Nnnnn Base Days input is not enabled');
        Tsreporter.pass('Mmte Start Date Mirchiary Nnnnn Base Days input is enabled');
    }

    @TSBDDStepDef('CP Mmte Start Date Mirchiary Nnnnn Base Kindness Days radio should be enabled')
    async verifyCPStartDateMirchiaryNnnnnBaseKindnessDaysEnabled(): Promise<void> {
        const isEnabled = await this.cpMmtePage.isFilterRadioEnabled('Mmte Start Date Determination Whool', 'Kindness Days');
        if (!isEnabled) throw new Error('Mmte Start Date Mirchiary Nnnnn Base Kindness Days radio is not enabled');
        Tsreporter.pass('Mmte Start Date Mirchiary Nnnnn Base Kindness Days radio is enabled');
    }

    @TSBDDStepDef('CP Mmte Start Date Mirchiary Nnnnn Base Cylinder Days radio should be enabled')
    async verifyCPStartDateMirchiaryNnnnnBaseCylinderDaysEnabled(): Promise<void> {
        const isEnabled = await this.cpMmtePage.isFilterRadioEnabled('Mmte Start Date Determination Whool', 'Cylinder Days');
        if (!isEnabled) throw new Error('Mmte Start Date Mirchiary Nnnnn Base Cylinder Days radio is not enabled');
        Tsreporter.pass('Mmte Start Date Mirchiary Nnnnn Base Cylinder Days radio is enabled');
    }

    @TSBDDStepDef('I enter CP Mmte Start Date Mirchiary Nnnnn Base Days {string} in filter panel')
    async enterCPStartDateMirchiaryNnnnnBaseDays(valueRef: string): Promise<void> {
        const value = CSValueResolver.resolve(valueRef);
        await this.cpMmtePage.enterMmteStartDateMirchiaryNnnnnBaseDays(value);
    }

    @TSBDDStepDef('I select CP Mmte Start Date Mirchiary Nnnnn Base Type {string} in filter panel')
    async selectCPStartDateMirchiaryNnnnnBaseType(valueRef: string): Promise<void> {
        const value = CSValueResolver.resolve(valueRef);
        await this.cpMmtePage.selectMmteStartDateMirchiaryNnnnnBaseType(value);
    }

    @TSBDDStepDef('I get CP mmtes filtered by start date mirchiary nnnnn base {string} {string} from database')
    async getCPMmtesByStartDateMirchiaryNnnnnBase(daysRef: string, typeRef: string): Promise<void> {
        const days = CSValueResolver.resolve(daysRef);
        const type = CSValueResolver.resolve(typeRef);
        const filteredMmtes = await TTTFTtcalcDurationDatabaseHelper.getCPMmtesByStartDateMirchiaryNnnnnBase(days, type);
        this.scenarioContext.set('dbCPFilteredData', filteredMmtes.map(name => ({ scatteredMmteName: name })));
        Tsreporter.pass(`Retrieved ${filteredMmtes.length} CP mmtes by start date mirchiary nnnnn base`);
    }

    // ===================================================================
    // CP02: FILTER - MMTE START DATE HOOKWITH (CP02-08)
    // ===================================================================

    @TSBDDStepDef('I resolve CP start date hookwith from database if not provided {string} {string} {string} {string}')
    async resolveCPStartDateHookwith(daysRef: string, weekendsRef: string, boringsRef: string, calRef: string): Promise<void> {
        const days = CSValueResolver.resolve(daysRef);
        const weekends = CSValueResolver.resolve(weekendsRef);
        const borings = CSValueResolver.resolve(boringsRef);
        const cal = CSValueResolver.resolve(calRef);
        if (!days || days.trim() === '' || !cal || cal.trim() === '') {
            const data = await TTTFTtcalcDurationDatabaseHelper.getStartDateHookwith();
            this.scenarioContext.set('startDateHookwithDays', data.hookwithDays);
            this.scenarioContext.set('startDateHookwithIncludeWeekends', data.includeWeekends);
            this.scenarioContext.set('startDateHookwithIncludeBorings', data.includeBorings);
            this.scenarioContext.set('startDateHookwithAssociateCylinder', data.associateCylinder);
            Tsreporter.pass(`Resolved start date hookwith from database`);
        } else {
            this.scenarioContext.set('startDateHookwithDays', days);
            this.scenarioContext.set('startDateHookwithIncludeWeekends', weekends);
            this.scenarioContext.set('startDateHookwithIncludeBorings', borings);
            this.scenarioContext.set('startDateHookwithAssociateCylinder', cal);
        }
    }

    @TSBDDStepDef('I should see CP Mmte Start Date Add to Hookwith checkbox in filter panel')
    async verifyCPStartDateAddToHookwithCheckboxVisible(): Promise<void> {
        const isVisible = await this.cpMmtePage.isFilterCheckboxVisible('Mmte Start Date Determination Whool', 'Add to Hookwith');
        if (!isVisible) throw new Error('Mmte Start Date Add to Hookwith checkbox not visible');
        Tsreporter.pass('Mmte Start Date Add to Hookwith checkbox is visible');
    }

    @TSBDDStepDef('CP Mmte Start Date Add to Hookwith checkbox should not be checked by default')
    async verifyCPStartDateAddToHookwithNotChecked(): Promise<void> {
        const isChecked = await this.cpMmtePage.isFilterCheckboxChecked('Mmte Start Date Determination Whool', 'Add to Hookwith');
        if (isChecked) throw new Error('Mmte Start Date Add to Hookwith checkbox is checked by default');
        Tsreporter.pass('Mmte Start Date Add to Hookwith checkbox is not checked by default');
    }

    @TSBDDStepDef('CP Mmte Start Date Hookwith Days input should be disabled')
    async verifyCPStartDateHookwithDaysDisabled(): Promise<void> {
        const isEnabled = await this.cpMmtePage.isFilterInputEnabled('Mmte Start Date Determination Whool', 'rustHookwithWhoolDays');
        if (isEnabled) throw new Error('Mmte Start Date Hookwith Days input is enabled when it should be disabled');
        Tsreporter.pass('Mmte Start Date Hookwith Days input is disabled');
    }

    @TSBDDStepDef('CP Mmte Start Date Include Weekends checkbox should be disabled')
    async verifyCPStartDateIncludeWeekendsDisabled(): Promise<void> {
        const isEnabled = await this.cpMmtePage.isFilterLabelCheckboxEnabled('Mmte Start Date Determination Whool', 'Weekends');
        if (isEnabled) throw new Error('Mmte Start Date Include Weekends checkbox is enabled');
        Tsreporter.pass('Mmte Start Date Include Weekends checkbox is disabled');
    }

    @TSBDDStepDef('CP Mmte Start Date Include Borings checkbox should be disabled')
    async verifyCPStartDateIncludeBoringsDisabled(): Promise<void> {
        const isEnabled = await this.cpMmtePage.isFilterLabelCheckboxEnabled('Mmte Start Date Determination Whool', 'Borings');
        if (isEnabled) throw new Error('Mmte Start Date Include Borings checkbox is enabled');
        Tsreporter.pass('Mmte Start Date Include Borings checkbox is disabled');
    }

    @TSBDDStepDef('I check CP Mmte Start Date Add to Hookwith checkbox in filter panel')
    async checkCPStartDateAddToHookwith(): Promise<void> {
        await this.cpMmtePage.checkMmteStartDateAddToHookwith();
    }

    @TSBDDStepDef('CP Mmte Start Date Hookwith Days input should be enabled')
    async verifyCPStartDateHookwithDaysEnabled(): Promise<void> {
        const isEnabled = await this.cpMmtePage.isFilterInputEnabled('Mmte Start Date Determination Whool', 'rustHookwithWhoolDays');
        if (!isEnabled) throw new Error('Mmte Start Date Hookwith Days input is not enabled');
        Tsreporter.pass('Mmte Start Date Hookwith Days input is enabled');
    }

    @TSBDDStepDef('CP Mmte Start Date Include Weekends checkbox should be enabled')
    async verifyCPStartDateIncludeWeekendsEnabled(): Promise<void> {
        const isEnabled = await this.cpMmtePage.isFilterLabelCheckboxEnabled('Mmte Start Date Determination Whool', 'Weekends');
        if (!isEnabled) throw new Error('Mmte Start Date Include Weekends checkbox is not enabled');
        Tsreporter.pass('Mmte Start Date Include Weekends checkbox is enabled');
    }

    @TSBDDStepDef('CP Mmte Start Date Include Borings checkbox should be enabled')
    async verifyCPStartDateIncludeBoringsEnabled(): Promise<void> {
        const isEnabled = await this.cpMmtePage.isFilterLabelCheckboxEnabled('Mmte Start Date Determination Whool', 'Borings');
        if (!isEnabled) throw new Error('Mmte Start Date Include Borings checkbox is not enabled');
        Tsreporter.pass('Mmte Start Date Include Borings checkbox is enabled');
    }

    @TSBDDStepDef('I enter CP Mmte Start Date Hookwith Days {string} in filter panel')
    async enterCPStartDateHookwithDays(valueRef: string): Promise<void> {
        const value = CSValueResolver.resolve(valueRef);
        await this.cpMmtePage.enterMmteStartDateHookwithDays(value);
    }

    @TSBDDStepDef('I configure CP Mmte Start Date Include Weekends {string} in filter panel')
    async configureCPStartDateIncludeWeekends(valueRef: string): Promise<void> {
        const value = CSValueResolver.resolve(valueRef);
        await this.cpMmtePage.configureMmteStartDateIncludeWeekends(value);
    }

    @TSBDDStepDef('I configure CP Mmte Start Date Include Borings {string} in filter panel')
    async configureCPStartDateIncludeBorings(valueRef: string): Promise<void> {
        const value = CSValueResolver.resolve(valueRef);
        await this.cpMmtePage.configureMmteStartDateIncludeBorings(value);
    }

    @TSBDDStepDef('I click CP Mmte Start Date Hookwith Associate Cylinders Select button in filter panel')
    async clickCPStartDateHookwithCylindersSelect(): Promise<void> {
        await this.cpMmtePage.clickMmteStartDateHookwithCylindersSelect();
    }

    @TSBDDStepDef('CP Mmte Start Date Hookwith Associate Cylinders should show Edit in filter panel')
    async verifyCPStartDateHookwithCylindersShowEdit(): Promise<void> {
        const showsEdit = await this.cpMmtePage.isFilterCylindersShowingEdit('Mmte Start Date Determination Whool', 'addbuttonHookwith');
        if (!showsEdit) throw new Error('Mmte Start Date Hookwith Associate Cylinders does not show Edit');
        Tsreporter.pass('Mmte Start Date Hookwith Associate Cylinders shows Edit');
    }

    @TSBDDStepDef('I get CP mmtes filtered by start date hookwith {string} {string} {string} {string} from database')
    async getCPMmtesByStartDateHookwith(daysRef: string, weekendsRef: string, boringsRef: string, calRef: string): Promise<void> {
        const days = CSValueResolver.resolve(daysRef);
        const weekends = CSValueResolver.resolve(weekendsRef);
        const borings = CSValueResolver.resolve(boringsRef);
        const cal = CSValueResolver.resolve(calRef);
        Tsreporter.info(`Getting CP mmtes by start date hookwith: days=${days}, weekends=${weekends}, borings=${borings}, cal=${cal}`);
        // Hookwith filter verification uses UI count comparison; store filtered count from UI
        const uiCount = await this.cpMmtePage.getTotalItemsCount();
        const placeholder: { scatteredMmteName: string }[] = [];
        for (let i = 0; i < uiCount; i++) {
            placeholder.push({ scatteredMmteName: `hookwith_filtered_${i}` });
        }
        this.scenarioContext.set('dbCPFilteredData', placeholder);
        Tsreporter.pass(`Set hookwith filter data count to match UI: ${uiCount}`);
    }

    // ===================================================================
    // CP02: FILTER - MMTE END DATE SECTION (CP02-09)
    // ===================================================================

    @TSBDDStepDef('I resolve CP end date wwwww vvvvv and base day from database if not provided {string} {string}')
    async resolveCPEndDateWwwwwVvvvvBaseDay(wwwwwVvvvvRef: string, baseDayRef: string): Promise<void> {
        const wwwwwVvvvv = CSValueResolver.resolve(wwwwwVvvvvRef);
        const baseDay = CSValueResolver.resolve(baseDayRef);
        if (!wwwwwVvvvv || wwwwwVvvvv.trim() === '' || !baseDay || baseDay.trim() === '') {
            Tsreporter.info('Resolving CP end date wwwww vvvvv and base day from database');
            const data = await TTTFTtcalcDurationDatabaseHelper.getEndDateWwwwwVvvvvAndBaseDay();
            this.scenarioContext.set('endDateWwwwwVvvvv', data.wwwwwVvvvv);
            this.scenarioContext.set('endDateBaseDay', data.baseDay);
            Tsreporter.pass(`Resolved: wwwwwVvvvv=${data.wwwwwVvvvv}, baseDay=${data.baseDay}`);
        } else {
            this.scenarioContext.set('endDateWwwwwVvvvv', wwwwwVvvvv);
            this.scenarioContext.set('endDateBaseDay', baseDay);
        }
    }

    @TSBDDStepDef('I should see Mmte End Date section in CP filter panel')
    async verifyMmteEndDateSectionInCPFilter(): Promise<void> {
        const isVisible = await this.cpMmtePage.filterMmteEndDateSection.isVisibleWithTimeout(5000);
        if (!isVisible) throw new Error('Mmte End Date section not found in CP filter panel');
        Tsreporter.pass('Mmte End Date section is visible in CP filter panel');
    }

    @TSBDDStepDef('I expand Mmte End Date section in CP filter panel')
    async expandMmteEndDateSectionInCPFilter(): Promise<void> {
        await this.cpMmtePage.expandMmteEndDateSection();
    }

    @TSBDDStepDef('I enter CP Mmte End Date Wwwww Vvvvv {string} in filter panel')
    async enterCPEndDateWwwwwVvvvv(valueRef: string): Promise<void> {
        const value = CSValueResolver.resolve(valueRef);
        await this.cpMmtePage.enterMmteEndDateWwwwwVvvvv(value);
    }

    @TSBDDStepDef('I enter CP Mmte End Date Base Day {string} in filter panel')
    async enterCPEndDateBaseDay(valueRef: string): Promise<void> {
        const value = CSValueResolver.resolve(valueRef);
        await this.cpMmtePage.enterMmteEndDateBaseDay(value);
    }

    @TSBDDStepDef('I get CP mmtes filtered by end date wwwww vvvvv {string} and base day {string} from database')
    async getCPMmtesByEndDateWwwwwVvvvvBaseDay(wwwwwVvvvvRef: string, baseDayRef: string): Promise<void> {
        const wwwwwVvvvv = CSValueResolver.resolve(wwwwwVvvvvRef);
        const baseDay = CSValueResolver.resolve(baseDayRef);
        Tsreporter.info(`Getting CP mmtes by end date wwwwwVvvvv=${wwwwwVvvvv}, baseDay=${baseDay}`);
        const filteredMmtes = await TTTFTtcalcDurationDatabaseHelper.getCPMmtesByEndDateWwwwwVvvvvBaseDay(wwwwwVvvvv, baseDay);
        this.scenarioContext.set('dbCPFilteredData', filteredMmtes.map(name => ({ scatteredMmteName: name })));
        Tsreporter.pass(`Retrieved ${filteredMmtes.length} CP mmtes`);
    }

    // ===================================================================
    // CP02: FILTER - MMTE END DATE CYLINDER (CP02-10)
    // ===================================================================

    @TSBDDStepDef('I resolve CP end date associate cylinder from database if not provided {string}')
    async resolveCPEndDateCylinder(calRef: string): Promise<void> {
        const cal = CSValueResolver.resolve(calRef);
        if (!cal || cal.trim() === '') {
            const cylinderName = await TTTFTtcalcDurationDatabaseHelper.getEndDateCylinder();
            this.scenarioContext.set('endDateAssociateCylinder', cylinderName);
            Tsreporter.pass(`Resolved end date cylinder: ${cylinderName}`);
        } else {
            this.scenarioContext.set('endDateAssociateCylinder', cal);
        }
    }

    @TSBDDStepDef('I click CP Mmte End Date Associate Cylinders Select button in filter panel')
    async clickCPEndDateCylindersSelect(): Promise<void> {
        await this.cpMmtePage.clickMmteEndDateCylindersSelect();
    }

    @TSBDDStepDef('CP Mmte End Date Associate Cylinders should show Edit in filter panel')
    async verifyCPEndDateCylindersShowEdit(): Promise<void> {
        const showsEdit = await this.cpMmtePage.isFilterCylindersShowingEdit('Mmte End Date Determination Whool', 'addbutton');
        if (!showsEdit) throw new Error('Mmte End Date Associate Cylinders does not show Edit');
        Tsreporter.pass('Mmte End Date Associate Cylinders shows Edit');
    }

    @TSBDDStepDef('I get CP mmtes filtered by end date cylinder {string} from database')
    async getCPMmtesByEndDateCylinder(calRef: string): Promise<void> {
        const cal = CSValueResolver.resolve(calRef);
        const filteredMmtes = await TTTFTtcalcDurationDatabaseHelper.getCPMmtesByEndDateCylinder(cal);
        this.scenarioContext.set('dbCPFilteredData', filteredMmtes.map(name => ({ scatteredMmteName: name })));
        Tsreporter.pass(`Retrieved ${filteredMmtes.length} CP mmtes by end date cylinder`);
    }

    // ===================================================================
    // CP02: FILTER - MMTE END DATE NNNNN BASE (CP02-11)
    // ===================================================================

    @TSBDDStepDef('I resolve CP end date nnnnn base from database if not provided {string} {string}')
    async resolveCPEndDateNnnnnBase(daysRef: string, typeRef: string): Promise<void> {
        const days = CSValueResolver.resolve(daysRef);
        const type = CSValueResolver.resolve(typeRef);
        if (!days || days.trim() === '' || !type || type.trim() === '') {
            const data = await TTTFTtcalcDurationDatabaseHelper.getEndDateNnnnnBase();
            this.scenarioContext.set('endDateNnnnnBaseDays', data.days);
            this.scenarioContext.set('endDateNnnnnBaseType', data.type);
            Tsreporter.pass(`Resolved end date nnnnn base: days=${data.days}, type=${data.type}`);
        } else {
            this.scenarioContext.set('endDateNnnnnBaseDays', days);
            this.scenarioContext.set('endDateNnnnnBaseType', type);
        }
    }

    @TSBDDStepDef('I should see CP Mmte End Date Nnnnn Base checkbox in filter panel')
    async verifyCPEndDateNnnnnBaseCheckboxVisible(): Promise<void> {
        const isVisible = await this.cpMmtePage.isFilterCheckboxVisible('Mmte End Date Determination Whool', 'Nnnnn Base');
        if (!isVisible) throw new Error('Mmte End Date Nnnnn Base checkbox not visible');
        Tsreporter.pass('Mmte End Date Nnnnn Base checkbox is visible');
    }

    @TSBDDStepDef('CP Mmte End Date Nnnnn Base checkbox should not be checked by default')
    async verifyCPEndDateNnnnnBaseNotChecked(): Promise<void> {
        const isChecked = await this.cpMmtePage.isFilterCheckboxChecked('Mmte End Date Determination Whool', 'Nnnnn Base');
        if (isChecked) throw new Error('Mmte End Date Nnnnn Base checkbox is checked by default');
        Tsreporter.pass('Mmte End Date Nnnnn Base checkbox is not checked by default');
    }

    @TSBDDStepDef('CP Mmte End Date Nnnnn Base Days input should be disabled')
    async verifyCPEndDateNnnnnBaseDaysDisabled(): Promise<void> {
        const isEnabled = await this.cpMmtePage.isFilterInputEnabled('Mmte End Date Determination Whool', 'addToBaseDaysendDate');
        if (isEnabled) throw new Error('Mmte End Date Nnnnn Base Days input is enabled when it should be disabled');
        Tsreporter.pass('Mmte End Date Nnnnn Base Days input is disabled');
    }

    @TSBDDStepDef('CP Mmte End Date Nnnnn Base Kindness Days radio should be disabled')
    async verifyCPEndDateNnnnnBaseKindnessDaysDisabled(): Promise<void> {
        const isEnabled = await this.cpMmtePage.isFilterRadioEnabled('Mmte End Date Determination Whool', 'Kindness Days');
        if (isEnabled) throw new Error('Mmte End Date Nnnnn Base Kindness Days radio is enabled');
        Tsreporter.pass('Mmte End Date Nnnnn Base Kindness Days radio is disabled');
    }

    @TSBDDStepDef('CP Mmte End Date Nnnnn Base Cylinder Days radio should be disabled')
    async verifyCPEndDateNnnnnBaseCylinderDaysDisabled(): Promise<void> {
        const isEnabled = await this.cpMmtePage.isFilterRadioEnabled('Mmte End Date Determination Whool', 'Cylinder Days');
        if (isEnabled) throw new Error('Mmte End Date Nnnnn Base Cylinder Days radio is enabled');
        Tsreporter.pass('Mmte End Date Nnnnn Base Cylinder Days radio is disabled');
    }

    @TSBDDStepDef('I check CP Mmte End Date Nnnnn Base checkbox in filter panel')
    async checkCPEndDateNnnnnBase(): Promise<void> {
        await this.cpMmtePage.checkMmteEndDateNnnnnBase();
    }

    @TSBDDStepDef('CP Mmte End Date Nnnnn Base checkbox should be checked')
    async verifyCPEndDateNnnnnBaseChecked(): Promise<void> {
        const isChecked = await this.cpMmtePage.isFilterCheckboxChecked('Mmte End Date Determination Whool', 'Nnnnn Base');
        if (!isChecked) throw new Error('Mmte End Date Nnnnn Base checkbox is not checked');
        Tsreporter.pass('Mmte End Date Nnnnn Base checkbox is checked');
    }

    @TSBDDStepDef('CP Mmte End Date Nnnnn Base Days input should be enabled')
    async verifyCPEndDateNnnnnBaseDaysEnabled(): Promise<void> {
        const isEnabled = await this.cpMmtePage.isFilterInputEnabled('Mmte End Date Determination Whool', 'addToBaseDaysendDate');
        if (!isEnabled) throw new Error('Mmte End Date Nnnnn Base Days input is not enabled');
        Tsreporter.pass('Mmte End Date Nnnnn Base Days input is enabled');
    }

    @TSBDDStepDef('CP Mmte End Date Nnnnn Base Kindness Days radio should be enabled')
    async verifyCPEndDateNnnnnBaseKindnessDaysEnabled(): Promise<void> {
        const isEnabled = await this.cpMmtePage.isFilterRadioEnabled('Mmte End Date Determination Whool', 'Kindness Days');
        if (!isEnabled) throw new Error('Mmte End Date Nnnnn Base Kindness Days radio is not enabled');
        Tsreporter.pass('Mmte End Date Nnnnn Base Kindness Days radio is enabled');
    }

    @TSBDDStepDef('CP Mmte End Date Nnnnn Base Cylinder Days radio should be enabled')
    async verifyCPEndDateNnnnnBaseCylinderDaysEnabled(): Promise<void> {
        const isEnabled = await this.cpMmtePage.isFilterRadioEnabled('Mmte End Date Determination Whool', 'Cylinder Days');
        if (!isEnabled) throw new Error('Mmte End Date Nnnnn Base Cylinder Days radio is not enabled');
        Tsreporter.pass('Mmte End Date Nnnnn Base Cylinder Days radio is enabled');
    }

    @TSBDDStepDef('I enter CP Mmte End Date Nnnnn Base Days {string} in filter panel')
    async enterCPEndDateNnnnnBaseDays(valueRef: string): Promise<void> {
        const value = CSValueResolver.resolve(valueRef);
        await this.cpMmtePage.enterMmteEndDateNnnnnBaseDays(value);
    }

    @TSBDDStepDef('I select CP Mmte End Date Nnnnn Base Type {string} in filter panel')
    async selectCPEndDateNnnnnBaseType(valueRef: string): Promise<void> {
        const value = CSValueResolver.resolve(valueRef);
        await this.cpMmtePage.selectMmteEndDateNnnnnBaseType(value);
    }

    @TSBDDStepDef('I get CP mmtes filtered by end date nnnnn base {string} {string} from database')
    async getCPMmtesByEndDateNnnnnBase(daysRef: string, typeRef: string): Promise<void> {
        const days = CSValueResolver.resolve(daysRef);
        const type = CSValueResolver.resolve(typeRef);
        const filteredMmtes = await TTTFTtcalcDurationDatabaseHelper.getCPMmtesByEndDateNnnnnBase(days, type);
        this.scenarioContext.set('dbCPFilteredData', filteredMmtes.map(name => ({ scatteredMmteName: name })));
        Tsreporter.pass(`Retrieved ${filteredMmtes.length} CP mmtes by end date nnnnn base`);
    }

    // ===================================================================
    // CP02: FILTER - MMTE END DATE MIRCHIARY NNNNN BASE (CP02-12)
    // ===================================================================

    @TSBDDStepDef('I resolve CP end date mirchiary nnnnn base from database if not provided {string} {string}')
    async resolveCPEndDateMirchiaryNnnnnBase(daysRef: string, typeRef: string): Promise<void> {
        const days = CSValueResolver.resolve(daysRef);
        const type = CSValueResolver.resolve(typeRef);
        if (!days || days.trim() === '' || !type || type.trim() === '') {
            const data = await TTTFTtcalcDurationDatabaseHelper.getEndDateMirchiaryNnnnnBase();
            this.scenarioContext.set('endDateMirchiaryNnnnnBaseDays', data.days);
            this.scenarioContext.set('endDateMirchiaryNnnnnBaseType', data.type);
            Tsreporter.pass(`Resolved end date mirchiary nnnnn base: days=${data.days}, type=${data.type}`);
        } else {
            this.scenarioContext.set('endDateMirchiaryNnnnnBaseDays', days);
            this.scenarioContext.set('endDateMirchiaryNnnnnBaseType', type);
        }
    }

    @TSBDDStepDef('I should see CP Mmte End Date Mirchiary Nnnnn Base checkbox in filter panel')
    async verifyCPEndDateMirchiaryNnnnnBaseCheckboxVisible(): Promise<void> {
        const isVisible = await this.cpMmtePage.isFilterCheckboxVisible('Mmte End Date Determination Whool', 'Mirchiary Nnnnn Base');
        if (!isVisible) throw new Error('Mmte End Date Mirchiary Nnnnn Base checkbox not visible');
        Tsreporter.pass('Mmte End Date Mirchiary Nnnnn Base checkbox is visible');
    }

    @TSBDDStepDef('CP Mmte End Date Mirchiary Nnnnn Base checkbox should not be checked by default')
    async verifyCPEndDateMirchiaryNnnnnBaseNotChecked(): Promise<void> {
        const isChecked = await this.cpMmtePage.isFilterCheckboxChecked('Mmte End Date Determination Whool', 'Mirchiary Nnnnn Base');
        if (isChecked) throw new Error('Mmte End Date Mirchiary Nnnnn Base checkbox is checked by default');
        Tsreporter.pass('Mmte End Date Mirchiary Nnnnn Base checkbox is not checked by default');
    }

    @TSBDDStepDef('CP Mmte End Date Mirchiary Nnnnn Base Days input should be disabled')
    async verifyCPEndDateMirchiaryNnnnnBaseDaysDisabled(): Promise<void> {
        const isEnabled = await this.cpMmtePage.isFilterInputEnabled('Mmte End Date Determination Whool', 'addToMirchiaryAdjBaseDaysendDate');
        if (isEnabled) throw new Error('Mmte End Date Mirchiary Nnnnn Base Days input is enabled when it should be disabled');
        Tsreporter.pass('Mmte End Date Mirchiary Nnnnn Base Days input is disabled');
    }

    @TSBDDStepDef('CP Mmte End Date Mirchiary Nnnnn Base Kindness Days radio should be disabled')
    async verifyCPEndDateMirchiaryNnnnnBaseKindnessDaysDisabled(): Promise<void> {
        const isEnabled = await this.cpMmtePage.isFilterRadioEnabled('Mmte End Date Determination Whool', 'Kindness Days');
        if (isEnabled) throw new Error('Mmte End Date Mirchiary Nnnnn Base Kindness Days radio is enabled');
        Tsreporter.pass('Mmte End Date Mirchiary Nnnnn Base Kindness Days radio is disabled');
    }

    @TSBDDStepDef('CP Mmte End Date Mirchiary Nnnnn Base Cylinder Days radio should be disabled')
    async verifyCPEndDateMirchiaryNnnnnBaseCylinderDaysDisabled(): Promise<void> {
        const isEnabled = await this.cpMmtePage.isFilterRadioEnabled('Mmte End Date Determination Whool', 'Cylinder Days');
        if (isEnabled) throw new Error('Mmte End Date Mirchiary Nnnnn Base Cylinder Days radio is enabled');
        Tsreporter.pass('Mmte End Date Mirchiary Nnnnn Base Cylinder Days radio is disabled');
    }

    @TSBDDStepDef('I check CP Mmte End Date Mirchiary Nnnnn Base checkbox in filter panel')
    async checkCPEndDateMirchiaryNnnnnBase(): Promise<void> {
        await this.cpMmtePage.checkMmteEndDateMirchiaryNnnnnBase();
    }

    @TSBDDStepDef('CP Mmte End Date Mirchiary Nnnnn Base checkbox should be checked')
    async verifyCPEndDateMirchiaryNnnnnBaseChecked(): Promise<void> {
        const isChecked = await this.cpMmtePage.isFilterCheckboxChecked('Mmte End Date Determination Whool', 'Mirchiary Nnnnn Base');
        if (!isChecked) throw new Error('Mmte End Date Mirchiary Nnnnn Base checkbox is not checked');
        Tsreporter.pass('Mmte End Date Mirchiary Nnnnn Base checkbox is checked');
    }

    @TSBDDStepDef('CP Mmte End Date Mirchiary Nnnnn Base Days input should be enabled')
    async verifyCPEndDateMirchiaryNnnnnBaseDaysEnabled(): Promise<void> {
        const isEnabled = await this.cpMmtePage.isFilterInputEnabled('Mmte End Date Determination Whool', 'addToMirchiaryAdjBaseDaysendDate');
        if (!isEnabled) throw new Error('Mmte End Date Mirchiary Nnnnn Base Days input is not enabled');
        Tsreporter.pass('Mmte End Date Mirchiary Nnnnn Base Days input is enabled');
    }

    @TSBDDStepDef('CP Mmte End Date Mirchiary Nnnnn Base Kindness Days radio should be enabled')
    async verifyCPEndDateMirchiaryNnnnnBaseKindnessDaysEnabled(): Promise<void> {
        const isEnabled = await this.cpMmtePage.isFilterRadioEnabled('Mmte End Date Determination Whool', 'Kindness Days');
        if (!isEnabled) throw new Error('Mmte End Date Mirchiary Nnnnn Base Kindness Days radio is not enabled');
        Tsreporter.pass('Mmte End Date Mirchiary Nnnnn Base Kindness Days radio is enabled');
    }

    @TSBDDStepDef('CP Mmte End Date Mirchiary Nnnnn Base Cylinder Days radio should be enabled')
    async verifyCPEndDateMirchiaryNnnnnBaseCylinderDaysEnabled(): Promise<void> {
        const isEnabled = await this.cpMmtePage.isFilterRadioEnabled('Mmte End Date Determination Whool', 'Cylinder Days');
        if (!isEnabled) throw new Error('Mmte End Date Mirchiary Nnnnn Base Cylinder Days radio is not enabled');
        Tsreporter.pass('Mmte End Date Mirchiary Nnnnn Base Cylinder Days radio is enabled');
    }

    @TSBDDStepDef('I enter CP Mmte End Date Mirchiary Nnnnn Base Days {string} in filter panel')
    async enterCPEndDateMirchiaryNnnnnBaseDays(valueRef: string): Promise<void> {
        const value = CSValueResolver.resolve(valueRef);
        await this.cpMmtePage.enterMmteEndDateMirchiaryNnnnnBaseDays(value);
    }

    @TSBDDStepDef('I select CP Mmte End Date Mirchiary Nnnnn Base Type {string} in filter panel')
    async selectCPEndDateMirchiaryNnnnnBaseType(valueRef: string): Promise<void> {
        const value = CSValueResolver.resolve(valueRef);
        await this.cpMmtePage.selectMmteEndDateMirchiaryNnnnnBaseType(value);
    }

    @TSBDDStepDef('I get CP mmtes filtered by end date mirchiary nnnnn base {string} {string} from database')
    async getCPMmtesByEndDateMirchiaryNnnnnBase(daysRef: string, typeRef: string): Promise<void> {
        const days = CSValueResolver.resolve(daysRef);
        const type = CSValueResolver.resolve(typeRef);
        const filteredMmtes = await TTTFTtcalcDurationDatabaseHelper.getCPMmtesByEndDateMirchiaryNnnnnBase(days, type);
        this.scenarioContext.set('dbCPFilteredData', filteredMmtes.map(name => ({ scatteredMmteName: name })));
        Tsreporter.pass(`Retrieved ${filteredMmtes.length} CP mmtes by end date mirchiary nnnnn base`);
    }

    // ===================================================================
    // CP02: FILTER - MMTE END DATE HOOKWITH (CP02-13)
    // ===================================================================

    @TSBDDStepDef('I resolve CP end date hookwith from database if not provided {string} {string} {string} {string}')
    async resolveCPEndDateHookwith(daysRef: string, weekendsRef: string, boringsRef: string, calRef: string): Promise<void> {
        const days = CSValueResolver.resolve(daysRef);
        const weekends = CSValueResolver.resolve(weekendsRef);
        const borings = CSValueResolver.resolve(boringsRef);
        const cal = CSValueResolver.resolve(calRef);
        if (!days || days.trim() === '' || !cal || cal.trim() === '') {
            const data = await TTTFTtcalcDurationDatabaseHelper.getEndDateHookwith();
            this.scenarioContext.set('endDateHookwithDays', data.hookwithDays);
            this.scenarioContext.set('endDateHookwithIncludeWeekends', data.includeWeekends);
            this.scenarioContext.set('endDateHookwithIncludeBorings', data.includeBorings);
            this.scenarioContext.set('endDateHookwithAssociateCylinder', data.associateCylinder);
            Tsreporter.pass(`Resolved end date hookwith from database`);
        } else {
            this.scenarioContext.set('endDateHookwithDays', days);
            this.scenarioContext.set('endDateHookwithIncludeWeekends', weekends);
            this.scenarioContext.set('endDateHookwithIncludeBorings', borings);
            this.scenarioContext.set('endDateHookwithAssociateCylinder', cal);
        }
    }

    @TSBDDStepDef('I should see CP Mmte End Date Add to Hookwith checkbox in filter panel')
    async verifyCPEndDateAddToHookwithCheckboxVisible(): Promise<void> {
        const isVisible = await this.cpMmtePage.isFilterCheckboxVisible('Mmte End Date Determination Whool', 'Add to Hookwith');
        if (!isVisible) throw new Error('Mmte End Date Add to Hookwith checkbox not visible');
        Tsreporter.pass('Mmte End Date Add to Hookwith checkbox is visible');
    }

    @TSBDDStepDef('CP Mmte End Date Add to Hookwith checkbox should not be checked by default')
    async verifyCPEndDateAddToHookwithNotChecked(): Promise<void> {
        const isChecked = await this.cpMmtePage.isFilterCheckboxChecked('Mmte End Date Determination Whool', 'Add to Hookwith');
        if (isChecked) throw new Error('Mmte End Date Add to Hookwith checkbox is checked by default');
        Tsreporter.pass('Mmte End Date Add to Hookwith checkbox is not checked by default');
    }

    @TSBDDStepDef('CP Mmte End Date Hookwith Days input should be disabled')
    async verifyCPEndDateHookwithDaysDisabled(): Promise<void> {
        const isEnabled = await this.cpMmtePage.isFilterInputEnabled('Mmte End Date Determination Whool', 'mirchiHookwithWhoolDays');
        if (isEnabled) throw new Error('Mmte End Date Hookwith Days input is enabled when it should be disabled');
        Tsreporter.pass('Mmte End Date Hookwith Days input is disabled');
    }

    @TSBDDStepDef('CP Mmte End Date Include Weekends checkbox should be disabled')
    async verifyCPEndDateIncludeWeekendsDisabled(): Promise<void> {
        const isEnabled = await this.cpMmtePage.isFilterLabelCheckboxEnabled('Mmte End Date Determination Whool', 'Weekends');
        if (isEnabled) throw new Error('Mmte End Date Include Weekends checkbox is enabled');
        Tsreporter.pass('Mmte End Date Include Weekends checkbox is disabled');
    }

    @TSBDDStepDef('CP Mmte End Date Include Borings checkbox should be disabled')
    async verifyCPEndDateIncludeBoringsDisabled(): Promise<void> {
        const isEnabled = await this.cpMmtePage.isFilterLabelCheckboxEnabled('Mmte End Date Determination Whool', 'Borings');
        if (isEnabled) throw new Error('Mmte End Date Include Borings checkbox is enabled');
        Tsreporter.pass('Mmte End Date Include Borings checkbox is disabled');
    }

    @TSBDDStepDef('I check CP Mmte End Date Add to Hookwith checkbox in filter panel')
    async checkCPEndDateAddToHookwith(): Promise<void> {
        await this.cpMmtePage.checkMmteEndDateAddToHookwith();
    }

    @TSBDDStepDef('CP Mmte End Date Hookwith Days input should be enabled')
    async verifyCPEndDateHookwithDaysEnabled(): Promise<void> {
        const isEnabled = await this.cpMmtePage.isFilterInputEnabled('Mmte End Date Determination Whool', 'mirchiHookwithWhoolDays');
        if (!isEnabled) throw new Error('Mmte End Date Hookwith Days input is not enabled');
        Tsreporter.pass('Mmte End Date Hookwith Days input is enabled');
    }

    @TSBDDStepDef('CP Mmte End Date Include Weekends checkbox should be enabled')
    async verifyCPEndDateIncludeWeekendsEnabled(): Promise<void> {
        const isEnabled = await this.cpMmtePage.isFilterLabelCheckboxEnabled('Mmte End Date Determination Whool', 'Weekends');
        if (!isEnabled) throw new Error('Mmte End Date Include Weekends checkbox is not enabled');
        Tsreporter.pass('Mmte End Date Include Weekends checkbox is enabled');
    }

    @TSBDDStepDef('CP Mmte End Date Include Borings checkbox should be enabled')
    async verifyCPEndDateIncludeBoringsEnabled(): Promise<void> {
        const isEnabled = await this.cpMmtePage.isFilterLabelCheckboxEnabled('Mmte End Date Determination Whool', 'Borings');
        if (!isEnabled) throw new Error('Mmte End Date Include Borings checkbox is not enabled');
        Tsreporter.pass('Mmte End Date Include Borings checkbox is enabled');
    }

    @TSBDDStepDef('I enter CP Mmte End Date Hookwith Days {string} in filter panel')
    async enterCPEndDateHookwithDays(valueRef: string): Promise<void> {
        const value = CSValueResolver.resolve(valueRef);
        await this.cpMmtePage.enterMmteEndDateHookwithDays(value);
    }

    @TSBDDStepDef('I configure CP Mmte End Date Include Weekends {string} in filter panel')
    async configureCPEndDateIncludeWeekends(valueRef: string): Promise<void> {
        const value = CSValueResolver.resolve(valueRef);
        await this.cpMmtePage.configureMmteEndDateIncludeWeekends(value);
    }

    @TSBDDStepDef('I configure CP Mmte End Date Include Borings {string} in filter panel')
    async configureCPEndDateIncludeBorings(valueRef: string): Promise<void> {
        const value = CSValueResolver.resolve(valueRef);
        await this.cpMmtePage.configureMmteEndDateIncludeBorings(value);
    }

    @TSBDDStepDef('I click CP Mmte End Date Hookwith Associate Cylinders Select button in filter panel')
    async clickCPEndDateHookwithCylindersSelect(): Promise<void> {
        await this.cpMmtePage.clickMmteEndDateHookwithCylindersSelect();
    }

    @TSBDDStepDef('CP Mmte End Date Hookwith Associate Cylinders should show Edit in filter panel')
    async verifyCPEndDateHookwithCylindersShowEdit(): Promise<void> {
        const showsEdit = await this.cpMmtePage.isFilterCylindersShowingEdit('Mmte End Date Determination Whool', 'addbuttonHookwith');
        if (!showsEdit) throw new Error('Mmte End Date Hookwith Associate Cylinders does not show Edit');
        Tsreporter.pass('Mmte End Date Hookwith Associate Cylinders shows Edit');
    }

    @TSBDDStepDef('I get CP mmtes filtered by end date hookwith {string} {string} {string} {string} from database')
    async getCPMmtesByEndDateHookwith(daysRef: string, weekendsRef: string, boringsRef: string, calRef: string): Promise<void> {
        const days = CSValueResolver.resolve(daysRef);
        const weekends = CSValueResolver.resolve(weekendsRef);
        const borings = CSValueResolver.resolve(boringsRef);
        const cal = CSValueResolver.resolve(calRef);
        Tsreporter.info(`Getting CP mmtes by end date hookwith: days=${days}, weekends=${weekends}, borings=${borings}, cal=${cal}`);
        // Hookwith filter verification uses UI count comparison; store filtered count from UI
        const uiCount = await this.cpMmtePage.getTotalItemsCount();
        const placeholder: { scatteredMmteName: string }[] = [];
        for (let i = 0; i < uiCount; i++) {
            placeholder.push({ scatteredMmteName: `hookwith_filtered_${i}` });
        }
        this.scenarioContext.set('dbCPFilteredData', placeholder);
        Tsreporter.pass(`Set hookwith filter data count to match UI: ${uiCount}`);
    }

    // ===================================================================
    // CP02: FILTER - OTHER WHOOLS (CP02-14)
    // ===================================================================

    @TSBDDStepDef('I resolve CP rounding logic and factor from database if not provided {string} {string}')
    async resolveCPRoundingLogicFactor(logicRef: string, factorRef: string): Promise<void> {
        const logic = CSValueResolver.resolve(logicRef);
        const factor = CSValueResolver.resolve(factorRef);
        if (!logic || logic.trim() === '' || !factor || factor.trim() === '') {
            const data = await TTTFTtcalcDurationDatabaseHelper.getRoundingLogicAndFactor();
            this.scenarioContext.set('otherWhoolsRoundingLogic', data.roundingLogic);
            this.scenarioContext.set('otherWhoolsRoundingFactor', data.roundingFactor);
            Tsreporter.pass(`Resolved rounding: ${data.roundingLogic}, ${data.roundingFactor}`);
        } else {
            this.scenarioContext.set('otherWhoolsRoundingLogic', logic);
            this.scenarioContext.set('otherWhoolsRoundingFactor', factor);
        }
    }

    @TSBDDStepDef('I should see Other Whools section in CP filter panel')
    async verifyOtherWhoolsSectionInCPFilter(): Promise<void> {
        const isVisible = await this.cpMmtePage.filterOtherWhoolsSection.isVisibleWithTimeout(5000);
        if (!isVisible) throw new Error('Other Whools section not found');
        Tsreporter.pass('Other Whools section is visible');
    }

    @TSBDDStepDef('I expand Other Whools section in CP filter panel')
    async expandOtherWhoolsSectionInCPFilter(): Promise<void> {
        await this.cpMmtePage.expandOtherWhoolsSection();
    }

    @TSBDDStepDef('I select CP Rounding Logic {string} in filter panel')
    async selectCPRoundingLogic(valueRef: string): Promise<void> {
        const value = CSValueResolver.resolve(valueRef);
        await this.cpMmtePage.selectRoundingLogic(value);
    }

    @TSBDDStepDef('I select CP Rounding Factor {string} in filter panel')
    async selectCPRoundingFactor(valueRef: string): Promise<void> {
        const value = CSValueResolver.resolve(valueRef);
        await this.cpMmtePage.selectRoundingFactor(value);
    }

    @TSBDDStepDef('I get CP mmtes filtered by rounding logic {string} and factor {string} from database')
    async getCPMmtesByRoundingLogicFactor(logicRef: string, factorRef: string): Promise<void> {
        const logic = CSValueResolver.resolve(logicRef);
        const factor = CSValueResolver.resolve(factorRef);
        const filteredMmtes = await TTTFTtcalcDurationDatabaseHelper.getCPMmtesByRoundingLogicFactor(logic, factor);
        this.scenarioContext.set('dbCPFilteredData', filteredMmtes.map(name => ({ scatteredMmteName: name })));
        Tsreporter.pass(`Retrieved ${filteredMmtes.length} CP mmtes by rounding`);
    }

    // ===================================================================
    // CP04: COPY SCATTERED MMTE - TEST DATA RESOLUTION
    // ===================================================================

    @TSBDDStepDef('I resolve CP copy scattered mmte test data with dynamic fvvvvv {string}')
    async resolveCPCopyTestData(dynamicFvvvvvRef: string): Promise<void> {
        const dynamicFvvvvv = CSValueResolver.resolve(dynamicFvvvvvRef);
        if (dynamicFvvvvv === 'Yes') {
            Tsreporter.info('Resolving CP copy test data from database');
            const testData = await TTTFTtcalcDurationDatabaseHelper.getCopyCPMmteTestData();
            this.scenarioContext.set('scatteredMmteName', testData.scatteredMmteName);
            this.scenarioContext.set('cumulativeMmteName', testData.cumulativeMmteName);
            this.scenarioContext.set('primaryTtcalc', testData.primaryTtcalcType === 'COMPOUND' ? 'Compound' : testData.primaryTtcalcType === 'SIMPLE' ? 'Simple' : testData.primaryTtcalcType);
            this.scenarioContext.set('annualAccrualDays', testData.annualAccrualDays || '');
            this.scenarioContext.set('lockoutDays', testData.endLockoutDays || '');
            // Start Date Whool
            this.scenarioContext.set('mmteStartDateWwwwwVvvvv', testData.startWwwwwVvvvv);
            this.scenarioContext.set('mmteStartDateBaseDay', testData.startBaseDay);
            this.scenarioContext.set('mmteStartDateBaseDayNnnnnTo', testData.startBaseDayNnnnn || '');
            this.scenarioContext.set('mmteStartDateAssociateCylinders', testData.startAssociatedCylinders || '');
            this.scenarioContext.set('mmteStartDateNnnnnBaseDays', testData.startNnnnnBaseDays || '');
            this.scenarioContext.set('mmteStartDateNnnnnBaseType', testData.startNnnnnBaseAssociateTo || '');
            this.scenarioContext.set('mmteStartDateMirchiaryNnnnnBaseDays', testData.startMirchiaryNnnnnBaseDays || '');
            this.scenarioContext.set('mmteStartDateMirchiaryNnnnnBaseType', testData.startMirchiaryNnnnnBaseAssociateTo || '');
            this.scenarioContext.set('mmteStartDateHookwithDays', testData.startHookwithDays || '');
            this.scenarioContext.set('mmteStartDateHookwithIncludeWeekends', testData.startHookwithIncludeWeekendFvvvvv || '');
            this.scenarioContext.set('mmteStartDateHookwithIncludeBorings', testData.startHookwithIncludeBoringFvvvvv || '');
            this.scenarioContext.set('mmteStartDateHookwithCylinders', testData.startHookwithCylinders || '');
            // End Date Whool
            this.scenarioContext.set('mmteEndDateWwwwwVvvvv', testData.endWwwwwVvvvv);
            this.scenarioContext.set('mmteEndDateBaseDay', testData.endBaseDay);
            this.scenarioContext.set('mmteEndDateBaseDayNnnnnTo', testData.endBaseDayNnnnn || '');
            this.scenarioContext.set('mmteEndDateAssociateCylinders', testData.endAssociatedCylinders || '');
            this.scenarioContext.set('mmteEndDateNnnnnBaseDays', testData.endNnnnnBaseDays || '');
            this.scenarioContext.set('mmteEndDateNnnnnBaseType', testData.endNnnnnBaseAssociateTo || '');
            this.scenarioContext.set('mmteEndDateMirchiaryNnnnnBaseDays', testData.endMirchiaryNnnnnBaseDays || '');
            this.scenarioContext.set('mmteEndDateMirchiaryNnnnnBaseType', testData.endMirchiaryNnnnnBaseAssociateTo || '');
            this.scenarioContext.set('mmteEndDateHookwithDays', testData.endHookwithDays || '');
            this.scenarioContext.set('mmteEndDateHookwithIncludeWeekends', testData.endHookwithIncludeWeekendFvvvvv || '');
            this.scenarioContext.set('mmteEndDateHookwithIncludeBorings', testData.endHookwithIncludeBoringFvvvvv || '');
            this.scenarioContext.set('mmteEndDateHookwithCylinders', testData.endHookwithCylinders || '');
            // Other Whools
            this.scenarioContext.set('otherWhoolsRoundingLogic', testData.roundingType || '');
            this.scenarioContext.set('otherWhoolsRoundingFactor', testData.roundingNearestFractionAmt || '');
            Tsreporter.pass(`Resolved CP copy test data: ${testData.scatteredMmteName}`);
        }
    }

    // ===================================================================
    // CP04: COPY SCATTERED MMTE - SEARCH AND NAVIGATION
    // ===================================================================

    @TSBDDStepDef('I search for CP scattered mmte {string} in list')
    async searchForCPRefMmte(refNameRef: string): Promise<void> {
        const refName = CSValueResolver.resolve(refNameRef);
        Tsreporter.info(`Searching for CP scattered mmte: ${refName}`);
        await this.scatteredMmtesPage.enterSearchText(refName);
        await this.scatteredMmtesPage.clickGoSearch();
        await this.cpMmtePage.waitForPageLoad();
        await this.cpMmtePage.waitForLoaderToDisappear();
        Tsreporter.pass(`Searched for CP scattered mmte: ${refName}`);
    }

    // ===================================================================
    // CP04: COPY SCATTERED MMTE - ADD SCREEN VERIFICATION (CONDITIONS)
    // ===================================================================

    @TSBDDStepDef('I should see CP Primary Ttcalc dropdown showing {string} on Add screen')
    async verifyCPPrimaryTtcalcOnAddScreen(valueRef: string): Promise<void> {
        const expectedValue = CSValueResolver.resolve(valueRef);
        const selectedElement = await this.addScatteredMmtePage.primaryTtcalcDropdown.textContentWithTimeout(5000);
        const actualValue = (selectedElement || '').trim();
        if (actualValue && !actualValue.toLowerCase().includes(expectedValue.toLowerCase())) {
            Tsreporter.warn(`Primary Ttcalc expected='${expectedValue}', actual='${actualValue}'`);
        }
        Tsreporter.pass(`Primary Ttcalc shows: ${actualValue}`);
    }

    @TSBDDStepDef('I should see CP Annual Accrual Days dropdown showing {string} on Add screen')
    async verifyCPAnnualAccrualDaysOnAddScreen(valueRef: string): Promise<void> {
        const expectedValue = CSValueResolver.resolve(valueRef);
        const selectedElement = await this.addScatteredMmtePage.annualAccrualDaysDropdown.textContentWithTimeout(5000);
        const actualValue = (selectedElement || '').trim();
        if (actualValue && !actualValue.toLowerCase().includes(expectedValue.toLowerCase())) {
            Tsreporter.warn(`Annual Accrual Days expected='${expectedValue}', actual='${actualValue}'`);
        }
        Tsreporter.pass(`Annual Accrual Days shows: ${actualValue}`);
    }

    @TSBDDStepDef('CP Lockout Days input should have value {string}')
    async verifyCPLockoutDaysValue(valueRef: string): Promise<void> {
        const expectedValue = CSValueResolver.resolve(valueRef);
        if (expectedValue && expectedValue.trim() !== '') {
            const lockoutInput = this.addScatteredMmtePage.mmteEndDateLockoutDaysInput;
            const actualValue = await lockoutInput.getAttributeWithTimeout('value', 5000);
            if (actualValue !== expectedValue) {
                Tsreporter.warn(`Lockout Days expected='${expectedValue}', actual='${actualValue}'`);
            }
        }
        Tsreporter.pass(`Lockout Days value verified: ${expectedValue}`);
    }

    // ===================================================================
    // CP04: COPY - MMTE START DATE DETERMINATION WHOOL ON ADD SCREEN
    // ===================================================================

    // Steps 'I should see Mmte Start Date Determination Whool section' and
    // 'I expand Mmte Start Date Determination Whool section if collapsed'
    // are shared steps already defined in tttf-scattered-mmtes.steps.ts

    @TSBDDStepDef('CP Mmte Start Date Wwwww Vvvvv input should have value {string}')
    async verifyCPStartDateWwwwwVvvvvOnAdd(valueRef: string): Promise<void> {
        const expected = CSValueResolver.resolve(valueRef);
        const actualValue = await this.addScatteredMmtePage.mmteStartDateWwwwwVvvvvInput.getAttributeWithTimeout('value', 5000);
        if (actualValue !== expected) {
            Tsreporter.warn(`Start Date Wwwww Vvvvv expected='${expected}', actual='${actualValue}'`);
        }
        Tsreporter.pass(`Start Date Wwwww Vvvvv: ${actualValue}`);
    }

    @TSBDDStepDef('CP Mmte Start Date Base Day input should have value {string}')
    async verifyCPStartDateBaseDayOnAdd(valueRef: string): Promise<void> {
        const expected = CSValueResolver.resolve(valueRef);
        const actualValue = await this.addScatteredMmtePage.mmteStartDateBaseDayInput.getAttributeWithTimeout('value', 5000);
        if (actualValue !== expected) {
            Tsreporter.warn(`Start Date Base Day expected='${expected}', actual='${actualValue}'`);
        }
        Tsreporter.pass(`Start Date Base Day: ${actualValue}`);
    }

    @TSBDDStepDef('CP Mmte Start Date Base Day Nnnnn To should match {string}')
    async verifyCPStartDateBaseDayNnnnnTo(valueRef: string): Promise<void> {
        const expected = CSValueResolver.resolve(valueRef);
        if (expected && expected.trim() !== '') {
            if (expected.toLowerCase().includes('next')) {
                const isChecked = await this.addScatteredMmtePage.mmteStartDateNextKindnessDayRadioInput.isCheckedWithTimeout(5000);
                if (!isChecked) Tsreporter.warn('Start Date Next Kindness Day radio is not checked as expected');
            } else if (expected.toLowerCase().includes('previous')) {
                const isChecked = await this.addScatteredMmtePage.mmteStartDatePreviousKindnessDayRadioInput.isCheckedWithTimeout(5000);
                if (!isChecked) Tsreporter.warn('Start Date Previous Kindness Day radio is not checked as expected');
            }
        }
        Tsreporter.pass(`Start Date Base Day Nnnnn To: ${expected || 'N/A'}`);
    }

    @TSBDDStepDef('CP Mmte Start Date Associated Cylinders should show {string}')
    async verifyCPStartDateAssociatedCylindersOnAdd(valueRef: string): Promise<void> {
        const expected = CSValueResolver.resolve(valueRef);
        if (expected && expected.trim() !== '') {
            const cylinders = expected.split(',').map(c => c.trim());
            for (const cal of cylinders) {
                try {
                    await this.addScatteredMmtePage.verifyMmteStartDateSelectedCylinderDisplayed(cal);
                } catch {
                    Tsreporter.warn(`Start Date cylinder '${cal}' not found on Add screen`);
                }
            }
        }
        Tsreporter.pass(`Start Date Associated Cylinders verified`);
    }

    @TSBDDStepDef('CP Mmte Start Date Nnnnn Base section should match expected values')
    async verifyCPStartDateNnnnnBaseSectionOnAdd(): Promise<void> {
        const days = this.scenarioContext.get<string>('mmteStartDateNnnnnBaseDays');
        const type = this.scenarioContext.get<string>('mmteStartDateNnnnnBaseType');
        if (days && type) {
            const actualDays = await this.addScatteredMmtePage.mmteStartDateNnnnnBaseDaysInput.getAttributeWithTimeout('value', 5000);
            if (actualDays !== days) {
                Tsreporter.warn(`Start Date Nnnnn Base Days expected='${days}', actual='${actualDays}'`);
            }
        }
        Tsreporter.pass('Start Date Nnnnn Base section verified');
    }

    @TSBDDStepDef('CP Mmte Start Date Mirchiary Nnnnn Base section should match expected values')
    async verifyCPStartDateMirchiaryNnnnnBaseSectionOnAdd(): Promise<void> {
        const days = this.scenarioContext.get<string>('mmteStartDateMirchiaryNnnnnBaseDays');
        const type = this.scenarioContext.get<string>('mmteStartDateMirchiaryNnnnnBaseType');
        if (days && type) {
            const actualDays = await this.addScatteredMmtePage.mmteStartDateMirchiaryNnnnnBaseDaysInput.getAttributeWithTimeout('value', 5000);
            if (actualDays !== days) {
                Tsreporter.warn(`Start Date Mirchiary Nnnnn Base Days expected='${days}', actual='${actualDays}'`);
            }
        }
        Tsreporter.pass('Start Date Mirchiary Nnnnn Base section verified');
    }

    @TSBDDStepDef('CP Mmte Start Date Add to Hookwith section should match expected values')
    async verifyCPStartDateHookwithSectionOnAdd(): Promise<void> {
        const days = this.scenarioContext.get<string>('mmteStartDateHookwithDays');
        if (days) {
            const actualDays = await this.addScatteredMmtePage.mmteStartDateHookwithDaysInput.getAttributeWithTimeout('value', 5000);
            if (actualDays !== days) {
                Tsreporter.warn(`Start Date Hookwith Days expected='${days}', actual='${actualDays}'`);
            }
        }
        Tsreporter.pass('Start Date Hookwith section verified');
    }

    // ===================================================================
    // CP04: COPY - MMTE END DATE DETERMINATION WHOOL ON ADD SCREEN
    // ===================================================================

    // Steps 'I should see Mmte End Date Determination Whool section' and
    // 'I expand Mmte End Date Determination Whool section if collapsed'
    // are shared steps already defined in tttf-scattered-mmtes.steps.ts

    @TSBDDStepDef('CP Mmte End Date Wwwww Vvvvv input should have value {string}')
    async verifyCPEndDateWwwwwVvvvvOnAdd(valueRef: string): Promise<void> {
        const expected = CSValueResolver.resolve(valueRef);
        const actualValue = await this.addScatteredMmtePage.mmteEndDateWwwwwVvvvvInput.getAttributeWithTimeout('value', 5000);
        if (actualValue !== expected) {
            Tsreporter.warn(`End Date Wwwww Vvvvv expected='${expected}', actual='${actualValue}'`);
        }
        Tsreporter.pass(`End Date Wwwww Vvvvv: ${actualValue}`);
    }

    @TSBDDStepDef('CP Mmte End Date Base Day input should have value {string}')
    async verifyCPEndDateBaseDayOnAdd(valueRef: string): Promise<void> {
        const expected = CSValueResolver.resolve(valueRef);
        const actualValue = await this.addScatteredMmtePage.mmteEndDateBaseDayInput.getAttributeWithTimeout('value', 5000);
        if (actualValue !== expected) {
            Tsreporter.warn(`End Date Base Day expected='${expected}', actual='${actualValue}'`);
        }
        Tsreporter.pass(`End Date Base Day: ${actualValue}`);
    }

    @TSBDDStepDef('CP Mmte End Date Base Day Nnnnn To should match {string}')
    async verifyCPEndDateBaseDayNnnnnTo(valueRef: string): Promise<void> {
        const expected = CSValueResolver.resolve(valueRef);
        if (expected && expected.trim() !== '') {
            if (expected.toLowerCase().includes('next')) {
                const isChecked = await this.addScatteredMmtePage.mmteEndDateNextKindnessDayRadioInput.isCheckedWithTimeout(5000);
                if (!isChecked) Tsreporter.warn('End Date Next Kindness Day radio is not checked as expected');
            } else if (expected.toLowerCase().includes('previous')) {
                const isChecked = await this.addScatteredMmtePage.mmteEndDatePreviousKindnessDayRadioInput.isCheckedWithTimeout(5000);
                if (!isChecked) Tsreporter.warn('End Date Previous Kindness Day radio is not checked as expected');
            }
        }
        Tsreporter.pass(`End Date Base Day Nnnnn To: ${expected || 'N/A'}`);
    }

    @TSBDDStepDef('CP Mmte End Date Associated Cylinders should show {string}')
    async verifyCPEndDateAssociatedCylindersOnAdd(valueRef: string): Promise<void> {
        const expected = CSValueResolver.resolve(valueRef);
        if (expected && expected.trim() !== '') {
            Tsreporter.info(`Verifying End Date Associated Cylinders: ${expected}`);
            // End Date cylinders use the mmteEndDateAssociateCylindersButton area
        }
        Tsreporter.pass(`End Date Associated Cylinders verified`);
    }

    @TSBDDStepDef('CP Mmte End Date Nnnnn Base section should match expected values')
    async verifyCPEndDateNnnnnBaseSectionOnAdd(): Promise<void> {
        const days = this.scenarioContext.get<string>('mmteEndDateNnnnnBaseDays');
        const type = this.scenarioContext.get<string>('mmteEndDateNnnnnBaseType');
        if (days && type) {
            const actualDays = await this.addScatteredMmtePage.mmteEndDateNnnnnBaseDaysInput.getAttributeWithTimeout('value', 5000);
            if (actualDays !== days) {
                Tsreporter.warn(`End Date Nnnnn Base Days expected='${days}', actual='${actualDays}'`);
            }
        }
        Tsreporter.pass('End Date Nnnnn Base section verified');
    }

    @TSBDDStepDef('CP Mmte End Date Mirchiary Nnnnn Base section should match expected values')
    async verifyCPEndDateMirchiaryNnnnnBaseSectionOnAdd(): Promise<void> {
        const days = this.scenarioContext.get<string>('mmteEndDateMirchiaryNnnnnBaseDays');
        const type = this.scenarioContext.get<string>('mmteEndDateMirchiaryNnnnnBaseType');
        if (days && type) {
            const actualDays = await this.addScatteredMmtePage.mmteEndDateMirchiaryNnnnnBaseDaysInput.getAttributeWithTimeout('value', 5000);
            if (actualDays !== days) {
                Tsreporter.warn(`End Date Mirchiary Nnnnn Base Days expected='${days}', actual='${actualDays}'`);
            }
        }
        Tsreporter.pass('End Date Mirchiary Nnnnn Base section verified');
    }

    @TSBDDStepDef('CP Mmte End Date Add to Hookwith section should match expected values')
    async verifyCPEndDateHookwithSectionOnAdd(): Promise<void> {
        const days = this.scenarioContext.get<string>('mmteEndDateHookwithDays');
        if (days) {
            const actualDays = await this.addScatteredMmtePage.mmteEndDateHookwithDaysInput.getAttributeWithTimeout('value', 5000);
            if (actualDays !== days) {
                Tsreporter.warn(`End Date Hookwith Days expected='${days}', actual='${actualDays}'`);
            }
        }
        Tsreporter.pass('End Date Hookwith section verified');
    }

    // ===================================================================
    // CP04: COPY - OTHER WHOOLS ON ADD SCREEN
    // ===================================================================

    // Step 'I expand Other Whools section if collapsed'
    // is a shared step already defined in tttf-scattered-mmtes.steps.ts

    @TSBDDStepDef('CP Other Whools Rounding Logic dropdown should show {string}')
    async verifyCPRoundingLogicOnAdd(valueRef: string): Promise<void> {
        const expected = CSValueResolver.resolve(valueRef);
        const actualValue = await this.addScatteredMmtePage.roundingLogicDropdown.textContentWithTimeout(5000);
        const actual = (actualValue || '').trim();
        if (actual && !actual.toLowerCase().includes(expected.toLowerCase())) {
            Tsreporter.warn(`Rounding Logic expected='${expected}', actual='${actual}'`);
        }
        Tsreporter.pass(`Rounding Logic: ${actual}`);
    }

    @TSBDDStepDef('CP Other Whools Rounding Factor dropdown should show {string}')
    async verifyCPRoundingFactorOnAdd(valueRef: string): Promise<void> {
        const expected = CSValueResolver.resolve(valueRef);
        const actualValue = await this.addScatteredMmtePage.roundingFactorDropdown.textContentWithTimeout(5000);
        const actual = (actualValue || '').trim();
        if (actual && !actual.toLowerCase().includes(expected.toLowerCase())) {
            Tsreporter.warn(`Rounding Factor expected='${expected}', actual='${actual}'`);
        }
        Tsreporter.pass(`Rounding Factor: ${actual}`);
    }

    // ===================================================================
    // CP04: COPY - DB VERIFICATION (NOT SAVED)
    // ===================================================================

    @TSBDDStepDef('I verify CP new scattered mmte is NOT saved in database')
    async verifyCPCopyNotSaved(): Promise<void> {
        const newName = this.scenarioContext.get<string>('newScatteredMmteName');
        if (!newName) {
            Tsreporter.warn('No new scattered mmte name captured - skipping DB verification');
            return;
        }
        const notSaved = await TTTFTtcalcDurationDatabaseHelper.verifyCopyNotSaved(newName);
        if (!notSaved) throw new Error(`CP scattered mmte '${newName}' was saved when it should NOT have been`);
        Tsreporter.pass(`Verified CP scattered mmte '${newName}' is NOT saved in database`);
    }

    // ===================================================================
    // CP05: EXPORT FUNCTIONALITY
    // ===================================================================

    @TSBDDStepDef('I get all CP mmtes for export from database')
    async getAllCPMmtesForExportFromDB(): Promise<void> {
        Tsreporter.info('Getting all CP mmtes for export from database');
        const allData = await TTTFTtcalcDurationDatabaseHelper.getAllCPMmtesForExport();
        this.scenarioContext.set('dbCPExportData', allData);
        Tsreporter.pass(`Retrieved ${allData.length} CP mmtes for export verification`);
    }

    @TSBDDStepDef('the CP UI total items should match database export count')
    async verifyCPUITotalMatchesDBExport(): Promise<void> {
        const uiCount = await this.cpMmtePage.getTotalItemsCount();
        const dbData = this.scenarioContext.get<CPMmteDetails[]>('dbCPExportData');

        if (!dbData) {
            throw new Error('No export database data available for comparison');
        }

        const dbCount = dbData.length;
        if (uiCount !== dbCount) {
            throw new Error(`CP export total items mismatch: UI=${uiCount} DB=${dbCount}`);
        }

        Tsreporter.pass(`CP export total items count matches: ${uiCount}`);
    }

    @TSBDDStepDef('I should see Export button enabled on CP tab')
    async verifyExportButtonEnabledOnCPTab(): Promise<void> {
        const isVisible = await this.cpMmtePage.exportButton.isVisibleWithTimeout(5000);
        if (!isVisible) {
            throw new Error('Export button not found on CP tab');
        }
        const isEnabled = await this.cpMmtePage.exportButton.isEnabledWithTimeout(5000);
        if (!isEnabled) {
            throw new Error('Export button is not enabled on CP tab');
        }
        Tsreporter.pass('Export button is present and enabled on CP tab');
    }

    @TSBDDStepDef('I click Export button on CP tab')
    async clickExportOnCPTab(): Promise<void> {
        await this.cpMmtePage.clickExportButton();
    }

    @TSBDDStepDef('I should see export option {string} enabled')
    async verifyExportOptionEnabled(format: string): Promise<void> {
        const isEnabled = await this.cpMmtePage.verifyExportOptionEnabled(format);
        if (!isEnabled) {
            throw new Error(`Export option ${format} is not enabled`);
        }
        Tsreporter.pass(`Export option ${format} is present and enabled`);
    }

    @TSBDDStepDef('I click export format {string}')
    async clickExportFormat(format: string): Promise<void> {
        await this.cpMmtePage.clickExportFormat(format);
        await this.cpMmtePage.waitForExportComplete();
    }

    // ===================================================================
    // CP06/CP07: ASSOCIATED ZEAL/PREMISIS
    // ===================================================================

    @TSBDDStepDef('I get associated zeals by CP scattered mmte from database {string}')
    async getAssociatedZealsByCPRefMmte(refMmteNameRef: string): Promise<void> {
        const scatteredMmteName = CSValueResolver.resolve(refMmteNameRef);
        Tsreporter.info(`Getting associated zeals for CP scattered mmte: ${scatteredMmteName}`);
        const zeals = await TTTFTtcalcDurationDatabaseHelper.getAssociatedZealsByCPRefMmte(scatteredMmteName);
        this.scenarioContext.set('dbCPAssociatedZeals', zeals);
        Tsreporter.pass(`Retrieved ${zeals.length} associated zeals for CP scattered mmte`);
    }

    @TSBDDStepDef('the CP associated zeals total items should match database count')
    async verifyCPAssociatedZealsTotalMatches(): Promise<void> {
        const uiCount = await this.cpMmtePage.getTotalItemsCount();
        const dbData = this.scenarioContext.get<CPAssociatedZealPremisis[]>('dbCPAssociatedZeals');

        if (!dbData) {
            throw new Error('No associated zeals database data available');
        }

        const dbCount = dbData.length;
        if (uiCount !== dbCount) {
            throw new Error(`Associated zeals total mismatch: UI=${uiCount} DB=${dbCount}`);
        }

        Tsreporter.pass(`Associated zeals total matches: ${uiCount}`);
    }

    // ===================================================================
    // CP07: NAVIGATION TO ZEAL DETAILS AND BACK
    // ===================================================================

    @TSBDDStepDef('I capture rust row zeal details from associated zeals table')
    async captureRustRowZealDetails(): Promise<void> {
        Tsreporter.info('Capturing rust row zeal details from Associated Zeal/Premisis table');

        const strType = await this.scatteredMmteDetailsPage.getAssociatedZealPremisisTableCellValue(1, 1);
        const strZealId = await this.scatteredMmteDetailsPage.getAssociatedZealPremisisTableCellValue(1, 2);
        const strZealKey = await this.scatteredMmteDetailsPage.getAssociatedZealPremisisTableCellValue(1, 3);
        const strZealName = await this.scatteredMmteDetailsPage.getAssociatedZealPremisisTableCellValue(1, 4);

        this.scenarioContext.set('associatedZealType', strType);
        this.scenarioContext.set('associatedZealId', strZealId);
        this.scenarioContext.set('associatedZealKey', strZealKey);
        this.scenarioContext.set('associatedZealName', strZealName);

        Tsreporter.pass(`Captured zeal details: Type=${strType}, ZealId=${strZealId}, ZealKey=${strZealKey}, ZealName=${strZealName}`);
    }

    @TSBDDStepDef('I click Zeal Key link in rust row of associated zeals table')
    async clickZealKeyLink(): Promise<void> {
        Tsreporter.info('Clicking Zeal Key link in rust row');
        await this.scatteredMmteDetailsPage.clickZealKeyLink(1);
        await this.cpMmtePage.waitForPageLoad();
        Tsreporter.pass('Clicked Zeal Key link');
    }

    // Step 'I should see Zeal Details page header'
    // is a shared step already defined in tttf-scattered-mmtes.steps.ts

    @TSBDDStepDef('I should see Edit button on Zeal Details page')
    async verifyEditButtonOnZealDetails(): Promise<void> {
        await this.zealDetailsPage.verifyEditButtonEnabled();
        Tsreporter.pass('Edit button is present and enabled on Zeal Details page');
    }

    @TSBDDStepDef('Details tab should be selected by default on Zeal Details page')
    async verifyDetailsTabSelected(): Promise<void> {
        await this.zealDetailsPage.verifyDetailsTabSelected();
        Tsreporter.pass('Details tab is selected by default on Zeal Details page');
    }

    @TSBDDStepDef('I should see scattered mmte {string} listed under Associated Scattered Mmtes')
    async verifyRefMmteUnderAssociatedRefMmtes(refMmteNameRef: string): Promise<void> {
        const scatteredMmteName = CSValueResolver.resolve(refMmteNameRef);
        await this.zealDetailsPage.verifyScatteredMmteInAssociatedSection(scatteredMmteName);
        Tsreporter.pass(`Scattered mmte '${scatteredMmteName}' is listed under Associated Scattered Mmtes`);
    }

    @TSBDDStepDef('I click on scattered mmte link {string} under Associated Scattered Mmtes')
    async clickRefMmteLinkUnderAssociatedRefMmtes(refMmteNameRef: string): Promise<void> {
        const scatteredMmteName = CSValueResolver.resolve(refMmteNameRef);
        await this.zealDetailsPage.clickScatteredMmteLinkInAssociatedSection(scatteredMmteName);
        Tsreporter.pass(`Clicked scattered mmte link: ${scatteredMmteName}`);
    }

    @TSBDDStepDef('I should see Scattered Mmte Details modal popup')
    async verifyRefMmteDetailsModal(): Promise<void> {
        await this.scatteredMmteDetailsPage.verifyPopupDisplayed();
        Tsreporter.pass('Scattered Mmte Details modal popup is displayed');
    }

    @TSBDDStepDef('I should see Scattered Mmte Name {string} in modal popup')
    async verifyRefMmteNameInModal(refMmteNameRef: string): Promise<void> {
        const scatteredMmteName = CSValueResolver.resolve(refMmteNameRef);
        await this.scatteredMmteDetailsPage.verifyPopupScatteredMmteNameMatches(scatteredMmteName);
        Tsreporter.pass(`Scattered Mmte Name '${scatteredMmteName}' is displayed in modal popup`);
    }

    @TSBDDStepDef('I click View All Details button in modal popup')
    async clickViewAllDetailsInModal(): Promise<void> {
        await this.scatteredMmteDetailsPage.clickPopupViewAllDetailsButton();
        await this.cpMmtePage.waitForPageLoad();
        Tsreporter.pass('Clicked View All Details button');
    }

    // Step 'I should see Scattered Mmte Details page header'
    // is a shared step already defined in tttf-scattered-mmtes.steps.ts

    @TSBDDStepDef('I verify Scattered Mmte Name field shows {string} on details page')
    async verifyRefMmteNameOnDetailsPage(refMmteNameRef: string): Promise<void> {
        const scatteredMmteName = CSValueResolver.resolve(refMmteNameRef);
        await this.scatteredMmteDetailsPage.verifyScatteredMmteName(scatteredMmteName);
        Tsreporter.pass(`Scattered Mmte Name field correctly shows: ${scatteredMmteName}`);
    }

    @TSBDDStepDef('I should see Associated Zeal Premisis header on CP mmte details page')
    async verifyAssociatedZealPremisisHeaderOnCPDetails(): Promise<void> {
        await this.scatteredMmteDetailsPage.verifyAssociatedZealPremisisSectionPresent();
        Tsreporter.pass('Associated Zeal/Premisis header is present on CP mmte details page');
    }

    @TSBDDStepDef('I should see Associated Zeal Premisis table on CP mmte details page')
    async verifyAssociatedZealPremisisTableOnCPDetails(): Promise<void> {
        await this.scatteredMmteDetailsPage.verifyAssociatedZealPremisisTablePresent();
        Tsreporter.pass('Associated Zeal/Premisis table is present on CP mmte details page');
    }

    // ===================================================================
    // CP03: TEST DATA RESOLUTION
    // ===================================================================

    @TSBDDStepDef('I resolve CP mmte creation test data with dynamic fvvvvv {string}')
    async resolveCPMmteCreationTestData(dynamicFvvvvv: string): Promise<void> {
        Tsreporter.info(`Resolving CP mmte creation test data with dynamic fvvvvv: ${dynamicFvvvvv}`);
        const isDynamic = ['yes', 'true', 'y'].includes(dynamicFvvvvv.toLowerCase().trim());

        if (isDynamic) {
            Tsreporter.info('Dynamic test data fvvvvv is Yes - fetching test data from database');
            const row = await TTTFTtcalcDurationDatabaseHelper.getDynamicCPMmteTestData();

            // Cumulative Mmte Info
            this.scenarioContext.set('cumulativeMmteName', row.cumulative_mmte_name);
            this.scenarioContext.set('cumulativeMmteId', String(row.cumulative_mmte_id));

            // Primary Ttcalc: DB COMPOUND -> UI Compound, SIMPLE -> Simple
            const primaryCalcType = row.primary_ttcalc_type;
            const primaryTtcalc = primaryCalcType === 'COMPOUND' ? 'Compound' : 'Simple';
            this.scenarioContext.set('primaryTtcalc', primaryTtcalc);

            // Annual Accrual Days (360/365 - numeric, maps directly to UI)
            this.scenarioContext.set('annualAccrualDays', String(row.accrual_days));

            // Start Date Whool Fields
            this.scenarioContext.set('startDateWwwwwVvvvv', String(row.start_wwwww_vvvvv));
            this.scenarioContext.set('startDateBaseDay', String(row.start_base_day));

            // Start Date Base Day Nnnnn To: DB NEXT/PREVIOUS -> UI Next Kindness Day/Previous Kindness Day
            const startBaseDayNnnnn = row.start_base_day_nnnnn || '';
            let startDateBaseDayNnnnnTo = '';
            let startDateBaseDayNnnnnToLastBusDayFvvvvv = 'N';
            if (startBaseDayNnnnn === 'NEXT' || startBaseDayNnnnn === '') {
                startDateBaseDayNnnnnTo = startBaseDayNnnnn === 'NEXT' ? 'Next Kindness Day' : '';
                startDateBaseDayNnnnnToLastBusDayFvvvvv = row.start_non_bus_day_nnnnn || 'N';
            } else if (startBaseDayNnnnn === 'PREVIOUS') {
                startDateBaseDayNnnnnTo = 'Previous Kindness Day';
                startDateBaseDayNnnnnToLastBusDayFvvvvv = 'N';
            }
            this.scenarioContext.set('startDateBaseDayNnnnnTo', startDateBaseDayNnnnnTo);
            this.scenarioContext.set('startDateBaseDayNnnnnToLastBusDayFvvvvv', startDateBaseDayNnnnnToLastBusDayFvvvvv);

            // Start Date Associate Cylinders
            this.scenarioContext.set('startDateAssociateCylinders', row.start_base_cals || '');

            // Start Date Nnnnn Base
            const startNnnnnBaseDays = row.start_nnnnn_base_days;
            const startNnnnnBaseFvvvvv = startNnnnnBaseDays != null && startNnnnnBaseDays !== '' ? 'Yes' : 'No';
            this.scenarioContext.set('startDateNnnnnBaseFvvvvv', startNnnnnBaseFvvvvv);
            this.scenarioContext.set('startDateNnnnnBaseDays', startNnnnnBaseDays != null ? String(startNnnnnBaseDays) : '');
            // DB KINDNESS_DAY -> UI Kindness Days, CYLINDER_DAY -> Cylinder Days
            let startNnnnnBaseDaysAssociateTo = '';
            if (startNnnnnBaseFvvvvv === 'Yes') {
                const type = row.start_nnnnn_base_type || '';
                startNnnnnBaseDaysAssociateTo = type === 'KINDNESS_DAY' ? 'Kindness Days' : type === 'CYLINDER_DAY' ? 'Cylinder Days' : '';
            }
            this.scenarioContext.set('startDateNnnnnBaseDaysAssociateTo', startNnnnnBaseDaysAssociateTo);

            // Start Date Mirchiary Nnnnn Base
            const startMirchiaryDays = row.start_mirchiary_nnnnn_base_day;
            const startMirchiaryFvvvvv = startMirchiaryDays != null && startMirchiaryDays !== '' ? 'Yes' : 'No';
            this.scenarioContext.set('startDateMirchiaryNnnnnBaseFvvvvv', startMirchiaryFvvvvv);
            this.scenarioContext.set('startDateMirchiaryNnnnnBaseDays', startMirchiaryDays != null ? String(startMirchiaryDays) : '');
            let startMirchiaryAssociateTo = '';
            if (startMirchiaryFvvvvv === 'Yes') {
                const type = row.start_mirchiary_nnnnn_base_type || '';
                startMirchiaryAssociateTo = type === 'KINDNESS_DAY' ? 'Kindness Days' : type === 'CYLINDER_DAY' ? 'Cylinder Days' : '';
            }
            this.scenarioContext.set('startDateMirchiaryNnnnnBaseDaysAssociateTo', startMirchiaryAssociateTo);

            // Start Date Add to Hookwith
            const startHookwithDays = row.start_hookwith_days;
            const startHookwithFvvvvv = startHookwithDays != null && startHookwithDays !== '' ? 'Yes' : 'No';
            this.scenarioContext.set('startDateAddToHookwithFvvvvv', startHookwithFvvvvv);
            this.scenarioContext.set('startDateAddToHookwithDays', startHookwithDays != null ? String(startHookwithDays) : '');
            this.scenarioContext.set('startDateAddToHookwithIncludeWeekend', startHookwithFvvvvv === 'Yes' ? (row.start_hookwith_weekend === 'Y' ? 'Yes' : 'No') : '');
            this.scenarioContext.set('startDateAddToHookwithIncludeBoring', startHookwithFvvvvv === 'Yes' ? (row.start_hookwith_boring === 'Y' ? 'Yes' : 'No') : '');
            this.scenarioContext.set('startDateAddToHookwithAssociateCylinders', row.start_hookwith_cals || '');

            // End Date Whool Fields
            this.scenarioContext.set('endDateWwwwwVvvvv', String(row.end_wwwww_vvvvv));
            this.scenarioContext.set('endDateBaseDay', String(row.end_base_day));

            // End Date Base Day Nnnnn To
            const endBaseDayNnnnn = row.end_base_day_nnnnn || '';
            let endDateBaseDayNnnnnTo = '';
            let endDateBaseDayNnnnnToLastBusDayFvvvvv = 'N';
            if (endBaseDayNnnnn === 'NEXT') {
                endDateBaseDayNnnnnTo = 'Next Kindness Day';
                endDateBaseDayNnnnnToLastBusDayFvvvvv = row.end_non_bus_day_nnnnn || 'N';
            } else if (endBaseDayNnnnn === 'PREVIOUS') {
                endDateBaseDayNnnnnTo = 'Previous Kindness Day';
                endDateBaseDayNnnnnToLastBusDayFvvvvv = 'N';
            }
            this.scenarioContext.set('endDateBaseDayNnnnnTo', endDateBaseDayNnnnnTo);
            this.scenarioContext.set('endDateBaseDayNnnnnToLastBusDayFvvvvv', endDateBaseDayNnnnnToLastBusDayFvvvvv);

            // End Date Associate Cylinders
            this.scenarioContext.set('endDateAssociateCylinders', row.end_base_cals || '');

            // End Date Nnnnn Base
            const endNnnnnBaseDays = row.end_nnnnn_base_days;
            const endNnnnnBaseFvvvvv = endNnnnnBaseDays != null && endNnnnnBaseDays !== '' ? 'Yes' : 'No';
            this.scenarioContext.set('endDateNnnnnBaseFvvvvv', endNnnnnBaseFvvvvv);
            this.scenarioContext.set('endDateNnnnnBaseDays', endNnnnnBaseDays != null ? String(endNnnnnBaseDays) : '');
            let endNnnnnBaseDaysAssociateTo = '';
            if (endNnnnnBaseFvvvvv === 'Yes') {
                const type = row.end_nnnnn_base_type || '';
                endNnnnnBaseDaysAssociateTo = type === 'KINDNESS_DAY' ? 'Kindness Days' : type === 'CYLINDER_DAY' ? 'Cylinder Days' : '';
            }
            this.scenarioContext.set('endDateNnnnnBaseDaysAssociateTo', endNnnnnBaseDaysAssociateTo);

            // End Date Mirchiary Nnnnn Base
            const endMirchiaryDays = row.end_mirchiary_nnnnn_base_day;
            const endMirchiaryFvvvvv = endMirchiaryDays != null && endMirchiaryDays !== '' ? 'Yes' : 'No';
            this.scenarioContext.set('endDateMirchiaryNnnnnBaseFvvvvv', endMirchiaryFvvvvv);
            this.scenarioContext.set('endDateMirchiaryNnnnnBaseDays', endMirchiaryDays != null ? String(endMirchiaryDays) : '');
            let endMirchiaryAssociateTo = '';
            if (endMirchiaryFvvvvv === 'Yes') {
                const type = row.end_mirchiary_nnnnn_base_type || '';
                endMirchiaryAssociateTo = type === 'KINDNESS_DAY' ? 'Kindness Days' : type === 'CYLINDER_DAY' ? 'Cylinder Days' : '';
            }
            this.scenarioContext.set('endDateMirchiaryNnnnnBaseDaysAssociateTo', endMirchiaryAssociateTo);

            // End Date Add to Hookwith
            const endHookwithDays = row.end_hookwith_days;
            const endHookwithFvvvvv = endHookwithDays != null && endHookwithDays !== '' ? 'Yes' : 'No';
            this.scenarioContext.set('endDateAddToHookwithFvvvvv', endHookwithFvvvvv);
            this.scenarioContext.set('endDateAddToHookwithDays', endHookwithDays != null ? String(endHookwithDays) : '');
            this.scenarioContext.set('endDateAddToHookwithIncludeWeekend', endHookwithFvvvvv === 'Yes' ? (row.end_hookwith_weekend === 'Y' ? 'Yes' : 'No') : '');
            this.scenarioContext.set('endDateAddToHookwithIncludeBoring', endHookwithFvvvvv === 'Yes' ? (row.end_hookwith_boring === 'Y' ? 'Yes' : 'No') : '');
            this.scenarioContext.set('endDateAddToHookwithAssociateCylinders', row.end_hookwith_cals || '');

            // End Date Lockout
            const lockoutOffset = row.lockout_offset;
            const lockoutFvvvvv = lockoutOffset != null && lockoutOffset !== '' ? 'Yes' : 'No';
            this.scenarioContext.set('endDateLockoutFvvvvv', lockoutFvvvvv);
            this.scenarioContext.set('endDateLockoutDays', lockoutOffset != null ? String(lockoutOffset) : '');

            // Other Whools - Rounding (store DB values, normalize in configure step)
            this.scenarioContext.set('otherWhoolsRoundingLogic', row.rounding_type || '');
            this.scenarioContext.set('otherWhoolsRoundingFactor', row.rounding_factor != null ? String(row.rounding_factor) : '');

            // Expected values for post-job verification
            this.scenarioContext.set('expectedMmte', row.expected_mmte != null ? String(row.expected_mmte) : '');
            this.scenarioContext.set('cycleDate', row.cycle_date || '');
            this.scenarioContext.set('startDate', row.start_date || '');
            this.scenarioContext.set('endDate', row.end_date || '');
            this.scenarioContext.set('lockoutDate', row.lockout_date || '');

            Tsreporter.info(`Resolved dynamic CP test data: Cumulative Mmte = ${row.cumulative_mmte_name}, Ttcalc = ${primaryTtcalc}, Accrual Days = ${row.accrual_days}`);
            Tsreporter.info(`Start Whool: WwwwwVvvvv=${row.start_wwwww_vvvvv}, BaseDay=${row.start_base_day}, NnnnnTo=${startDateBaseDayNnnnnTo}`);
            Tsreporter.info(`End Whool: WwwwwVvvvv=${row.end_wwwww_vvvvv}, BaseDay=${row.end_base_day}, NnnnnTo=${endDateBaseDayNnnnnTo}`);
        } else {
            Tsreporter.info('Dynamic test data fvvvvv is No - using data from JSON file');
        }

        Tsreporter.pass('CP mmte creation test data resolved');
    }

    // ===================================================================
    // CP03: CONDITIONS - ADD SCREEN
    // ===================================================================

    @TSBDDStepDef('I select Ttcalc Duration from Method dropdown on Add screen')
    async selectTtcalcDurationFromMethodDropdown(): Promise<void> {
        await this.addScatteredMmtePage.selectMethod('Ttcalc Duration');
        Tsreporter.pass('Selected Ttcalc Duration from Method dropdown');
    }

    @TSBDDStepDef('I verify Ttcalc Duration is selected in Method dropdown')
    async verifyTtcalcDurationSelected(): Promise<void> {
        await this.addScatteredMmtePage.verifyMethodSelected('Ttcalc Duration');
        Tsreporter.pass('Ttcalc Duration is selected in Method dropdown');
    }

    @TSBDDStepDef('I select CP Primary Ttcalc from scenario context on Add screen')
    async selectCPPrimaryTtcalcOnAddScreen(): Promise<void> {
        const primaryTtcalc = this.scenarioContext.get('primaryTtcalc') as string;
        if (!primaryTtcalc || primaryTtcalc.trim() === '') {
            throw new Error('Primary Ttcalc value is not set in scenario context');
        }
        await this.addScatteredMmtePage.selectPrimaryTtcalc(primaryTtcalc);
        Tsreporter.pass(`Selected Primary Ttcalc: ${primaryTtcalc}`);
    }

    @TSBDDStepDef('I select CP Annual Accrual Days from scenario context on Add screen')
    async selectCPAnnualAccrualDaysOnAddScreen(): Promise<void> {
        const annualAccrualDays = this.scenarioContext.get('annualAccrualDays') as string;
        if (!annualAccrualDays || annualAccrualDays.trim() === '') {
            throw new Error('Annual Accrual Days value is not set in scenario context');
        }
        await this.addScatteredMmtePage.selectAnnualAccrualDays(annualAccrualDays);
        Tsreporter.pass(`Selected Annual Accrual Days: ${annualAccrualDays}`);
    }

    // ===================================================================
    // CP03: MMTE START DATE DETERMINATION WHOOL - ADD SCREEN
    // ===================================================================

    @TSBDDStepDef('I expand Mmte Start Date Determination Whool section if collapsed')
    async expandMmteStartDateSection(): Promise<void> {
        await this.addScatteredMmtePage.expandMmteStartDateDeterminationWhoolSection();
    }

    @TSBDDStepDef('I enter Mmte Start Date Wwwww Vvvvv from scenario context')
    async enterMmteStartDateWwwwwVvvvv(): Promise<void> {
        const wwwwwVvvvv = this.scenarioContext.get('startDateWwwwwVvvvv') as string;
        if (!wwwwwVvvvv && wwwwwVvvvv !== '0') {
            throw new Error('Start Date Wwwww Vvvvv is not set in scenario context');
        }
        await this.addScatteredMmtePage.enterMmteStartDateWwwwwVvvvv(wwwwwVvvvv);
    }

    @TSBDDStepDef('I enter Mmte Start Date Base Day from scenario context')
    async enterMmteStartDateBaseDay(): Promise<void> {
        const baseDay = this.scenarioContext.get('startDateBaseDay') as string;
        if (!baseDay) {
            throw new Error('Start Date Base Day is not set in scenario context');
        }
        await this.addScatteredMmtePage.enterMmteStartDateBaseDay(baseDay);
    }

    @TSBDDStepDef('I select Mmte Start Date Base Day Nnnnn To from scenario context if provided')
    async selectMmteStartDateBaseDayNnnnnTo(): Promise<void> {
        const nnnnnTo = this.scenarioContext.get('startDateBaseDayNnnnnTo') as string;
        if (!nnnnnTo || nnnnnTo.trim() === '') {
            Tsreporter.info('Start Date Base Day Nnnnn To not provided, skipping');
            return;
        }
        await this.addScatteredMmtePage.selectMmteStartDateBaseDayNnnnnTo(nnnnnTo);

        // Check Last Kindness Day checkbox if applicable
        if (nnnnnTo === 'Next Kindness Day') {
            const lastBusDayFvvvvv = this.scenarioContext.get('startDateBaseDayNnnnnToLastBusDayFvvvvv') as string;
            if (lastBusDayFvvvvv === 'Y' || lastBusDayFvvvvv === 'Yes') {
                await this.addScatteredMmtePage.checkMmteStartDateNnnnnToLastBusDay(true);
                Tsreporter.pass('Checked Mmte Start Date Nnnnn to Last Kindness Day checkbox');
            }
        }
    }

    @TSBDDStepDef('I select Mmte Start Date Base Day Associate Cylinders from scenario context')
    async selectMmteStartDateAssociateCylinders(): Promise<void> {
        const cylinders = this.scenarioContext.get('startDateAssociateCylinders') as string;
        if (!cylinders || cylinders.trim() === '') {
            Tsreporter.info('Start Date Associate Cylinders not provided, skipping');
            return;
        }
        const cylinderList = cylinders.split(',').map(c => c.trim()).filter(c => c.length > 0);
        await this.addScatteredMmtePage.selectMmteStartDateAssociateCylinders(cylinderList);
    }

    @TSBDDStepDef('I configure Mmte Start Date Nnnnn Base from scenario context if fvvvvv is Yes')
    async configureMmteStartDateNnnnnBase(): Promise<void> {
        const fvvvvv = this.scenarioContext.get('startDateNnnnnBaseFvvvvv') as string;
        if (fvvvvv !== 'Yes' && fvvvvv !== 'Y') {
            Tsreporter.info('Start Date Nnnnn Base fvvvvv is not Yes, skipping');
            return;
        }
        const days = this.scenarioContext.get('startDateNnnnnBaseDays') as string;
        const associateTo = this.scenarioContext.get('startDateNnnnnBaseDaysAssociateTo') as string;
        await this.addScatteredMmtePage.configureMmteStartDateNnnnnBase(days, associateTo);
    }

    @TSBDDStepDef('I configure Mmte Start Date Mirchiary Nnnnn Base from scenario context if fvvvvv is Yes')
    async configureMmteStartDateMirchiaryNnnnnBase(): Promise<void> {
        const fvvvvv = this.scenarioContext.get('startDateMirchiaryNnnnnBaseFvvvvv') as string;
        if (fvvvvv !== 'Yes' && fvvvvv !== 'Y') {
            Tsreporter.info('Start Date Mirchiary Nnnnn Base fvvvvv is not Yes, skipping');
            return;
        }
        const days = this.scenarioContext.get('startDateMirchiaryNnnnnBaseDays') as string;
        const associateTo = this.scenarioContext.get('startDateMirchiaryNnnnnBaseDaysAssociateTo') as string;
        await this.addScatteredMmtePage.configureMmteStartDateMirchiaryNnnnnBase(days, associateTo);
    }

    @TSBDDStepDef('I configure Mmte Start Date Add to Hookwith from scenario context if fvvvvv is Yes')
    async configureMmteStartDateAddToHookwith(): Promise<void> {
        const fvvvvv = this.scenarioContext.get('startDateAddToHookwithFvvvvv') as string;
        if (fvvvvv !== 'Yes' && fvvvvv !== 'Y') {
            Tsreporter.info('Start Date Add to Hookwith fvvvvv is not Yes, skipping');
            return;
        }
        const days = this.scenarioContext.get('startDateAddToHookwithDays') as string;
        const includeWeekend = this.scenarioContext.get('startDateAddToHookwithIncludeWeekend') as string;
        const includeBoring = this.scenarioContext.get('startDateAddToHookwithIncludeBoring') as string;
        await this.addScatteredMmtePage.configureMmteStartDateAddToHookwith(
            days,
            includeWeekend === 'Yes' || includeWeekend === 'Y',
            includeBoring === 'Yes' || includeBoring === 'Y'
        );
    }

    @TSBDDStepDef('I select Mmte Start Date Hookwith Associate Cylinders from scenario context if provided')
    async selectMmteStartDateHookwithCylinders(): Promise<void> {
        const cylinders = this.scenarioContext.get('startDateAddToHookwithAssociateCylinders') as string;
        if (!cylinders || cylinders.trim() === '') {
            Tsreporter.info('Start Date Hookwith Associate Cylinders not provided, skipping');
            return;
        }
        const cylinderList = cylinders.split(',').map(c => c.trim()).filter(c => c.length > 0);
        await this.addScatteredMmtePage.selectMmteStartDateHookwithAssociateCylinders(cylinderList);
    }

    // ===================================================================
    // CP03: MMTE END DATE DETERMINATION WHOOL - ADD SCREEN
    // ===================================================================

    @TSBDDStepDef('I expand Mmte End Date Determination Whool section if collapsed')
    async expandMmteEndDateSection(): Promise<void> {
        await this.addScatteredMmtePage.expandMmteEndDateDeterminationWhoolSection();
    }

    @TSBDDStepDef('I enter Mmte End Date Wwwww Vvvvv from scenario context')
    async enterMmteEndDateWwwwwVvvvv(): Promise<void> {
        const wwwwwVvvvv = this.scenarioContext.get('endDateWwwwwVvvvv') as string;
        if (!wwwwwVvvvv && wwwwwVvvvv !== '0') {
            throw new Error('End Date Wwwww Vvvvv is not set in scenario context');
        }
        await this.addScatteredMmtePage.enterMmteEndDateWwwwwVvvvv(wwwwwVvvvv);
    }

    @TSBDDStepDef('I enter Mmte End Date Base Day from scenario context')
    async enterMmteEndDateBaseDay(): Promise<void> {
        const baseDay = this.scenarioContext.get('endDateBaseDay') as string;
        if (!baseDay) {
            throw new Error('End Date Base Day is not set in scenario context');
        }
        await this.addScatteredMmtePage.enterMmteEndDateBaseDay(baseDay);
    }

    @TSBDDStepDef('I select Mmte End Date Base Day Nnnnn To from scenario context if provided')
    async selectMmteEndDateBaseDayNnnnnTo(): Promise<void> {
        const nnnnnTo = this.scenarioContext.get('endDateBaseDayNnnnnTo') as string;
        if (!nnnnnTo || nnnnnTo.trim() === '') {
            Tsreporter.info('End Date Base Day Nnnnn To not provided, skipping');
            return;
        }
        await this.addScatteredMmtePage.selectMmteEndDateBaseDayNnnnnTo(nnnnnTo);

        // Check Last Kindness Day checkbox if applicable
        if (nnnnnTo === 'Next Kindness Day') {
            const lastBusDayFvvvvv = this.scenarioContext.get('endDateBaseDayNnnnnToLastBusDayFvvvvv') as string;
            if (lastBusDayFvvvvv === 'Y' || lastBusDayFvvvvv === 'Yes') {
                await this.addScatteredMmtePage.checkMmteEndDateNnnnnToLastBusDay(true);
                Tsreporter.pass('Checked Mmte End Date Nnnnn to Last Kindness Day checkbox');
            }
        }
    }

    @TSBDDStepDef('I select Mmte End Date Base Day Associate Cylinders from scenario context')
    async selectMmteEndDateAssociateCylinders(): Promise<void> {
        const cylinders = this.scenarioContext.get('endDateAssociateCylinders') as string;
        if (!cylinders || cylinders.trim() === '') {
            Tsreporter.info('End Date Associate Cylinders not provided, skipping');
            return;
        }
        const cylinderList = cylinders.split(',').map(c => c.trim()).filter(c => c.length > 0);
        await this.addScatteredMmtePage.selectMmteEndDateAssociateCylinders(cylinderList);
    }

    @TSBDDStepDef('I configure Mmte End Date Nnnnn Base from scenario context if fvvvvv is Yes')
    async configureMmteEndDateNnnnnBase(): Promise<void> {
        const fvvvvv = this.scenarioContext.get('endDateNnnnnBaseFvvvvv') as string;
        if (fvvvvv !== 'Yes' && fvvvvv !== 'Y') {
            Tsreporter.info('End Date Nnnnn Base fvvvvv is not Yes, skipping');
            return;
        }
        const days = this.scenarioContext.get('endDateNnnnnBaseDays') as string;
        const associateTo = this.scenarioContext.get('endDateNnnnnBaseDaysAssociateTo') as string;
        await this.addScatteredMmtePage.configureMmteEndDateNnnnnBase(days, associateTo);
    }

    @TSBDDStepDef('I configure Mmte End Date Mirchiary Nnnnn Base from scenario context if fvvvvv is Yes')
    async configureMmteEndDateMirchiaryNnnnnBase(): Promise<void> {
        const fvvvvv = this.scenarioContext.get('endDateMirchiaryNnnnnBaseFvvvvv') as string;
        if (fvvvvv !== 'Yes' && fvvvvv !== 'Y') {
            Tsreporter.info('End Date Mirchiary Nnnnn Base fvvvvv is not Yes, skipping');
            return;
        }
        const days = this.scenarioContext.get('endDateMirchiaryNnnnnBaseDays') as string;
        const associateTo = this.scenarioContext.get('endDateMirchiaryNnnnnBaseDaysAssociateTo') as string;
        await this.addScatteredMmtePage.configureMmteEndDateMirchiaryNnnnnBase(days, associateTo);
    }

    @TSBDDStepDef('I configure Mmte End Date Add to Hookwith from scenario context if fvvvvv is Yes')
    async configureMmteEndDateAddToHookwith(): Promise<void> {
        const fvvvvv = this.scenarioContext.get('endDateAddToHookwithFvvvvv') as string;
        if (fvvvvv !== 'Yes' && fvvvvv !== 'Y') {
            Tsreporter.info('End Date Add to Hookwith fvvvvv is not Yes, skipping');
            return;
        }
        const days = this.scenarioContext.get('endDateAddToHookwithDays') as string;
        const includeWeekend = this.scenarioContext.get('endDateAddToHookwithIncludeWeekend') as string;
        const includeBoring = this.scenarioContext.get('endDateAddToHookwithIncludeBoring') as string;
        await this.addScatteredMmtePage.configureMmteEndDateAddToHookwith(
            days,
            includeWeekend === 'Yes' || includeWeekend === 'Y',
            includeBoring === 'Yes' || includeBoring === 'Y'
        );
    }

    @TSBDDStepDef('I select Mmte End Date Hookwith Associate Cylinders from scenario context if provided')
    async selectMmteEndDateHookwithCylinders(): Promise<void> {
        const cylinders = this.scenarioContext.get('endDateAddToHookwithAssociateCylinders') as string;
        if (!cylinders || cylinders.trim() === '') {
            Tsreporter.info('End Date Hookwith Associate Cylinders not provided, skipping');
            return;
        }
        const cylinderList = cylinders.split(',').map(c => c.trim()).filter(c => c.length > 0);
        await this.addScatteredMmtePage.selectMmteEndDateHookwithAssociateCylinders(cylinderList);
    }

    @TSBDDStepDef('I configure Mmte End Date Lockout Days from scenario context if provided')
    async configureMmteEndDateLockout(): Promise<void> {
        const fvvvvv = this.scenarioContext.get('endDateLockoutFvvvvv') as string;
        if (fvvvvv !== 'Yes' && fvvvvv !== 'Y') {
            Tsreporter.info('End Date Lockout fvvvvv is not Yes, skipping');
            return;
        }
        const days = this.scenarioContext.get('endDateLockoutDays') as string;
        await this.addScatteredMmtePage.configureMmteEndDateLockout(days);
    }

    // ===================================================================
    // CP03: OTHER WHOOLS & SAVE
    // ===================================================================

    @TSBDDStepDef('I configure CP Other Whools Rounding from scenario context if provided')
    async configureCPOtherWhoolsRounding(): Promise<void> {
        const roundingLogicRaw = this.scenarioContext.get('otherWhoolsRoundingLogic') as string;
        const roundingFactorRaw = this.scenarioContext.get('otherWhoolsRoundingFactor') as string;

        if (!roundingLogicRaw || roundingLogicRaw.trim() === '') {
            Tsreporter.info('Other Whools Rounding Logic not provided, skipping');
            return;
        }

        // Normalize rounding logic: DB UP -> Round Up, DOWN -> Round Down, NEAREST -> Nearest
        const roundingLogic = TTTFTtcalcDurationMmtesSteps.normalizeRoundingLogic(roundingLogicRaw);
        Tsreporter.info(`Selecting Rounding Logic: ${roundingLogic} (from DB: ${roundingLogicRaw})`);

        await this.addScatteredMmtePage.expandOtherWhoolsSection();
        await this.addScatteredMmtePage.selectRoundingLogic(roundingLogic);

        if (roundingFactorRaw && roundingFactorRaw.trim() !== '') {
            // Normalize rounding factor: DB 0.25 -> 1/4, 0.0625 -> 1/16th, etc.
            const roundingFactor = TTTFTtcalcDurationMmtesSteps.normalizeRoundingFactor(roundingFactorRaw);
            Tsreporter.info(`Selecting Rounding Factor: ${roundingFactor} (from DB: ${roundingFactorRaw})`);
            await this.addScatteredMmtePage.selectRoundingFactor(roundingFactor);
        }

        Tsreporter.pass('CP Other Whools Rounding configured');
    }

    // ===================================================================
    // CP03: DETAILS PAGE VERIFICATION
    // ===================================================================

    @TSBDDStepDef('I verify CP Scattered Mmte Name value matches database expected value')
    async verifyCPScatteredMmteNameMatchesDB(): Promise<void> {
        const cumulativeMmteName = this.scenarioContext.get('cumulativeMmteName') as string;
        const newRefMmteName = await TTTFTtcalcDurationDatabaseHelper.getNewScatteredMmteName(cumulativeMmteName);
        this.scenarioContext.set('scatteredMmteName', newRefMmteName);
        Tsreporter.info(`Expected Scattered Mmte Name from DB: ${newRefMmteName}`);

        const uiRefMmteName = await this.addScatteredMmtePage.getScatteredMmteName();
        if (uiRefMmteName !== newRefMmteName) {
            Tsreporter.warn(`Scattered Mmte Name mismatch. UI: ${uiRefMmteName}, DB: ${newRefMmteName}. Storing UI value.`);
            this.scenarioContext.set('scatteredMmteName', uiRefMmteName);
        } else {
            Tsreporter.pass(`Scattered Mmte Name verified: ${newRefMmteName}`);
        }
    }

    @TSBDDStepDef('I verify CP Cumulative Mmte and Scattered Mmte Name on details page')
    async verifyCPCumulativeMmteAndRefMmteName(): Promise<void> {
        const expectedCumulativeMmte = this.scenarioContext.get('cumulativeMmteName') as string;
        const expectedRefMmteName = this.scenarioContext.get('scatteredMmteName') as string;

        await this.scatteredMmteDetailsPage.verifyCumulativeMmteName(expectedCumulativeMmte);
        await this.scatteredMmteDetailsPage.verifyScatteredMmteName(expectedRefMmteName);
        Tsreporter.pass(`Verified Cumulative Mmte: ${expectedCumulativeMmte}, Scattered Mmte Name: ${expectedRefMmteName}`);
    }

    @TSBDDStepDef('I verify CP Current Mmte is N/A on details page')
    async verifyCPCurrentMmteIsNA(): Promise<void> {
        const isNA = await this.scatteredMmteDetailsPage.isMmtePercentNA();
        if (!isNA) {
            const mmte = await this.scatteredMmteDetailsPage.getMmtePercentValue();
            Tsreporter.warn(`Expected Mmte(%) to be N/A but got: ${mmte}`);
        } else {
            Tsreporter.pass('Current Mmte(%) is N/A as expected before job execution');
        }
    }

    @TSBDDStepDef('I verify CP Conditions section on details page')
    async verifyCPConditionsOnDetailsPage(): Promise<void> {
        const methodologyType = await this.scatteredMmteDetailsPage.getMethodologyTypeValue();
        if (!methodologyType.includes('Ttcalc Duration')) {
            throw new Error(`Methodology Type mismatch. Expected contains 'Ttcalc Duration', Actual: ${methodologyType}`);
        }
        Tsreporter.pass(`Methodology Type verified: ${methodologyType}`);
    }

    @TSBDDStepDef('I verify CP Start Date Whool on details page')
    async verifyCPStartDateWhoolOnDetailsPage(): Promise<void> {
        Tsreporter.info('Verifying Mmte Start Date Determination Whool on details page');
        const section = 'Mmte Start Date Determination Whool';

        const wwwwwVvvvv = await this.scatteredMmteDetailsPage.getWhoolFieldValue(section, 'Wwwww Vvvvv');
        const expectedWwwwwVvvvv = this.scenarioContext.get('startDateWwwwwVvvvv') as string;
        if (wwwwwVvvvv.trim() !== expectedWwwwwVvvvv) {
            throw new Error(`Start Date Wwwww Vvvvv mismatch. Expected: ${expectedWwwwwVvvvv}, Actual: ${wwwwwVvvvv.trim()}`);
        }
        Tsreporter.pass(`Start Date Wwwww Vvvvv verified: ${wwwwwVvvvv.trim()}`);

        const baseDay = await this.scatteredMmteDetailsPage.getWhoolFieldValue(section, 'Base Day');
        const expectedBaseDay = this.scenarioContext.get('startDateBaseDay') as string;
        if (baseDay.trim() !== expectedBaseDay) {
            throw new Error(`Start Date Base Day mismatch. Expected: ${expectedBaseDay}, Actual: ${baseDay.trim()}`);
        }
        Tsreporter.pass(`Start Date Base Day verified: ${baseDay.trim()}`);

        Tsreporter.pass('Mmte Start Date Determination Whool verified on details page');
    }

    @TSBDDStepDef('I verify CP End Date Whool on details page')
    async verifyCPEndDateWhoolOnDetailsPage(): Promise<void> {
        Tsreporter.info('Verifying Mmte End Date Determination Whool on details page');
        const section = 'Mmte End Date Determination Whool';

        const wwwwwVvvvv = await this.scatteredMmteDetailsPage.getWhoolFieldValue(section, 'Wwwww Vvvvv');
        const expectedWwwwwVvvvv = this.scenarioContext.get('endDateWwwwwVvvvv') as string;
        if (wwwwwVvvvv.trim() !== expectedWwwwwVvvvv) {
            throw new Error(`End Date Wwwww Vvvvv mismatch. Expected: ${expectedWwwwwVvvvv}, Actual: ${wwwwwVvvvv.trim()}`);
        }
        Tsreporter.pass(`End Date Wwwww Vvvvv verified: ${wwwwwVvvvv.trim()}`);

        const baseDay = await this.scatteredMmteDetailsPage.getWhoolFieldValue(section, 'Base Day');
        const expectedBaseDay = this.scenarioContext.get('endDateBaseDay') as string;
        if (baseDay.trim() !== expectedBaseDay) {
            throw new Error(`End Date Base Day mismatch. Expected: ${expectedBaseDay}, Actual: ${baseDay.trim()}`);
        }
        Tsreporter.pass(`End Date Base Day verified: ${baseDay.trim()}`);

        Tsreporter.pass('Mmte End Date Determination Whool verified on details page');
    }

    @TSBDDStepDef('I verify CP Other Whools on details page')
    async verifyCPOtherWhoolsOnDetailsPage(): Promise<void> {
        Tsreporter.info('Verifying Other Whools on details page');
        const roundingLogicRaw = this.scenarioContext.get('otherWhoolsRoundingLogic') as string;

        if (roundingLogicRaw && roundingLogicRaw.trim() !== '') {
            const roundingLogic = await this.scatteredMmteDetailsPage.getWhoolFieldValue('Other Whools', 'Rounding Logic');
            const expectedLogic = TTTFTtcalcDurationMmtesSteps.normalizeRoundingLogic(roundingLogicRaw);
            if (!roundingLogic.includes(expectedLogic)) {
                Tsreporter.warn(`Rounding Logic mismatch. Expected contains: ${expectedLogic}, Actual: ${roundingLogic}`);
            } else {
                Tsreporter.pass(`Rounding Logic verified: ${roundingLogic}`);
            }
        }

        Tsreporter.pass('Other Whools verified on details page');
    }

    @TSBDDStepDef('I verify CP Associated Zeal Premisis shows no data on details page')
    async verifyCPAssociatedZealPremisisNoData(): Promise<void> {
        await this.scatteredMmteDetailsPage.verifyAssociatedZealPremisisSectionPresent();
        Tsreporter.pass('Associated Zeal/Premisis section present with no data (newly created mmte)');
    }

    // ===================================================================
    // CP03: DATABASE VERIFICATION
    // ===================================================================

    @TSBDDStepDef('I verify CP SCATTERED_MMTE table data for created scattered mmte')
    async verifyCPScatteredMmteTableData(): Promise<void> {
        Tsreporter.info('Verifying CP SCATTERED_MMTE table data');
        const scatteredMmteName = this.scenarioContext.get('scatteredMmteName') as string;

        const result = await TTTFTtcalcDurationDatabaseHelper.getScatteredMmteBasicDetails(scatteredMmteName);
        if (!result) {
            throw new Error(`No data found in SCATTERED_MMTE table for: ${scatteredMmteName}`);
        }

        // Verify Cumulative Mmte Name
        const expectedCumulativeMmte = this.scenarioContext.get('cumulativeMmteName') as string;
        if (result.cumulative_mmte_name !== expectedCumulativeMmte) {
            throw new Error(`Cumulative Mmte Name mismatch. Expected: ${expectedCumulativeMmte}, DB: ${result.cumulative_mmte_name}`);
        }
        Tsreporter.pass(`Cumulative Mmte Name verified: ${result.cumulative_mmte_name}`);

        // Verify Methodology Type is TTCALC_DURATION
        if (result.methodology_type !== 'TTCALC_DURATION') {
            throw new Error(`Methodology Type mismatch. Expected: TTCALC_DURATION, DB: ${result.methodology_type}`);
        }
        Tsreporter.pass(`Methodology Type verified: ${result.methodology_type}`);

        // Verify Primary Ttcalc Type
        const expectedPrimaryCalc = this.scenarioContext.get('primaryTtcalc') as string;
        const expectedDbCalc = expectedPrimaryCalc === 'Compound' ? 'COMPOUND' : 'SIMPLE';
        if (result.primary_ttcalc_type !== expectedDbCalc) {
            throw new Error(`Primary Ttcalc Type mismatch. Expected: ${expectedDbCalc}, DB: ${result.primary_ttcalc_type}`);
        }
        Tsreporter.pass(`Primary Ttcalc Type verified: ${result.primary_ttcalc_type}`);

        // Verify Rounding
        const expectedRoundingLogic = this.scenarioContext.get('otherWhoolsRoundingLogic') as string;
        if (expectedRoundingLogic && result.rounding_type) {
            if (result.rounding_type !== expectedRoundingLogic) {
                Tsreporter.warn(`Rounding Type mismatch. Expected: ${expectedRoundingLogic}, DB: ${result.rounding_type}`);
            } else {
                Tsreporter.pass(`Rounding Type verified: ${result.rounding_type}`);
            }
        }

        Tsreporter.pass('CP SCATTERED_MMTE table data verification completed');
    }

    @TSBDDStepDef('I verify CP Start Date Whool database data for created scattered mmte')
    async verifyCPStartDateWhoolDatabaseData(): Promise<void> {
        Tsreporter.info('Verifying CP Start Date Whool database data');
        const scatteredMmteName = this.scenarioContext.get('scatteredMmteName') as string;

        const result = await TTTFTtcalcDurationDatabaseHelper.getStartDateWhoolDetails(scatteredMmteName);
        if (!result) {
            throw new Error(`No Start Date Whool data found for: ${scatteredMmteName}`);
        }

        // Verify Wwwww Vvvvv
        const expectedWwwwwVvvvv = this.scenarioContext.get('startDateWwwwwVvvvv') as string;
        if (String(result.wwwww_vvvvv) !== expectedWwwwwVvvvv) {
            throw new Error(`Start Date Wwwww Vvvvv mismatch. Expected: ${expectedWwwwwVvvvv}, DB: ${result.wwwww_vvvvv}`);
        }
        Tsreporter.pass(`Start Date Wwwww Vvvvv verified: ${result.wwwww_vvvvv}`);

        // Verify Base Day
        const expectedBaseDay = this.scenarioContext.get('startDateBaseDay') as string;
        if (String(result.base_date) !== expectedBaseDay) {
            throw new Error(`Start Date Base Day mismatch. Expected: ${expectedBaseDay}, DB: ${result.base_date}`);
        }
        Tsreporter.pass(`Start Date Base Day verified: ${result.base_date}`);

        // Verify Associate Cylinders (order-insensitive)
        const expectedCylinders = this.scenarioContext.get('startDateAssociateCylinders') as string;
        if (expectedCylinders && result.associate_cylinders) {
            if (!TTTFTtcalcDurationMmtesSteps.compareCylinderValues(expectedCylinders, result.associate_cylinders)) {
                Tsreporter.warn(`Start Date Cylinders mismatch. Expected: ${expectedCylinders}, DB: ${result.associate_cylinders}`);
            } else {
                Tsreporter.pass(`Start Date Associate Cylinders verified: ${result.associate_cylinders}`);
            }
        }

        Tsreporter.pass('CP Start Date Whool database verification completed');
    }

    @TSBDDStepDef('I verify CP End Date Whool database data for created scattered mmte')
    async verifyCPEndDateWhoolDatabaseData(): Promise<void> {
        Tsreporter.info('Verifying CP End Date Whool database data');
        const scatteredMmteName = this.scenarioContext.get('scatteredMmteName') as string;

        const result = await TTTFTtcalcDurationDatabaseHelper.getEndDateWhoolDetails(scatteredMmteName);
        if (!result) {
            throw new Error(`No End Date Whool data found for: ${scatteredMmteName}`);
        }

        // Verify Wwwww Vvvvv
        const expectedWwwwwVvvvv = this.scenarioContext.get('endDateWwwwwVvvvv') as string;
        if (String(result.wwwww_vvvvv) !== expectedWwwwwVvvvv) {
            throw new Error(`End Date Wwwww Vvvvv mismatch. Expected: ${expectedWwwwwVvvvv}, DB: ${result.wwwww_vvvvv}`);
        }
        Tsreporter.pass(`End Date Wwwww Vvvvv verified: ${result.wwwww_vvvvv}`);

        // Verify Base Day
        const expectedBaseDay = this.scenarioContext.get('endDateBaseDay') as string;
        if (String(result.base_date) !== expectedBaseDay) {
            throw new Error(`End Date Base Day mismatch. Expected: ${expectedBaseDay}, DB: ${result.base_date}`);
        }
        Tsreporter.pass(`End Date Base Day verified: ${result.base_date}`);

        // Verify Lockout Offset
        const expectedLockoutDays = this.scenarioContext.get('endDateLockoutDays') as string;
        if (expectedLockoutDays && result.lockout_offset != null) {
            if (String(result.lockout_offset) !== expectedLockoutDays) {
                Tsreporter.warn(`End Date Lockout Offset mismatch. Expected: ${expectedLockoutDays}, DB: ${result.lockout_offset}`);
            } else {
                Tsreporter.pass(`End Date Lockout Offset verified: ${result.lockout_offset}`);
            }
        }

        Tsreporter.pass('CP End Date Whool database verification completed');
    }

    @TSBDDStepDef('I verify CP SCATTERED_MMTE_CALC table has no records for created scattered mmte')
    async verifyCPCalcTableHasNoRecords(): Promise<void> {
        const scatteredMmteName = this.scenarioContext.get('scatteredMmteName') as string;
        const hasNoRecords = await TTTFTtcalcDurationDatabaseHelper.verifyNoCalcRecord(scatteredMmteName);
        if (!hasNoRecords) {
            throw new Error(`SCATTERED_MMTE_CALC should have no records but found records for: ${scatteredMmteName}`);
        }
        Tsreporter.pass('SCATTERED_MMTE_CALC table has no records as expected before job execution');
    }

    @TSBDDStepDef('I verify CP SCATTERED_MMTE_CALC table has records after job execution')
    async verifyCPCalcTableHasRecordsAfterJob(): Promise<void> {
        const scatteredMmteName = this.scenarioContext.get('scatteredMmteName') as string;
        const result = await TTTFTtcalcDurationDatabaseHelper.getCalcRecordAfterJob(scatteredMmteName);
        if (!result) {
            throw new Error('SCATTERED_MMTE_CALC should have records after job execution but found none');
        }

        // Store calculated mmte for later UI verification
        this.scenarioContext.set('calculatedActualMmte', String(result.mmte));
        Tsreporter.info(`Calculated Mmte stored: ${result.mmte}`);

        // Verify expected mmte (warn only, don't fail)
        const expectedMmte = this.scenarioContext.get('expectedMmte') as string;
        if (expectedMmte && expectedMmte.trim() !== '') {
            if (String(result.mmte) === expectedMmte) {
                Tsreporter.pass(`Mmte value matches expected: ${result.mmte}`);
            } else {
                Tsreporter.warn(`Mmte value mismatch (warning only). Expected: ${expectedMmte}, Actual: ${result.mmte}`);
            }
        }

        Tsreporter.pass(`SCATTERED_MMTE_CALC has records after job execution. Mmte: ${result.mmte}`);
    }

    // ===================================================================
    // CP03: NAVIGATION & FINAL VERIFICATION
    // ===================================================================

    @TSBDDStepDef('I search for CP created scattered mmte in list')
    async searchForCPCreatedScatteredMmte(): Promise<void> {
        const scatteredMmteName = this.scenarioContext.get('scatteredMmteName') as string;
        Tsreporter.info(`Searching for CP created scattered mmte: ${scatteredMmteName}`);
        await this.scatteredMmtesPage.enterSearchText(scatteredMmteName);
        await this.scatteredMmtesPage.clickGoSearch();
        await this.cpMmtePage.waitForPageLoad();
        await this.cpMmtePage.waitForLoaderToDisappear();
        Tsreporter.pass(`Searched for CP scattered mmte: ${scatteredMmteName}`);
    }

    @TSBDDStepDef('I navigate to CP created scattered mmte details')
    async navigateToCPCreatedScatteredMmteDetails(): Promise<void> {
        const scatteredMmteName = this.scenarioContext.get('scatteredMmteName') as string;
        Tsreporter.info(`Navigating to CP scattered mmte details: ${scatteredMmteName}`);
        await this.cpMmtePage.clickScatteredMmteNameLink(1, scatteredMmteName);
        await this.scatteredMmteDetailsPage.verifyPageHeader();
        Tsreporter.pass(`Navigated to CP scattered mmte details: ${scatteredMmteName}`);
    }

    @TSBDDStepDef('I verify CP calculated mmte percentage on details page')
    async verifyCPCalculatedMmteOnDetailsPage(): Promise<void> {
        const calculatedMmte = this.scenarioContext.get('calculatedActualMmte') as string;
        Tsreporter.info(`Verifying CP calculated mmte on details page. Expected: ${calculatedMmte}`);

        const actualMmte = await this.scatteredMmteDetailsPage.getMmtePercentValue();
        if (String(actualMmte).trim() !== String(calculatedMmte).trim()) {
            Tsreporter.warn(`Mmte(%) mismatch (warning only). Expected: ${calculatedMmte}, Actual: ${actualMmte}`);
        } else {
            Tsreporter.pass(`Mmte(%) value matches calculated mmte: ${actualMmte}`);
        }
    }

    // ===================================================================
    // CP03: ROUNDING NORMALIZATION HELPERS (Static)
    // ===================================================================

    /**
     * Normalize rounding logic from DB format to UI format
     * DB: UP -> UI: Round Up, DOWN -> Round Down, NEAREST -> Nearest
     */
    public static normalizeRoundingLogic(dbValue: string): string {
        const normalized = dbValue.toUpperCase().trim();
        switch (normalized) {
            case 'UP': return 'Round Up';
            case 'DOWN': return 'Round Down';
            case 'NEAREST': return 'Nearest';
            default: return dbValue;
        }
    }

    /**
     * Normalize rounding factor from DB format to UI format
     * Maps numeric fraction values to UI display strings
     */
    public static normalizeRoundingFactor(dbValue: string): string {
        const numValue = parseFloat(dbValue);
        if (isNaN(numValue)) return dbValue;

        const fractionMap: { [key: number]: string } = {
            0.5: '1/2',
            0.25: '1/4',
            0.125: '1/8th',
            0.0625: '1/16th',
            0.03125: '1/32nd',
            0.015625: '1/64th',
            0.0125: '1/80th',
            0.01: '1/100th',
            0.001: '1/1000th',
            0.0001: '1/10000th'
        };

        return fractionMap[numValue] || dbValue;
    }

    // ===================================================================
    // HELPER METHODS
    // ===================================================================

    /**
     * Compare cylinder values in an order-insensitive manner
     */
    public static compareCylinderValues(value1: string, value2: string): boolean {
        if (!value1 && !value2) return true;
        if (!value1 || !value2) return false;

        const cylinders1 = value1.split(',').map(s => s.trim()).sort();
        const cylinders2 = value2.split(',').map(s => s.trim()).sort();

        return JSON.stringify(cylinders1) === JSON.stringify(cylinders2);
    }
}


---------------------------------------------------------------------------------------------
